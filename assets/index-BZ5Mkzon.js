import{B as ge,o as d,c as h,a5 as ve,m as J,s as _e,j as y,af as Te,h as M,b as V,ag as be,ah as he,r as _,a as le,f as G,P as R,g as u,z as E,t as Q,n as pe,a9 as xe,ai as De,x as A,p as C,l as Y,F as O,aj as Fe,ak as me,i as k,E as H,d as ze,u as Ae,e as j,al as Re,a1 as Pe,O as Ee,a8 as Me,A as ke,q as T,K as fe,w as $e,D as Ne,S as je,am as Oe,L as Ge,M as He,an as qe,ao as Je,ap as Ke,aq as We,a4 as ae,k as ie,a7 as Ye,ar as Qe}from"./index-CG54iUaD.js";import{u as Se,d as Xe,_ as Ze}from"./defaultConfirmDeleteOptions-BEDASNM7.js";import{L as et}from"./lessonApi-b6EWekY5.js";import{m as tt}from"./mapLessonFromDto-BxEkOMg4.js";import{U as oe}from"./unitApi-J763zgrL.js";import{_ as se,d as Ce,b as nt,T as ot}from"./CodeEditorView.vue_vue_type_script_setup_true_lang-DWFNPQ5a.js";import{C as st}from"./cloudStorageApi-Bu49sAGs.js";import"./mapUnitFromDto-BXFFFlEW.js";var lt=function(s){var e=s.dt;return`
.p-inputgroup,
.p-inputgroup .p-iconfield,
.p-inputgroup .p-floatlabel,
.p-inputgroup .p-iftalabel {
    display: flex;
    align-items: stretch;
    width: 100%;
}

.p-inputgroup .p-inputtext,
.p-inputgroup .p-inputwrapper {
    flex: 1 1 auto;
    width: 1%;
}

.p-inputgroupaddon {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: `.concat(e("inputgroup.addon.padding"),`;
    background: `).concat(e("inputgroup.addon.background"),`;
    color: `).concat(e("inputgroup.addon.color"),`;
    border-block-start: 1px solid `).concat(e("inputgroup.addon.border.color"),`;
    border-block-end: 1px solid `).concat(e("inputgroup.addon.border.color"),`;
    min-width: `).concat(e("inputgroup.addon.min.width"),`;
}

.p-inputgroupaddon:first-child,
.p-inputgroupaddon + .p-inputgroupaddon {
    border-inline-start: 1px solid `).concat(e("inputgroup.addon.border.color"),`;
}

.p-inputgroupaddon:last-child {
    border-inline-end: 1px solid `).concat(e("inputgroup.addon.border.color"),`;
}

.p-inputgroupaddon:has(.p-button) {
    padding: 0;
    overflow: hidden;
}

.p-inputgroupaddon .p-button {
    border-radius: 0;
}

.p-inputgroup > .p-component,
.p-inputgroup > .p-inputwrapper > .p-component,
.p-inputgroup > .p-iconfield > .p-component,
.p-inputgroup > .p-floatlabel > .p-component,
.p-inputgroup > .p-floatlabel > .p-inputwrapper > .p-component,
.p-inputgroup > .p-iftalabel > .p-component,
.p-inputgroup > .p-iftalabel > .p-inputwrapper > .p-component {
    border-radius: 0;
    margin: 0;
}

.p-inputgroupaddon:first-child,
.p-inputgroup > .p-component:first-child,
.p-inputgroup > .p-inputwrapper:first-child > .p-component,
.p-inputgroup > .p-iconfield:first-child > .p-component,
.p-inputgroup > .p-floatlabel:first-child > .p-component,
.p-inputgroup > .p-floatlabel:first-child > .p-inputwrapper > .p-component,
.p-inputgroup > .p-iftalabel:first-child > .p-component,
.p-inputgroup > .p-iftalabel:first-child > .p-inputwrapper > .p-component {
    border-start-start-radius: `).concat(e("inputgroup.addon.border.radius"),`;
    border-end-start-radius: `).concat(e("inputgroup.addon.border.radius"),`;
}

.p-inputgroupaddon:last-child,
.p-inputgroup > .p-component:last-child,
.p-inputgroup > .p-inputwrapper:last-child > .p-component,
.p-inputgroup > .p-iconfield:last-child > .p-component,
.p-inputgroup > .p-floatlabel:last-child > .p-component,
.p-inputgroup > .p-floatlabel:last-child > .p-inputwrapper > .p-component,
.p-inputgroup > .p-iftalabel:last-child > .p-component,
.p-inputgroup > .p-iftalabel:last-child > .p-inputwrapper > .p-component {
    border-start-end-radius: `).concat(e("inputgroup.addon.border.radius"),`;
    border-end-end-radius: `).concat(e("inputgroup.addon.border.radius"),`;
}

.p-inputgroup .p-component:focus,
.p-inputgroup .p-component.p-focus,
.p-inputgroup .p-inputwrapper-focus,
.p-inputgroup .p-component:focus ~ label,
.p-inputgroup .p-component.p-focus ~ label,
.p-inputgroup .p-inputwrapper-focus ~ label {
    z-index: 1;
}

.p-inputgroup > .p-button:not(.p-button-icon-only) {
    width: auto;
}

.p-inputgroup .p-iconfield + .p-iconfield .p-inputtext {
    border-inline-start: 0;
}
`)},at={root:"p-inputgroup"},it=ge.extend({name:"inputgroup",theme:lt,classes:at}),rt={name:"BaseInputGroup",extends:_e,style:it,provide:function(){return{$pcInputGroup:this,$parentInstance:this}}},Ue={name:"InputGroup",extends:rt,inheritAttrs:!1};function dt(o,s,e,i,a,n){return d(),h("div",J({class:o.cx("root")},o.ptmi("root")),[ve(o.$slots,"default")],16)}Ue.render=dt;var ct={root:"p-inputgroupaddon"},ut=ge.extend({name:"inputgroupaddon",classes:ct}),pt={name:"BaseInputGroupAddon",extends:_e,style:ut,provide:function(){return{$pcInputGroupAddon:this,$parentInstance:this}}},Le={name:"InputGroupAddon",extends:pt,inheritAttrs:!1};function gt(o,s,e,i,a,n){return d(),h("div",J({class:o.cx("root")},o.ptmi("root")),[ve(o.$slots,"default")],16)}Le.render=gt;var vt=function(s){var e=s.dt;return`
.p-toggleswitch {
    display: inline-block;
    width: `.concat(e("toggleswitch.width"),`;
    height: `).concat(e("toggleswitch.height"),`;
}

.p-toggleswitch-input {
    cursor: pointer;
    appearance: none;
    position: absolute;
    top: 0;
    inset-inline-start: 0;
    width: 100%;
    height: 100%;
    padding: 0;
    margin: 0;
    opacity: 0;
    z-index: 1;
    outline: 0 none;
    border-radius: `).concat(e("toggleswitch.border.radius"),`;
}

.p-toggleswitch-slider {
    display: inline-block;
    cursor: pointer;
    width: 100%;
    height: 100%;
    border-width: `).concat(e("toggleswitch.border.width"),`;
    border-style: solid;
    border-color: `).concat(e("toggleswitch.border.color"),`;
    background: `).concat(e("toggleswitch.background"),`;
    transition: background `).concat(e("toggleswitch.transition.duration"),", color ").concat(e("toggleswitch.transition.duration"),", border-color ").concat(e("toggleswitch.transition.duration"),", outline-color ").concat(e("toggleswitch.transition.duration"),", box-shadow ").concat(e("toggleswitch.transition.duration"),`;
    border-radius: `).concat(e("toggleswitch.border.radius"),`;
    outline-color: transparent;
    box-shadow: `).concat(e("toggleswitch.shadow"),`;
}

.p-toggleswitch-handle {
    position: absolute;
    top: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    background: `).concat(e("toggleswitch.handle.background"),`;
    color: `).concat(e("toggleswitch.handle.color"),`;
    width: `).concat(e("toggleswitch.handle.size"),`;
    height: `).concat(e("toggleswitch.handle.size"),`;
    inset-inline-start: `).concat(e("toggleswitch.gap"),`;
    margin-block-start: calc(-1 * calc(`).concat(e("toggleswitch.handle.size"),` / 2));
    border-radius: `).concat(e("toggleswitch.handle.border.radius"),`;
    transition: background `).concat(e("toggleswitch.transition.duration"),", color ").concat(e("toggleswitch.transition.duration"),", inset-inline-start ").concat(e("toggleswitch.slide.duration"),", box-shadow ").concat(e("toggleswitch.slide.duration"),`;
}

.p-toggleswitch.p-toggleswitch-checked .p-toggleswitch-slider {
    background: `).concat(e("toggleswitch.checked.background"),`;
    border-color: `).concat(e("toggleswitch.checked.border.color"),`;
}

.p-toggleswitch.p-toggleswitch-checked .p-toggleswitch-handle {
    background: `).concat(e("toggleswitch.handle.checked.background"),`;
    color: `).concat(e("toggleswitch.handle.checked.color"),`;
    inset-inline-start: calc(`).concat(e("toggleswitch.width")," - calc(").concat(e("toggleswitch.handle.size")," + ").concat(e("toggleswitch.gap"),`));
}

.p-toggleswitch:not(.p-disabled):has(.p-toggleswitch-input:hover) .p-toggleswitch-slider {
    background: `).concat(e("toggleswitch.hover.background"),`;
    border-color: `).concat(e("toggleswitch.hover.border.color"),`;
}

.p-toggleswitch:not(.p-disabled):has(.p-toggleswitch-input:hover) .p-toggleswitch-handle {
    background: `).concat(e("toggleswitch.handle.hover.background"),`;
    color: `).concat(e("toggleswitch.handle.hover.color"),`;
}

.p-toggleswitch:not(.p-disabled):has(.p-toggleswitch-input:hover).p-toggleswitch-checked .p-toggleswitch-slider {
    background: `).concat(e("toggleswitch.checked.hover.background"),`;
    border-color: `).concat(e("toggleswitch.checked.hover.border.color"),`;
}

.p-toggleswitch:not(.p-disabled):has(.p-toggleswitch-input:hover).p-toggleswitch-checked .p-toggleswitch-handle {
    background: `).concat(e("toggleswitch.handle.checked.hover.background"),`;
    color: `).concat(e("toggleswitch.handle.checked.hover.color"),`;
}

.p-toggleswitch:not(.p-disabled):has(.p-toggleswitch-input:focus-visible) .p-toggleswitch-slider {
    box-shadow: `).concat(e("toggleswitch.focus.ring.shadow"),`;
    outline: `).concat(e("toggleswitch.focus.ring.width")," ").concat(e("toggleswitch.focus.ring.style")," ").concat(e("toggleswitch.focus.ring.color"),`;
    outline-offset: `).concat(e("toggleswitch.focus.ring.offset"),`;
}

.p-toggleswitch.p-invalid > .p-toggleswitch-slider {
    border-color: `).concat(e("toggleswitch.invalid.border.color"),`;
}

.p-toggleswitch.p-disabled {
    opacity: 1;
}

.p-toggleswitch.p-disabled .p-toggleswitch-slider {
    background: `).concat(e("toggleswitch.disabled.background"),`;
}

.p-toggleswitch.p-disabled .p-toggleswitch-handle {
    background: `).concat(e("toggleswitch.handle.disabled.background"),`;
}
`)},ht={root:{position:"relative"}},mt={root:function(s){var e=s.instance,i=s.props;return["p-toggleswitch p-component",{"p-toggleswitch-checked":e.checked,"p-disabled":i.disabled,"p-invalid":e.$invalid}]},input:"p-toggleswitch-input",slider:"p-toggleswitch-slider",handle:"p-toggleswitch-handle"},ft=ge.extend({name:"toggleswitch",theme:vt,classes:mt,inlineStyles:ht}),wt={name:"BaseToggleSwitch",extends:Te,props:{trueValue:{type:null,default:!0},falseValue:{type:null,default:!1},readonly:{type:Boolean,default:!1},tabindex:{type:Number,default:null},inputId:{type:String,default:null},inputClass:{type:[String,Object],default:null},inputStyle:{type:Object,default:null},ariaLabelledby:{type:String,default:null},ariaLabel:{type:String,default:null}},style:ft,provide:function(){return{$pcToggleSwitch:this,$parentInstance:this}}},Ie={name:"ToggleSwitch",extends:wt,inheritAttrs:!1,emits:["change","focus","blur"],methods:{getPTOptions:function(s){var e=s==="root"?this.ptmi:this.ptm;return e(s,{context:{checked:this.checked,disabled:this.disabled}})},onChange:function(s){if(!this.disabled&&!this.readonly){var e=this.checked?this.falseValue:this.trueValue;this.writeValue(e,s),this.$emit("change",s)}},onFocus:function(s){this.$emit("focus",s)},onBlur:function(s){var e,i;this.$emit("blur",s),(e=(i=this.formField).onBlur)===null||e===void 0||e.call(i,s)}},computed:{checked:function(){return this.d_value===this.trueValue}}},bt=["data-p-checked","data-p-disabled"],yt=["id","checked","tabindex","disabled","readonly","aria-checked","aria-labelledby","aria-label","aria-invalid"];function _t(o,s,e,i,a,n){return d(),h("div",J({class:o.cx("root"),style:o.sx("root")},n.getPTOptions("root"),{"data-p-checked":n.checked,"data-p-disabled":o.disabled}),[y("input",J({id:o.inputId,type:"checkbox",role:"switch",class:[o.cx("input"),o.inputClass],style:o.inputStyle,checked:n.checked,tabindex:o.tabindex,disabled:o.disabled,readonly:o.readonly,"aria-checked":n.checked,"aria-labelledby":o.ariaLabelledby,"aria-label":o.ariaLabel,"aria-invalid":o.invalid||void 0,onFocus:s[0]||(s[0]=function(){return n.onFocus&&n.onFocus.apply(n,arguments)}),onBlur:s[1]||(s[1]=function(){return n.onBlur&&n.onBlur.apply(n,arguments)}),onChange:s[2]||(s[2]=function(){return n.onChange&&n.onChange.apply(n,arguments)})},n.getPTOptions("input")),null,16,yt),y("div",J({class:o.cx("slider")},n.getPTOptions("slider")),[y("div",J({class:o.cx("handle")},n.getPTOptions("handle")),[ve(o.$slots,"handle",{checked:n.checked})],16)],16)],16,bt)}Ie.render=_t;const P={hideLesson:xt,modifyLesson:kt,publishLesson:$t,sendLessonForReview:St,cancelLessonReview:Ct,startLessonReview:Ut,acceptLesson:Lt,rejectLesson:It,editLesson:Bt};async function xt(o){return await M.patch(`v2/lesson/${o}/hide`)}async function kt(o){return await M.patch(`v2/lesson/${o}/modify`)}async function $t(o){return await M.patch(`v2/lesson/${o}/publish`)}async function St(o){return await M.patch(`v2/lesson/${o}/review/send`)}async function Ct(o){return await M.patch(`v2/lesson/${o}/review/cancel`)}async function Ut(o){return await M.patch(`v2/lesson/${o}/review/start`)}async function Lt(o){return await M.patch(`v2/lesson/${o}/review/accept`)}async function It(o){return await M.patch(`v2/lesson/${o}/review/reject`)}async function Bt(o){return await M.patch(`v2/lesson/${o}/review/edit`)}const B=[];for(let o=0;o<256;++o)B.push((o+256).toString(16).slice(1));function Vt(o,s=0){return(B[o[s+0]]+B[o[s+1]]+B[o[s+2]]+B[o[s+3]]+"-"+B[o[s+4]]+B[o[s+5]]+"-"+B[o[s+6]]+B[o[s+7]]+"-"+B[o[s+8]]+B[o[s+9]]+"-"+B[o[s+10]]+B[o[s+11]]+B[o[s+12]]+B[o[s+13]]+B[o[s+14]]+B[o[s+15]]).toLowerCase()}let re;const Tt=new Uint8Array(16);function Dt(){if(!re){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");re=crypto.getRandomValues.bind(crypto)}return re(Tt)}const Ft=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ye={randomUUID:Ft};function Be(o,s,e){var a;if(ye.randomUUID&&!s&&!o)return ye.randomUUID();o=o||{};const i=o.random??((a=o.rng)==null?void 0:a.call(o))??Dt();if(i.length<16)throw new Error("Random bytes length must be >= 16");return i[6]=i[6]&15|64,i[8]=i[8]&63|128,Vt(i)}const zt={class:"flex items-center"},At={class:"flex items-center mr-2"},Rt=V({__name:"HighlightEditor",props:be({index:{},usedSlots:{}},{highlight:{},highlightModifiers:{}}),emits:be(["remove","save"],["update:highlight"]),setup(o,{emit:s}){const e=o,i=he(o,"highlight"),a=_(""),n=_(null),t=_(null),l=_(!1),p=le(()=>n.value!=null&&t.value!=null),c=s,w=()=>{c("remove",e.index)};G(()=>{i.value&&(a.value=i.value.id,n.value=i.value.module,t.value=i.value.slot,l.value=i.value.autoPut)}),R([n,t,l],()=>{n.value!=null&&c("save",e.index,a.value,n.value,t.value,l.value)}),R(p,S=>{S||(l.value=!1)});const g=_(["A","B","C","D","E","F"]),$=_(["8","9"]),m=_(["LED","switch","push-button","light-sensor","touch-sensor","potentiometer","encoder","motion-detector","microphone","climate-sensor","gyro-accel","buzzer","color-sensor","joystick","distance-sensor","servo","led-tower"]),b=le(()=>{if(n.value){if(n.value==="servo"||n.value==="led-tower"){const U=$.value.filter(F=>!(e.usedSlots??[]).includes(F));return t.value&&!U.includes(t.value)&&U.unshift(t.value),[null,...U]}const v=g.value.filter(f=>!(e.usedSlots??[]).includes(f));return t.value&&!v.includes(t.value)&&v.unshift(t.value),[null,...v]}const r=[...g.value,...$.value].filter(x=>!(e.usedSlots??[]).includes(x));return t.value&&!r.includes(t.value)&&r.unshift(t.value),[null,...r]}),L=le(()=>t.value?t.value==="8"||t.value==="9"?["servo","led-tower"]:m.value.filter(S=>S!=="servo"&&S!=="led-tower"):m.value);return(S,r)=>{const x=xe,v=De,f=Le,U=Ue,F=A;return d(),h("div",zt,[y("div",At,[u(x,{modelValue:l.value,"onUpdate:modelValue":r[0]||(r[0]=I=>l.value=I),binary:"","input-id":"autoput",disabled:!p.value},null,8,["modelValue","disabled"]),r[3]||(r[3]=y("label",{for:"autoput",class:"ml-1 text-sm"},"auto",-1))]),u(U,null,{default:E(()=>[u(v,{modelValue:n.value,"onUpdate:modelValue":r[1]||(r[1]=I=>n.value=I),options:L.value,placeholder:"Select module",class:"place-content-center",size:"small"},null,8,["modelValue","options"]),u(f,{class:"h-[35px]"},{default:E(()=>r[4]||(r[4]=[y("div",null,"=>",-1)])),_:1}),u(v,{modelValue:t.value,"onUpdate:modelValue":r[2]||(r[2]=I=>t.value=I),options:b.value,placeholder:"Select slot",size:"small"},{option:E(({option:I})=>[y("span",{class:pe(I===null?"text-gray-400":"")},Q(I===null?"[null]":I),3)]),value:E(({value:I})=>[y("span",{class:pe(I===null?"text-gray-400":"")},Q(I===null?"[null]":I),3)]),_:1},8,["modelValue","options"])]),_:1}),u(F,{icon:"pi pi-trash",variant:"text",severity:"danger","aria-label":"Remove",onClick:w,class:"ml-2"})])}}}),Pt={class:"flex flex-col gap-2"},Et=V({__name:"HighlightPanel",props:{neededModules:{default:[]},neededModulesModifiers:{}},emits:["update:neededModules"],setup(o){const s=he(o,"neededModules");function e(){s.value=[...s.value,{autoPut:!1,module:null,slot:null,id:Be()}]}function i(n){s.value.splice(n,1)}function a(n,t,l,p,c){s.value[n].id=t,s.value[n].module=l,s.value[n].slot=p,s.value[n].autoPut=c}return(n,t)=>{const l=A,p=Fe;return d(),C(p,{header:"Highlight slots & modules"},{default:E(()=>[y("div",Pt,[(d(!0),h(O,null,Y(s.value,(c,w)=>(d(),h("div",{key:c.id},[u(Rt,{highlight:s.value[w],"onUpdate:highlight":g=>s.value[w]=g,index:w,usedSlots:s.value.filter((g,$)=>{var m;return $!==w&&((m=s.value[$])==null?void 0:m.slot)!=null}).map(g=>g.slot),onRemove:i,onSave:a},null,8,["highlight","onUpdate:highlight","index","usedSlots"])]))),128))]),u(l,{icon:"pi pi-plus",variant:"text","aria-label":"Add",class:"self-center mt-2",onClick:e})]),_:1})}}}),Mt={class:"flex"},Nt={class:"h-[500px] flex flex-col w-full relative"},jt={class:"flex h-full",style:{border:"0.1px solid #808080",borderTopLeftRadius:"12px",borderTopRightRadius:"12px",overflow:"hidden"}},Ot={class:"absolute right-2 bottom-2"},de=!1,Gt=V({__name:"PibodyEditor",props:{id:{},content:{},data:{}},emits:["save-content","show-tester"],setup(o,{emit:s}){const e=H(),i=o,a=s,n=_(""),t=_(""),l=_([]);let p=!0;me(()=>{n.value=i.content.starting,t.value=i.content.answer,l.value=i.data.neededModules??[]}),R([n,t,l],()=>{if(console.log(1),p){p=!1;return}a("save-content",{starting:n.value,answer:t.value,hashed_answer:""},{neededModules:l.value.filter(w=>w.module!=null),tests:i.data.tests,includedCommandsForTests:i.data.includedCommandsForTests})},{deep:!0});function c(){a("show-tester",{lesson_id:e.params.id,unit_id:i.id.split("-")[1]})}return(w,g)=>{const $=A;return d(),h(O,null,[y("div",Mt,[y("div",Nt,[y("div",jt,[u(se,{code:n.value,"onUpdate:code":g[0]||(g[0]=m=>n.value=m),runbuttons:!1,connectbuttons:de,id:i.id+"_",class:"flex-1"},null,8,["code","id"]),u(se,{code:t.value,"onUpdate:code":g[1]||(g[1]=m=>t.value=m),connectbuttons:de,"onUpdate:connectbuttons":g[2]||(g[2]=m=>de=m),id:i.id,class:"flex-1"},null,8,["code","id"])]),y("div",Ot,[u($,{label:"Tests",icon:"pi pi-pen-to-square",class:"w-fit",severity:"info",onClick:c})]),u(k(Ce),{id:i.id,class:"flex-grow max-h-40"},null,8,["id"])])]),u(Et,{neededModules:l.value,"onUpdate:neededModules":g[3]||(g[3]=m=>l.value=m),class:"mb-2"},null,8,["neededModules"])],64)}}}),Ht={class:"flex"},qt={class:"h-[500px] flex flex-col w-full relative"},Jt={class:"flex h-full",style:{border:"0.1px solid #808080",borderTopLeftRadius:"12px",borderTopRightRadius:"12px",overflow:"hidden"}},Kt={class:"absolute right-2 bottom-2"},ce=!1,Wt=V({__name:"CodeEditor",props:{id:{},code:{}},emits:["save-content","show-tester"],setup(o,{emit:s}){const e=H(),i=o,a=s,n=_(""),t=_("");let l=!0;me(()=>{n.value=i.code.starting,t.value=i.code.answer}),R([n,t],()=>{if(l){l=!1;return}a("save-content",{starting:n.value,answer:t.value,hashed_answer:""})});function p(){a("show-tester",{lesson_id:e.params.id,unit_id:i.id.split("-")[1]})}return(c,w)=>{const g=A;return d(),h("div",Ht,[y("div",qt,[y("div",Jt,[u(se,{code:n.value,"onUpdate:code":w[0]||(w[0]=$=>n.value=$),runbuttons:!1,connectbuttons:ce,id:i.id+"_",class:"flex-1"},null,8,["code","id"]),u(se,{code:t.value,"onUpdate:code":w[1]||(w[1]=$=>t.value=$),connectbuttons:ce,"onUpdate:connectbuttons":w[2]||(w[2]=$=>ce=$),id:i.id,class:"flex-1"},null,8,["code","id"])]),y("div",Kt,[u(g,{label:"Tests",icon:"pi pi-pen-to-square",class:"w-fit",severity:"info",onClick:p})]),u(k(Ce),{id:i.id,class:"flex-grow max-h-40"},null,8,["id"])])])}}}),Yt=["article","options","open","video","code","pibody"],q=ze("lesson-edit-store",()=>{const o=Ae(),s=Se(),{lang:e}=j(s),i=_(null),a=_(!1),n=_(!1),t=_(!1),l=_(!1),p=_(!1),c=_(!1);function w(S){t.value=S}async function g(S){try{a.value=!0;const{data:r}=await et.getLessonById(S,void 0,e.value);i.value=tt(r)}catch(r){o.add({severity:"error",summary:r.response.data.error,life:2e3})}finally{a.value=!1}}async function $(S,r){try{n.value=!0;const{data:x}=await oe.getUnitByIdandLessonId(S,r,e.value);return x}catch(x){o.add({severity:"error",summary:x.response.data.error,life:2e3})}finally{n.value=!1}}async function m(S){try{l.value=!0;const{data:r}=await oe.createUnitByLessonId(i.value.id,S);o.add({severity:"success",summary:r.message,life:2e3})}catch(r){o.add({severity:"error",summary:r.response.data.error,life:2e3})}finally{l.value=!1}}async function b(S,r,x){try{p.value=!0;const{data:v}=await oe.updateUnitByIdandLessonId(S,r,x,e.value);return v.unit_id}catch(v){o.add({severity:"error",summary:v.response.data.error,life:2e3})}finally{p.value=!1}}async function L(S,r){try{c.value=!0;const{data:x}=await oe.deleteUnitByIdandLessonId(S,r);o.add({severity:"success",summary:x.message,life:2e3})}catch(x){o.add({severity:"error",summary:x.response.data.error,life:2e3})}finally{c.value=!1}}return{selectedLesson:i,isLessonLoading:a,isLessonSaving:t,isUnitLoading:n,isUnitCreating:l,isUnitUpdating:p,isUnitDeleting:c,setLessonSaving:w,loadLessonById:g,loadUnitByIdandLessonId:$,createUnit:m,updateUnitByIdandLessonId:b,deleteUnitByIdandLessonId:L}}),Qt={class:"flex items-start"},Xt=V({__name:"MdEditor",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(o){const s=he(o,"modelValue"),e=Re({title:{title:"Title",icon:"v-md-icon-tip",action(a){a.insert(n=>{const t="# <center>",l="</center>",c=n||"Title";return{text:`${t}${c}${l}`,selected:c}})}},icons:{title:"icons",icon:"v-md-icon-tip",menus:[{name:"Attention",text:"Attention",action(a){a.insert(()=>{const n='<span style="font-size: 20px">',t="</span>",l="⚠️";return{text:`${n}${l}${t}`,selected:l}})}},{name:"PiBody",text:"PiBody",action(a){a.insert(()=>{const n="<b>",t="</b>",l='<span style="color: #FF3F85"> Pi</span>Body';return{text:`${n}${l}${t}`,selected:l}})}},{name:"Run",text:"Run",action(a){a.insert(()=>({text:"▶️<b>Run</b>"}))}}]},style:{title:"Style",icon:"v-md-icon-tip",action(a){a.insert(n=>{const t='<span style="">',l="</span>",c=n||"placeholder";return{text:`${t}${c}${l}`,selected:c}})}},underline:{title:"Underline",icon:"v-md-icon-under-line",action(a){a.insert(n=>{const t='<span style="text-decoration: underline">',l="</span>",c=n||"placeholder";return{text:`${t}${c}${l}`,selected:c}})}},tip:{title:"Tip",icon:"v-md-icon-tip",action(a){a.insert(n=>{const t='<div style="background-color:#F3F5F7; padding: 20px; border-left: solid 8px #42B983">',l="</div>",c=n||"placeholder";return{text:`${t}${c}${l}`,selected:c}})}},note:{title:"Note",icon:"v-md-icon-tip",action(a){a.insert(n=>{const t='<div style="background-color:#F3F5F7; padding: 15px; border-left: solid 8px #FFCD6B; margin-bottom: 15px">',l="</div>",c=n||"placeholder";return{text:`${t}${c}${l}`,selected:c}})}}});async function i(a,n,t){const l=t[0],p=new FormData;p.append("file",l);try{const{data:c}=await st.uploadFile(p,"image_"),w=c.source_url;n({url:w,desc:"desc",width:"auto",height:"auto"})}catch(c){console.log(c)}}return(a,n)=>{const t=Pe("v-md-editor");return d(),h("div",Qt,[u(t,{modelValue:s.value,"onUpdate:modelValue":n[0]||(n[0]=l=>s.value=l),mode:"edit",onChange:n[1]||(n[1]=l=>s.value=l),"left-toolbar":"undo redo clear | tip emoji todo-list | h bold italic strikethrough quote ul ol table hr link code image | title icons style underline tip note","right-toolbar":"",toolbar:e,"disabled-menus":[],onUploadImage:i},null,8,["modelValue","toolbar"])])}}}),Ve=Ee(Xt,[["__scopeId","data-v-52e9f376"]]),Zt=V({__name:"ArticleEditor",props:{article:{}},emits:["save-content"],setup(o,{emit:s}){const e=o,i=s,a=_("");let n=!0;return G(()=>{var t;a.value=((t=e.article)==null?void 0:t.text)??""}),R(a,()=>{if(n){n=!1;return}i("save-content",{text:a.value})},{flush:"post"}),(t,l)=>(d(),C(Ve,{modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=p=>a.value=p)},null,8,["modelValue"]))}}),en={class:"flex flex-col gap-2"},tn={class:"flex gap-1 text-gray-500"},nn={class:"flex flex-col gap-1"},on=V({__name:"OptionsEditor",props:{optionsData:{}},emits:["save-content"],setup(o,{emit:s}){const e=o,i=s,a=_(!1),n=_(!1),t=_(!1),l=_([]),p=_([]),c=_();let w=!0;G(()=>{var m,b,L,S,r,x;a.value=((m=e.optionsData)==null?void 0:m.shuffle)??!1,n.value=((b=e.optionsData)==null?void 0:b.feedback)??!1,t.value=((L=e.optionsData)==null?void 0:L.single)??!1,l.value=((S=e.optionsData)==null?void 0:S.options)??[],p.value=((r=e.optionsData)==null?void 0:r.answer)??[],c.value=e.optionsData&&e.optionsData.answer&&e.optionsData.answer.length>0?(x=e.optionsData)==null?void 0:x.answer[0]:void 0}),R([a,n,t,l,p,c],()=>{if(w){w=!1;return}i("save-content",{shuffle:a.value,feedback:n.value,single:t.value,options:l.value,answer:t.value?c.value?[c.value]:[]:p.value,hashed_answer:[]})},{deep:!0});function g(){l.value.push({id:Be(),text:""})}function $(m){l.value=l.value.filter(b=>b.id!==m),p.value=p.value.filter(b=>b!==m),c.value==m&&(c.value=void 0)}return(m,b)=>{const L=Ie,S=Me,r=xe,x=A;return d(),h("div",en,[y("div",tn,[b[5]||(b[5]=y("div",null,"shuffle:",-1)),u(L,{modelValue:a.value,"onUpdate:modelValue":b[0]||(b[0]=v=>a.value=v),class:"mr-2"},null,8,["modelValue"]),b[6]||(b[6]=y("div",null,"feedback:",-1)),u(L,{modelValue:n.value,"onUpdate:modelValue":b[1]||(b[1]=v=>n.value=v),class:"mr-2"},null,8,["modelValue"]),b[7]||(b[7]=y("div",null,"single:",-1)),u(L,{modelValue:t.value,"onUpdate:modelValue":b[2]||(b[2]=v=>t.value=v)},null,8,["modelValue"])]),y("div",nn,[(d(!0),h(O,null,Y(l.value,v=>(d(),h("div",{key:v.id,class:"flex gap-2 items-center"},[t.value?(d(),C(S,{key:0,modelValue:c.value,"onUpdate:modelValue":b[3]||(b[3]=f=>c.value=f),value:v.id},null,8,["modelValue","value"])):(d(),C(r,{key:1,modelValue:p.value,"onUpdate:modelValue":b[4]||(b[4]=f=>p.value=f),value:v.id},null,8,["modelValue","value"])),u(Ve,{modelValue:v.text,"onUpdate:modelValue":f=>v.text=f,class:"w-full"},null,8,["modelValue","onUpdate:modelValue"]),u(x,{icon:"pi pi-trash",variant:"text",severity:"danger",size:"small",onClick:f=>$(v.id)},null,8,["onClick"])]))),128))]),u(x,{icon:"pi pi-plus",label:"Add option",variant:"text",size:"small",onClick:g,class:"self-center"})])}}}),sn=V({__name:"OpenEditor",props:{open:{}},emits:["save-content"],setup(o,{emit:s}){const e=o,i=s,a=_("");let n=!0;return G(()=>{var t;a.value=((t=e.open)==null?void 0:t.answer)??""}),R(a,()=>{if(n){n=!1;return}i("save-content",{answer:a.value,hashed_answer:""})}),(t,l)=>{const p=ke;return d(),C(p,{type:"text",modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=c=>a.value=c??""),class:"w-full",size:"small"},null,8,["modelValue"])}}}),ln=V({__name:"VideoEditor",props:{video:{}},emits:["save-content"],setup(o,{emit:s}){const e=o,i=s,a=_("");let n=!0;return G(()=>{var t;a.value=((t=e.video)==null?void 0:t.url)??""}),R(a,()=>{if(n){n=!1;return}i("save-content",{url:a.value})}),(t,l)=>{const p=ke;return d(),C(p,{type:"text",modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=c=>a.value=c??""),class:"w-full",size:"small"},null,8,["modelValue"])}}}),an={class:"bg-white rounded-lg border border-gray-200"},rn={key:1,class:"flex flex-col h-full w-full"},dn={class:"flex items-center gap-2 px-4 pt-2"},cn={class:"text-sm"},un={class:"text-sm text-gray-500"},pn={key:1,class:"flex-grow px-4 py-2"},gn={class:"flex justify-end"},vn=V({__name:"UnitCard",props:{unit:{},loading:{type:Boolean}},emits:["delete","update"],setup(o,{emit:s}){const e=o,i=s,a=H(),n=$e(),t=q(),{updateUnitByIdandLessonId:l,setLessonSaving:p,loadUnitByIdandLessonId:c}=t,w=_(!1),g=_(null),$=_(null);me(async()=>{w.value=!0;const r=await c(e.unit.id,Number(a.params.id));r&&(g.value=r.content,$.value=r.data),w.value=!1});function m(r,x){p(!0),L(r,x)}function b(r){n.push({name:"tester2",params:{lesson_id:r.lesson_id,unit_id:r.unit_id}})}const L=nt((r,x)=>{S(r,x)},1e3,{maxWait:5e3});async function S(r,x){const v=await l(e.unit.id,Number(a.params.id),{content:r,data:x});v&&i("update",e.unit,v),p(!1)}return(r,x)=>{const v=Ne,f=A;return d(),h("div",an,[r.loading?(d(),C(v,{key:0,class:"flex justify-center items-center w-10 h-full"})):(d(),h("div",rn,[y("div",dn,[y("div",cn,Q(r.unit.id),1),y("div",un,Q(`${r.unit.unitType}`),1)]),w.value?(d(),C(v,{key:0,class:"flex justify-center items-center w-10 h-full"})):(d(),h("div",pn,[r.unit.unitType=="article"?(d(),C(Zt,{key:0,article:g.value,onSaveContent:m},null,8,["article"])):r.unit.unitType=="options"?(d(),C(on,{key:1,"options-data":g.value,onSaveContent:m},null,8,["options-data"])):r.unit.unitType=="open"?(d(),C(sn,{key:2,open:g.value,onSaveContent:m},null,8,["open"])):r.unit.unitType=="video"?(d(),C(ln,{key:3,video:g.value,onSaveContent:m},null,8,["video"])):e.unit.unitType=="code"?(d(),C(k(Wt),{key:4,id:`code-${e.unit.id}`,code:g.value,onSaveContent:m,onShowTester:b},null,8,["id","code"])):e.unit.unitType=="pibody"?(d(),C(k(Gt),{key:5,id:`code-${e.unit.id}`,content:g.value,data:$.value,onSaveContent:m,onShowTester:b},null,8,["id","content","data"])):T("",!0)])),y("div",gn,[u(f,{icon:"pi pi-trash",size:"small",severity:"danger",variant:"text",onClick:x[0]||(x[0]=fe(U=>i("delete",e.unit),["stop"]))})])]))])}}}),hn={class:"group w-full relative"},mn={class:"flex"},ue=V({__name:"AddUnitButton",props:{unitId:{},showAddGroup:{type:Boolean},hided:{type:Boolean}},emits:["add-group-divider"],setup(o,{emit:s}){const e=o,i=s,a=H(),n=q(),{loadLessonById:t,createUnit:l}=n,p=_(),c=_(Yt.map(g=>({label:g,command:async()=>{await l({unit_type:g,prev_unit_id:e.unitId??void 0}),await t(Number(a.params.id))}}))),w=g=>{p.value.toggle(g)};return(g,$)=>{const m=je,b=A,L=Oe;return d(),h(O,null,[y("div",hn,[$[1]||($[1]=y("div",{class:"h-3"},null,-1)),y("div",{class:pe(["absolute left-1/2 -translate-x-1/2 -top-5 group-hover:block mt-[9px] w-full",g.hided?"hidden":""])},[y("div",mn,[u(m,{class:"w-7",type:"dashed"}),u(m,{class:"flex-grow",type:"dashed"}),u(b,{icon:"pi pi-plus",class:"flex self-end shadow-xl h-7",size:"small",onClick:w}),u(m,{class:"flex-grow",type:"dashed"}),g.showAddGroup?(d(),C(b,{key:0,icon:"pi pi-arrow-up-right-and-arrow-down-left-from-center",class:"flex self-end h-7",size:"small",variant:"text",onClick:$[0]||($[0]=S=>i("add-group-divider"))})):(d(),C(m,{key:1,class:"w-7",type:"dashed"}))])],2)]),u(L,{ref_key:"menu",ref:p,model:c.value,popup:!0},null,8,["model"])],64)}}}),fn=V({__name:"RemoveGroupButton",emits:["remove-group-divider"],setup(o,{emit:s}){const e=s;return(i,a)=>{const n=A;return d(),C(n,{icon:"pi pi-arrow-down-left-and-arrow-up-right-to-center",severity:"danger",class:"flex self-end h-7 w-7",size:"small",variant:"text",onClick:a[0]||(a[0]=fe(t=>e("remove-group-divider"),["stop"]))})}}}),wn={class:"flex flex-col gap-2"},bn={class:"w-full flex justify-between gap-2 mr-4"},yn={class:"flex flex-row"},_n={class:"flex flex-col p-2 rounded-lg bg-slate-50"},xn=V({__name:"UnitsView",props:{pages:{}},setup(o){const s=o,e=H(),i=Ge(),a=q(),{isUnitDeleting:n}=j(a),{loadLessonById:t,createUnit:l,deleteUnitByIdandLessonId:p}=a,c=_(null);async function w(f){await l({unit_type:"group-divider",prev_unit_id:f.id}),await t(Number(e.params.id))}async function g(){await l({unit_type:"page-divider"}),await t(Number(e.params.id))}async function $(f){await l({unit_type:"page-divider",prev_unit_id:f}),await p(f,Number(e.params.id)),await t(Number(e.params.id))}async function m(f){await p(f,Number(e.params.id)),await t(Number(e.params.id))}function b(f){c.value=f,i.require({...Xe,message:"Are you sure you want to delete this lesson?",accept:async()=>{await p(f.id,Number(e.params.id)),await t(Number(e.params.id))}})}function L(f,U){U>f.id&&(f.id=U)}const S=Number(e.params.id),r=`openedPanels-${S}`,x=_({});G(async()=>{const f=localStorage.getItem(r);f&&(x.value=JSON.parse(f)),await He(),setTimeout(()=>{const U=localStorage.getItem(`lastOpenedGroup-${S}`);if(U){const F=document.getElementById(`group-${U}`);if(F){F.scrollIntoView({behavior:"smooth"});return}}},1e3)}),R(x,f=>{localStorage.setItem(r,JSON.stringify(f))},{deep:!0});function v(f,U){x.value[U]=f,x.value[U].length>0&&localStorage.setItem(`lastOpenedGroup-${S}`,f[f.length-1])}return(f,U)=>{const F=A,I=qe,X=Je,Z=Ke,ee=We;return d(),h("div",wn,[(d(!0),h(O,null,Y(s.pages,N=>(d(),C(ee,{value:x.value[N.id]||[],"onUpdate:value":D=>v(D,N.id),multiple:"",key:N.id,class:"flex flex-col gap-2 bg-white p-4 rounded-lg shadow-lg"},{default:E(()=>[(d(!0),h(O,null,Y(N.groups,(D,K)=>(d(),C(Z,{key:D.id,value:D.id,id:`group-${D.id}`},{default:E(()=>[u(I,null,{default:E(()=>[y("div",bn,[y("div",null,"Step: "+Q(K),1),y("div",yn,[K!=0?(d(),C(F,{key:0,icon:"pi pi-file-plus",class:"flex self-end h-7 w-7",size:"small",variant:"text",onClick:fe(z=>$(D.id),["stop"])},null,8,["onClick"])):T("",!0),D.id!=-1?(d(),C(fn,{key:1,onRemoveGroupDivider:z=>m(D.id)},null,8,["onRemoveGroupDivider"])):T("",!0)])])]),_:2},1024),u(X,{class:"flex flex-col"},{default:E(()=>[y("div",_n,[(d(!0),h(O,null,Y(D.units,(z,te)=>{var W;return d(),h("div",{key:z.id},[te==0?(d(),C(ue,{key:0,hided:!0,"unit-id":D.id,"show-add-group":!1},null,8,["unit-id"])):T("",!0),u(vn,{unit:z,loading:((W=c.value)==null?void 0:W.id)===z.id&&k(n),onDelete:ne=>b(z),onUpdate:L},null,8,["unit","loading","onDelete"]),u(ue,{hided:!0,"unit-id":z.id,"show-add-group":!0,onAddGroupDivider:ne=>w(z)},null,8,["unit-id","onAddGroupDivider"])])}),128)),D.units.length==0?(d(),C(ue,{key:0,hided:!1,"unit-id":D.id,"show-add-group":!1},null,8,["unit-id"])):T("",!0)])]),_:2},1024)]),_:2},1032,["value","id"]))),128))]),_:2},1032,["value","onUpdate:value"]))),128)),u(F,{id:"newpage",icon:"pi pi-plus",label:"New page",variant:"text",size:"small",class:"flex self-center",onClick:U[0]||(U[0]=N=>g())})])}}}),kn={class:"w-[24px] h-[24px]"},$n={key:0,class:"flex items-center"},Sn={key:0,class:"material-icons text-gray-500"},Cn={key:1,class:"material-icons text-gray-500"},Un={key:1},Ln={class:"material-icons text-gray-500"},In=V({__name:"AutoSaveCloud",setup(o){const s=q(),{selectedLesson:e,isLessonSaving:i}=j(s);return(a,n)=>{var l;const t=ot;return d(),h("div",kn,[(l=k(e))!=null&&l.editable?(d(),h("div",$n,[k(i)?ae((d(),h("span",Cn,n[1]||(n[1]=[ie("cloud_sync")]))),[[t,"Saving...",void 0,{bottom:!0}]]):ae((d(),h("span",Sn,n[0]||(n[0]=[ie("cloud_done")]))),[[t,"Saved",void 0,{bottom:!0}]])])):(d(),h("div",Un,[ae((d(),h("span",Ln,n[2]||(n[2]=[ie("cloud_off")]))),[[t,"Save not allowed",void 0,{bottom:!0}]])]))])}}}),Bn={key:0},Vn={key:0},Tn={key:1},Dn={key:0},Fn={key:1},zn={key:2},An={key:0,class:"flex gap-1"},Rn={key:3},Pn={key:0},En={key:4},Mn={key:0,class:"flex gap-1"},Nn={key:5},jn={key:0,class:"flex gap-1"},On={key:6},Gn={key:0,class:"flex gap-1"},Hn=V({__name:"StageButtons",setup(o){const s=H(),e=Ye(),{user:i}=j(e),a=q(),{selectedLesson:n}=j(a),t=_(!1),l=_(!1);async function p(){t.value=!0;try{await P.sendLessonForReview(s.params.id.toString()),window.location.reload()}catch(r){console.log(r)}finally{t.value=!1}}async function c(){t.value=!0;try{await P.cancelLessonReview(s.params.id.toString()),window.location.reload()}catch(r){console.log(r)}finally{t.value=!1}}async function w(){t.value=!0;try{await P.startLessonReview(s.params.id.toString()),window.location.reload()}catch(r){console.log(r)}finally{t.value=!1}}async function g(){t.value=!0;try{await P.acceptLesson(s.params.id.toString()),window.location.reload()}catch(r){console.log(r)}finally{t.value=!1}}async function $(){l.value=!0;try{await P.rejectLesson(s.params.id.toString()),window.location.reload()}catch(r){console.log(r)}finally{l.value=!1}}async function m(){t.value=!0;try{await P.editLesson(s.params.id.toString()),window.location.reload()}catch(r){console.log(r)}finally{t.value=!1}}async function b(){t.value=!0;try{await P.publishLesson(s.params.id.toString()),window.location.reload()}catch(r){console.log(r)}finally{t.value=!1}}async function L(){l.value=!0;try{await P.hideLesson(s.params.id.toString()),window.location.reload()}catch(r){console.log(r)}finally{l.value=!1}}async function S(){t.value=!0;try{await P.modifyLesson(s.params.id.toString()),window.location.reload()}catch(r){console.log(r)}finally{t.value=!1}}return(r,x)=>{var f,U,F,I,X,Z,ee,N,D,K,z,te,W,ne,we;const v=A;return((f=k(n))==null?void 0:f.stage)=="prepare_for_submission"?(d(),h("div",Bn,[((U=k(i))==null?void 0:U.user_type)=="contributor"?(d(),h("div",Vn,[u(v,{label:"Send for review",severity:"info",size:"small",onClick:p,disabled:t.value,loading:t.value},null,8,["disabled","loading"])])):T("",!0)])):((F=k(n))==null?void 0:F.stage)=="waiting_for_review"?(d(),h("div",Tn,[((I=k(i))==null?void 0:I.user_type)=="contributor"?(d(),h("div",Dn,[u(v,{label:"Cancel submission",severity:"danger",size:"small",onClick:c,disabled:t.value,loading:t.value},null,8,["disabled","loading"])])):((X=k(i))==null?void 0:X.user_type)=="editor"?(d(),h("div",Fn,[u(v,{label:"Start review",severity:"info",size:"small",onClick:w,disabled:t.value,loading:t.value},null,8,["disabled","loading"])])):T("",!0)])):((Z=k(n))==null?void 0:Z.stage)=="in_review"?(d(),h("div",zn,[((ee=k(i))==null?void 0:ee.user_type)=="editor"?(d(),h("div",An,[u(v,{label:"Reject",severity:"danger",size:"small",onClick:$,disabled:t.value||l.value,loading:l.value},null,8,["disabled","loading"]),u(v,{label:"Accept",size:"small",onClick:g,disabled:t.value||l.value,loading:t.value},null,8,["disabled","loading"])])):T("",!0)])):((N=k(n))==null?void 0:N.stage)=="rejected"?(d(),h("div",Rn,[((D=k(i))==null?void 0:D.user_type)=="contributor"?(d(),h("div",Pn,[u(v,{label:"Edit submission",severity:"info",size:"small",onClick:m,disabled:t.value,loading:t.value},null,8,["disabled","loading"])])):T("",!0)])):((K=k(n))==null?void 0:K.stage)=="ready_for_publish"?(d(),h("div",En,[((z=k(i))==null?void 0:z.user_type)=="editor"?(d(),h("div",Mn,[k(n).createdBy!=Number(k(i).user_id)?(d(),C(v,{key:0,label:"Reject",severity:"danger",size:"small",onClick:$,disabled:t.value||l.value,loading:l.value},null,8,["disabled","loading"])):T("",!0),u(v,{label:"Publish",size:"small",onClick:b,disabled:t.value||l.value,loading:t.value},null,8,["disabled","loading"])])):T("",!0)])):((te=k(n))==null?void 0:te.stage)=="published"?(d(),h("div",Nn,[((W=k(i))==null?void 0:W.user_type)=="editor"?(d(),h("div",jn,[u(v,{label:"Hide",severity:"danger",size:"small",onClick:L,disabled:t.value||l.value,loading:l.value},null,8,["disabled","loading"]),u(v,{label:"Modify",size:"small",onClick:S,disabled:t.value||l.value,loading:t.value},null,8,["disabled","loading"])])):T("",!0)])):((ne=k(n))==null?void 0:ne.stage)=="in_modify"?(d(),h("div",On,[((we=k(i))==null?void 0:we.user_type)=="editor"?(d(),h("div",Gn,[u(v,{label:"Hide",severity:"danger",size:"small",onClick:L,disabled:t.value||l.value,loading:l.value},null,8,["disabled","loading"]),u(v,{label:"Publish",size:"small",onClick:b,disabled:t.value||l.value,loading:t.value},null,8,["disabled","loading"])])):T("",!0)])):T("",!0)}}}),qn={key:0},Jn=V({__name:"StageStatus",setup(o){const s=q(),{selectedLesson:e}=j(s);return(i,a)=>{const n=Qe;return k(e)?(d(),h("div",qn,[["prepare_for_submission","waiting_for_review","in_review","in_modify"].includes(k(e).stage)?(d(),C(n,{key:0,label:k(e).stage.replace(/_/g," ").replace(/^./,t=>t.toUpperCase()),icon:"pi pi-clock",pt:{icon:{class:"text-yellow-500"}},class:"h-8 bg-yellow-50 w-fit"},null,8,["label"])):["ready_for_publish","published"].includes(k(e).stage)?(d(),C(n,{key:1,label:k(e).stage.replace(/_/g," ").replace(/^./,t=>t.toUpperCase()),icon:"pi pi-check-circle",pt:{icon:{class:"text-green-500"}},class:"h-8 bg-green-50 w-fit"},null,8,["label"])):["rejected"].includes(k(e).stage)?(d(),C(n,{key:2,label:k(e).stage.replace(/_/g," ").replace(/^./,t=>t.toUpperCase()),icon:"pi pi-times-circle",pt:{icon:{class:"text-red-500"}},class:"h-8 bg-red-50 w-fit"},null,8,["label"])):T("",!0)])):T("",!0)}}}),Kn={class:"flex flex-col items-center"},Wn={class:"flex justify-between items-center w-full min-h-16 border-b border-gray-200 px-8 shadow-md gap-8"},Yn={class:"flex items-center gap-4"},Qn={class:"flex items-center gap-4"},Xn={class:"w-full h-full max-w-screen-lg px-4 md:px-28 py-8"},Zn={class:"fixed top-32 right-0 pl-2 pr-4 py-2 bg-white rounded-tl-lg rounded-bl-lg shadow-md z-50 border border-gray-200 flex flex-col items-center gap-4"},ro=V({__name:"LessonEditPage",setup(o){const s=H(),e=$e(),i=Se(),{lang:a}=j(i),n=q(),{selectedLesson:t}=j(n),{loadLessonById:l}=n;G(()=>l(Number(s.params.id))),R(a,async(w,g)=>{w!==g&&t.value&&await l(t.value.id)});const p=()=>{const w=s.path.endsWith("/edit")?s.path.replace(/\/edit$/,""):"#";window.open(w,"_blank")};function c(){window.history.length>2?e.go(-1):e.push("/v2/routes")}return(w,g)=>{var m;const $=A;return d(),h("div",Kn,[y("div",Wn,[y("div",Yn,[u($,{icon:"pi pi-times",variant:"text",severity:"contrast",onClick:c}),u(Jn)]),y("div",Qn,[u(Hn)])]),y("div",Xn,[(d(),C(xn,{key:k(a),pages:(m=k(t))==null?void 0:m.pages},null,8,["pages"]))]),y("div",Zn,[u(In),u(k(Ze)),u($,{icon:"pi pi-eye",variant:"text",severity:"contrast",onClick:p})])])}}});export{ro as default};
