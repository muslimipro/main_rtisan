import{h as Qi,d as mu,u as Eu,e as Br,r as Ee,G as bu,H as xu,I as Su,J as Cu,b as qi,o as ut,c as Ct,p as qs,j as Fe,t as En,g as ve,K as Ra,i as ye,w as el,x as eo,D as tl,L as qo,f as nl,M as Pu,F as Ei,l as rl,z as Qt,k as Tu,E as ea,N as Ou,A as ta,C as na,O as Au,P as il,Q as Du,R as _u,S as Iu,T as Mu,_ as wu}from"./index-CG54iUaD.js";import{u as ol,d as ra,_ as ku}from"./defaultConfirmDeleteOptions-BEDASNM7.js";import{R as ti,m as Lu}from"./mapRouteFromDto-0k7GSF4e.js";import{L as Mn}from"./lessonApi-b6EWekY5.js";import{g as Nu}from"./groupLessonsByLevelAndType-D70aJuVS.js";import"./mapLessonFromDto-BxEkOMg4.js";import"./mapUnitFromDto-BXFFFlEW.js";const Ga=["learn","practice","module"],lo={getLevelsByRouteId:Ru,createLevelByRouteId:Gu,updateLevelByIdAndRouteId:ju,deleteLevelByIdAndRouteId:Fu};async function Ru(a){return await Qi.get(`v2/route/${a}/levels`)}async function Gu(a,o){return await Qi.post(`v2/route/${a}/level`,{name:o.name})}async function ju(a,o,n,i){const e={};return i&&(e.lang=i),await Qi.put(`v2/route/${o}/level/${a}`,{language:n.language,learn_count:n.learn_count,name:n.name,practice_count:n.practice_count},{params:e})}async function Fu(a,o){return await Qi.delete(`v2/route/${o}/level/${a}`)}function Bu(a,o){const n=new Map,i={};for(const e of o)n.set(e.id,e.levelId),i[e.levelId]||(i[e.levelId]=[]);for(const e of a){const t=n.get(e.lesson_id);t!==void 0&&i[t].push(e)}return i}const ia=mu("route-edit-store",()=>{const a=Eu(),o=ol(),{lang:n}=Br(o),i=Ee("Order mode"),e=Ee(null),t=Ee({}),r=Ee({}),s=Ee(!1),l=Ee(!1),u=Ee(!1),c=Ee(!1),f=Ee(!1),h=Ee(!1),v=Ee(!1),p=Ee(!1),y=Ee(!1),g=Ee(!1);async function E(L){var k,N,H,oe;try{s.value=!0;const{data:fe}=await ti.getRouteById(L,n.value);e.value=Lu(fe),t.value=Nu(((k=e.value)==null?void 0:k.lessons)??[],((N=e.value)==null?void 0:N.levels)??[]),r.value=Bu(((H=e.value)==null?void 0:H.dependencies)??[],((oe=e.value)==null?void 0:oe.lessons)??[])}catch(fe){a.add({severity:"error",summary:fe.response.data.error,life:2e3})}finally{s.value=!1}}async function b(L,k){try{l.value=!0;const{data:N}=await ti.updateRouteById(L,k,n.value);a.add({severity:"success",summary:N.message,life:2e3})}catch(N){a.add({severity:"error",summary:N.response.data.error,life:2e3})}finally{l.value=!1}}async function x(L){try{u.value=!0;const{data:k}=await ti.deleteRouteById(L);a.add({severity:"success",summary:k.message,life:2e3})}catch(k){a.add({severity:"error",summary:k.response.data.error,life:2e3})}finally{u.value=!1}}async function S(L){try{c.value=!0;const{data:k}=await lo.createLevelByRouteId(e.value.id,L);a.add({severity:"success",summary:k.message,life:2e3})}catch(k){a.add({severity:"error",summary:k.response.data.error,life:2e3})}finally{c.value=!1}}async function C(L,k){try{f.value=!0;const{data:N}=await lo.updateLevelByIdAndRouteId(L,e.value.id,k,n.value);a.add({severity:"success",summary:N.message,life:2e3})}catch(N){a.add({severity:"error",summary:N.response.data.error,life:2e3})}finally{f.value=!1}}async function T(L){try{h.value=!0;const{data:k}=await lo.deleteLevelByIdAndRouteId(L,e.value.id);a.add({severity:"success",summary:k.message,life:2e3})}catch(k){a.add({severity:"error",summary:k.response.data.error,life:2e3})}finally{h.value=!1}}async function O(L){try{v.value=!0;const{data:k}=await Mn.createLesson(L);a.add({severity:"success",summary:k.message,life:2e3})}catch(k){a.add({severity:"error",summary:k.response.data.error,life:2e3})}finally{v.value=!1}}async function P(L,k){try{p.value=!0;const{data:N}=await Mn.updateLessonById(L,k,n.value);a.add({severity:"success",summary:N.message,life:2e3})}catch(N){a.add({severity:"error",summary:N.response.data.error,life:2e3})}finally{p.value=!1}}async function D(L){try{y.value=!0;const{data:k}=await Mn.deleteLessonById(L);a.add({severity:"success",summary:k.message,life:2e3})}catch(k){a.add({severity:"error",summary:k.response.data.error,life:2e3})}finally{y.value=!1}}async function I(L,k){try{g.value=!0;const{data:N}=await ti.updateRouteLessonsOrderById(L,k);a.add({severity:"success",summary:N.message,life:2e3})}catch(N){a.add({severity:"error",summary:N.response.data.error,life:2e3})}finally{g.value=!1}}async function G(L){try{const{data:k}=await Mn.setLessonDependency(L);a.add({severity:"success",summary:k.message,life:2e3})}catch(k){a.add({severity:"error",summary:k.response.data.error,life:2e3})}}async function w(L){try{const{data:k}=await Mn.removeLessonDependency(L);a.add({severity:"success",summary:k.message,life:2e3})}catch(k){a.add({severity:"error",summary:k.response.data.error,life:2e3})}}async function R(L){try{const{data:k}=await Mn.removeAllLessonDependencies(L);a.add({severity:"success",summary:k.message,life:2e3})}catch(k){a.add({severity:"error",summary:k.response.data.error,life:2e3})}}return{mode:i,selectedRoute:e,isRouteLoading:s,isRouteUpdating:l,isRouteDeleting:u,isLevelCreating:c,isLevelUpdating:f,isLevelDeleting:h,isLessonCreating:v,isLessonUpdating:p,isLessonDeleting:y,isOrderUpdating:g,groupedLessons:t,groupedDependencies:r,loadRouteById:E,updateRouteById:b,deleteRouteById:x,createLevel:S,updateLevelById:C,deleteLevelById:T,createLesson:O,updateLessonById:P,deleteLessonById:D,updateRouteLessonsOrderById:I,createLessonDependency:G,deleteLessonDependency:w,deleteAllLessonDependencies:R}});var al={exports:{}};/**!
 * Sortable 1.14.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function ja(a,o){var n=Object.keys(a);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(a);o&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})),n.push.apply(n,i)}return n}function It(a){for(var o=1;o<arguments.length;o++){var n=arguments[o]!=null?arguments[o]:{};o%2?ja(Object(n),!0).forEach(function(i){Uu(a,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(n)):ja(Object(n)).forEach(function(i){Object.defineProperty(a,i,Object.getOwnPropertyDescriptor(n,i))})}return a}function bi(a){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?bi=function(o){return typeof o}:bi=function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},bi(a)}function Uu(a,o,n){return o in a?Object.defineProperty(a,o,{value:n,enumerable:!0,configurable:!0,writable:!0}):a[o]=n,a}function dt(){return dt=Object.assign||function(a){for(var o=1;o<arguments.length;o++){var n=arguments[o];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(a[i]=n[i])}return a},dt.apply(this,arguments)}function Hu(a,o){if(a==null)return{};var n={},i=Object.keys(a),e,t;for(t=0;t<i.length;t++)e=i[t],!(o.indexOf(e)>=0)&&(n[e]=a[e]);return n}function Vu(a,o){if(a==null)return{};var n=Hu(a,o),i,e;if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(a);for(e=0;e<t.length;e++)i=t[e],!(o.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(a,i)&&(n[i]=a[i])}return n}function Yu(a){return Xu(a)||$u(a)||Wu(a)||Ku()}function Xu(a){if(Array.isArray(a))return Do(a)}function $u(a){if(typeof Symbol<"u"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function Wu(a,o){if(a){if(typeof a=="string")return Do(a,o);var n=Object.prototype.toString.call(a).slice(8,-1);if(n==="Object"&&a.constructor&&(n=a.constructor.name),n==="Map"||n==="Set")return Array.from(a);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Do(a,o)}}function Do(a,o){(o==null||o>a.length)&&(o=a.length);for(var n=0,i=new Array(o);n<o;n++)i[n]=a[n];return i}function Ku(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var zu="1.14.0";function Ft(a){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(a)}var Ht=Ft(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),zr=Ft(/Edge/i),Fa=Ft(/firefox/i),kr=Ft(/safari/i)&&!Ft(/chrome/i)&&!Ft(/android/i),sl=Ft(/iP(ad|od|hone)/i),Zu=Ft(/chrome/i)&&Ft(/android/i),ll={capture:!1,passive:!1};function le(a,o,n){a.addEventListener(o,n,!Ht&&ll)}function ae(a,o,n){a.removeEventListener(o,n,!Ht&&ll)}function Mi(a,o){if(o){if(o[0]===">"&&(o=o.substring(1)),a)try{if(a.matches)return a.matches(o);if(a.msMatchesSelector)return a.msMatchesSelector(o);if(a.webkitMatchesSelector)return a.webkitMatchesSelector(o)}catch{return!1}return!1}}function Ju(a){return a.host&&a!==document&&a.host.nodeType?a.host:a.parentNode}function bt(a,o,n,i){if(a){n=n||document;do{if(o!=null&&(o[0]===">"?a.parentNode===n&&Mi(a,o):Mi(a,o))||i&&a===n)return a;if(a===n)break}while(a=Ju(a))}return null}var Ba=/\s+/g;function Ie(a,o,n){if(a&&o)if(a.classList)a.classList[n?"add":"remove"](o);else{var i=(" "+a.className+" ").replace(Ba," ").replace(" "+o+" "," ");a.className=(i+(n?" "+o:"")).replace(Ba," ")}}function V(a,o,n){var i=a&&a.style;if(i){if(n===void 0)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(a,""):a.currentStyle&&(n=a.currentStyle),o===void 0?n:n[o];!(o in i)&&o.indexOf("webkit")===-1&&(o="-webkit-"+o),i[o]=n+(typeof n=="string"?"":"px")}}function bn(a,o){var n="";if(typeof a=="string")n=a;else do{var i=V(a,"transform");i&&i!=="none"&&(n=i+" "+n)}while(!o&&(a=a.parentNode));var e=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return e&&new e(n)}function ul(a,o,n){if(a){var i=a.getElementsByTagName(o),e=0,t=i.length;if(n)for(;e<t;e++)n(i[e],e);return i}return[]}function _t(){var a=document.scrollingElement;return a||document.documentElement}function _e(a,o,n,i,e){if(!(!a.getBoundingClientRect&&a!==window)){var t,r,s,l,u,c,f;if(a!==window&&a.parentNode&&a!==_t()?(t=a.getBoundingClientRect(),r=t.top,s=t.left,l=t.bottom,u=t.right,c=t.height,f=t.width):(r=0,s=0,l=window.innerHeight,u=window.innerWidth,c=window.innerHeight,f=window.innerWidth),(o||n)&&a!==window&&(e=e||a.parentNode,!Ht))do if(e&&e.getBoundingClientRect&&(V(e,"transform")!=="none"||n&&V(e,"position")!=="static")){var h=e.getBoundingClientRect();r-=h.top+parseInt(V(e,"border-top-width")),s-=h.left+parseInt(V(e,"border-left-width")),l=r+t.height,u=s+t.width;break}while(e=e.parentNode);if(i&&a!==window){var v=bn(e||a),p=v&&v.a,y=v&&v.d;v&&(r/=y,s/=p,f/=p,c/=y,l=r+c,u=s+f)}return{top:r,left:s,bottom:l,right:u,width:f,height:c}}}function Ua(a,o,n){for(var i=qt(a,!0),e=_e(a)[o];i;){var t=_e(i)[n],r=void 0;if(r=e>=t,!r)return i;if(i===_t())break;i=qt(i,!1)}return!1}function Qn(a,o,n,i){for(var e=0,t=0,r=a.children;t<r.length;){if(r[t].style.display!=="none"&&r[t]!==Z.ghost&&(i||r[t]!==Z.dragged)&&bt(r[t],n.draggable,a,!1)){if(e===o)return r[t];e++}t++}return null}function oa(a,o){for(var n=a.lastElementChild;n&&(n===Z.ghost||V(n,"display")==="none"||o&&!Mi(n,o));)n=n.previousElementSibling;return n||null}function ke(a,o){var n=0;if(!a||!a.parentNode)return-1;for(;a=a.previousElementSibling;)a.nodeName.toUpperCase()!=="TEMPLATE"&&a!==Z.clone&&(!o||Mi(a,o))&&n++;return n}function Ha(a){var o=0,n=0,i=_t();if(a)do{var e=bn(a),t=e.a,r=e.d;o+=a.scrollLeft*t,n+=a.scrollTop*r}while(a!==i&&(a=a.parentNode));return[o,n]}function Qu(a,o){for(var n in a)if(a.hasOwnProperty(n)){for(var i in o)if(o.hasOwnProperty(i)&&o[i]===a[n][i])return Number(n)}return-1}function qt(a,o){if(!a||!a.getBoundingClientRect)return _t();var n=a,i=!1;do if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var e=V(n);if(n.clientWidth<n.scrollWidth&&(e.overflowX=="auto"||e.overflowX=="scroll")||n.clientHeight<n.scrollHeight&&(e.overflowY=="auto"||e.overflowY=="scroll")){if(!n.getBoundingClientRect||n===document.body)return _t();if(i||o)return n;i=!0}}while(n=n.parentNode);return _t()}function qu(a,o){if(a&&o)for(var n in o)o.hasOwnProperty(n)&&(a[n]=o[n]);return a}function uo(a,o){return Math.round(a.top)===Math.round(o.top)&&Math.round(a.left)===Math.round(o.left)&&Math.round(a.height)===Math.round(o.height)&&Math.round(a.width)===Math.round(o.width)}var Lr;function cl(a,o){return function(){if(!Lr){var n=arguments,i=this;n.length===1?a.call(i,n[0]):a.apply(i,n),Lr=setTimeout(function(){Lr=void 0},o)}}}function ec(){clearTimeout(Lr),Lr=void 0}function fl(a,o,n){a.scrollLeft+=o,a.scrollTop+=n}function aa(a){var o=window.Polymer,n=window.jQuery||window.Zepto;return o&&o.dom?o.dom(a).cloneNode(!0):n?n(a).clone(!0)[0]:a.cloneNode(!0)}function Va(a,o){V(a,"position","absolute"),V(a,"top",o.top),V(a,"left",o.left),V(a,"width",o.width),V(a,"height",o.height)}function co(a){V(a,"position",""),V(a,"top",""),V(a,"left",""),V(a,"width",""),V(a,"height","")}var Je="Sortable"+new Date().getTime();function tc(){var a=[],o;return{captureAnimationState:function(){if(a=[],!!this.options.animation){var i=[].slice.call(this.el.children);i.forEach(function(e){if(!(V(e,"display")==="none"||e===Z.ghost)){a.push({target:e,rect:_e(e)});var t=It({},a[a.length-1].rect);if(e.thisAnimationDuration){var r=bn(e,!0);r&&(t.top-=r.f,t.left-=r.e)}e.fromRect=t}})}},addAnimationState:function(i){a.push(i)},removeAnimationState:function(i){a.splice(Qu(a,{target:i}),1)},animateAll:function(i){var e=this;if(!this.options.animation){clearTimeout(o),typeof i=="function"&&i();return}var t=!1,r=0;a.forEach(function(s){var l=0,u=s.target,c=u.fromRect,f=_e(u),h=u.prevFromRect,v=u.prevToRect,p=s.rect,y=bn(u,!0);y&&(f.top-=y.f,f.left-=y.e),u.toRect=f,u.thisAnimationDuration&&uo(h,f)&&!uo(c,f)&&(p.top-f.top)/(p.left-f.left)===(c.top-f.top)/(c.left-f.left)&&(l=rc(p,h,v,e.options)),uo(f,c)||(u.prevFromRect=c,u.prevToRect=f,l||(l=e.options.animation),e.animate(u,p,f,l)),l&&(t=!0,r=Math.max(r,l),clearTimeout(u.animationResetTimer),u.animationResetTimer=setTimeout(function(){u.animationTime=0,u.prevFromRect=null,u.fromRect=null,u.prevToRect=null,u.thisAnimationDuration=null},l),u.thisAnimationDuration=l)}),clearTimeout(o),t?o=setTimeout(function(){typeof i=="function"&&i()},r):typeof i=="function"&&i(),a=[]},animate:function(i,e,t,r){if(r){V(i,"transition",""),V(i,"transform","");var s=bn(this.el),l=s&&s.a,u=s&&s.d,c=(e.left-t.left)/(l||1),f=(e.top-t.top)/(u||1);i.animatingX=!!c,i.animatingY=!!f,V(i,"transform","translate3d("+c+"px,"+f+"px,0)"),this.forRepaintDummy=nc(i),V(i,"transition","transform "+r+"ms"+(this.options.easing?" "+this.options.easing:"")),V(i,"transform","translate3d(0,0,0)"),typeof i.animated=="number"&&clearTimeout(i.animated),i.animated=setTimeout(function(){V(i,"transition",""),V(i,"transform",""),i.animated=!1,i.animatingX=!1,i.animatingY=!1},r)}}}}function nc(a){return a.offsetWidth}function rc(a,o,n,i){return Math.sqrt(Math.pow(o.top-a.top,2)+Math.pow(o.left-a.left,2))/Math.sqrt(Math.pow(o.top-n.top,2)+Math.pow(o.left-n.left,2))*i.animation}var wn=[],fo={initializeByDefault:!0},Zr={mount:function(o){for(var n in fo)fo.hasOwnProperty(n)&&!(n in o)&&(o[n]=fo[n]);wn.forEach(function(i){if(i.pluginName===o.pluginName)throw"Sortable: Cannot mount plugin ".concat(o.pluginName," more than once")}),wn.push(o)},pluginEvent:function(o,n,i){var e=this;this.eventCanceled=!1,i.cancel=function(){e.eventCanceled=!0};var t=o+"Global";wn.forEach(function(r){n[r.pluginName]&&(n[r.pluginName][t]&&n[r.pluginName][t](It({sortable:n},i)),n.options[r.pluginName]&&n[r.pluginName][o]&&n[r.pluginName][o](It({sortable:n},i)))})},initializePlugins:function(o,n,i,e){wn.forEach(function(s){var l=s.pluginName;if(!(!o.options[l]&&!s.initializeByDefault)){var u=new s(o,n,o.options);u.sortable=o,u.options=o.options,o[l]=u,dt(i,u.defaults)}});for(var t in o.options)if(o.options.hasOwnProperty(t)){var r=this.modifyOption(o,t,o.options[t]);typeof r<"u"&&(o.options[t]=r)}},getEventProperties:function(o,n){var i={};return wn.forEach(function(e){typeof e.eventProperties=="function"&&dt(i,e.eventProperties.call(n[e.pluginName],o))}),i},modifyOption:function(o,n,i){var e;return wn.forEach(function(t){o[t.pluginName]&&t.optionListeners&&typeof t.optionListeners[n]=="function"&&(e=t.optionListeners[n].call(o[t.pluginName],i))}),e}};function Pr(a){var o=a.sortable,n=a.rootEl,i=a.name,e=a.targetEl,t=a.cloneEl,r=a.toEl,s=a.fromEl,l=a.oldIndex,u=a.newIndex,c=a.oldDraggableIndex,f=a.newDraggableIndex,h=a.originalEvent,v=a.putSortable,p=a.extraEventProperties;if(o=o||n&&n[Je],!!o){var y,g=o.options,E="on"+i.charAt(0).toUpperCase()+i.substr(1);window.CustomEvent&&!Ht&&!zr?y=new CustomEvent(i,{bubbles:!0,cancelable:!0}):(y=document.createEvent("Event"),y.initEvent(i,!0,!0)),y.to=r||n,y.from=s||n,y.item=e||n,y.clone=t,y.oldIndex=l,y.newIndex=u,y.oldDraggableIndex=c,y.newDraggableIndex=f,y.originalEvent=h,y.pullMode=v?v.lastPutMode:void 0;var b=It(It({},p),Zr.getEventProperties(i,o));for(var x in b)y[x]=b[x];n&&n.dispatchEvent(y),g[E]&&g[E].call(o,y)}}var ic=["evt"],rt=function(o,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},e=i.evt,t=Vu(i,ic);Zr.pluginEvent.bind(Z)(o,n,It({dragEl:F,parentEl:Me,ghostEl:re,rootEl:Oe,nextEl:pn,lastDownEl:xi,cloneEl:we,cloneHidden:Zt,dragStarted:Tr,putSortable:Ke,activeSortable:Z.active,originalEvent:e,oldIndex:$n,oldDraggableIndex:Nr,newIndex:st,newDraggableIndex:zt,hideGhostForTarget:pl,unhideGhostForTarget:gl,cloneNowHidden:function(){Zt=!0},cloneNowShown:function(){Zt=!1},dispatchSortableEvent:function(s){qe({sortable:n,name:s,originalEvent:e})}},t))};function qe(a){Pr(It({putSortable:Ke,cloneEl:we,targetEl:F,rootEl:Oe,oldIndex:$n,oldDraggableIndex:Nr,newIndex:st,newDraggableIndex:zt},a))}var F,Me,re,Oe,pn,xi,we,Zt,$n,st,Nr,zt,ni,Ke,Yn=!1,wi=!1,ki=[],ln,gt,ho,vo,Ya,Xa,Tr,kn,Rr,Gr=!1,ri=!1,Si,Ze,po=[],_o=!1,Li=[],to=typeof document<"u",ii=sl,$a=zr||Ht?"cssFloat":"float",oc=to&&!Zu&&!sl&&"draggable"in document.createElement("div"),hl=function(){if(to){if(Ht)return!1;var a=document.createElement("x");return a.style.cssText="pointer-events:auto",a.style.pointerEvents==="auto"}}(),dl=function(o,n){var i=V(o),e=parseInt(i.width)-parseInt(i.paddingLeft)-parseInt(i.paddingRight)-parseInt(i.borderLeftWidth)-parseInt(i.borderRightWidth),t=Qn(o,0,n),r=Qn(o,1,n),s=t&&V(t),l=r&&V(r),u=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+_e(t).width,c=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+_e(r).width;if(i.display==="flex")return i.flexDirection==="column"||i.flexDirection==="column-reverse"?"vertical":"horizontal";if(i.display==="grid")return i.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(t&&s.float&&s.float!=="none"){var f=s.float==="left"?"left":"right";return r&&(l.clear==="both"||l.clear===f)?"vertical":"horizontal"}return t&&(s.display==="block"||s.display==="flex"||s.display==="table"||s.display==="grid"||u>=e&&i[$a]==="none"||r&&i[$a]==="none"&&u+c>e)?"vertical":"horizontal"},ac=function(o,n,i){var e=i?o.left:o.top,t=i?o.right:o.bottom,r=i?o.width:o.height,s=i?n.left:n.top,l=i?n.right:n.bottom,u=i?n.width:n.height;return e===s||t===l||e+r/2===s+u/2},sc=function(o,n){var i;return ki.some(function(e){var t=e[Je].options.emptyInsertThreshold;if(!(!t||oa(e))){var r=_e(e),s=o>=r.left-t&&o<=r.right+t,l=n>=r.top-t&&n<=r.bottom+t;if(s&&l)return i=e}}),i},vl=function(o){function n(t,r){return function(s,l,u,c){var f=s.options.group.name&&l.options.group.name&&s.options.group.name===l.options.group.name;if(t==null&&(r||f))return!0;if(t==null||t===!1)return!1;if(r&&t==="clone")return t;if(typeof t=="function")return n(t(s,l,u,c),r)(s,l,u,c);var h=(r?s:l).options.group.name;return t===!0||typeof t=="string"&&t===h||t.join&&t.indexOf(h)>-1}}var i={},e=o.group;(!e||bi(e)!="object")&&(e={name:e}),i.name=e.name,i.checkPull=n(e.pull,!0),i.checkPut=n(e.put),i.revertClone=e.revertClone,o.group=i},pl=function(){!hl&&re&&V(re,"display","none")},gl=function(){!hl&&re&&V(re,"display","")};to&&document.addEventListener("click",function(a){if(wi)return a.preventDefault(),a.stopPropagation&&a.stopPropagation(),a.stopImmediatePropagation&&a.stopImmediatePropagation(),wi=!1,!1},!0);var un=function(o){if(F){o=o.touches?o.touches[0]:o;var n=sc(o.clientX,o.clientY);if(n){var i={};for(var e in o)o.hasOwnProperty(e)&&(i[e]=o[e]);i.target=i.rootEl=n,i.preventDefault=void 0,i.stopPropagation=void 0,n[Je]._onDragOver(i)}}},lc=function(o){F&&F.parentNode[Je]._isOutsideThisEl(o.target)};function Z(a,o){if(!(a&&a.nodeType&&a.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(a));this.el=a,this.options=o=dt({},o),a[Je]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(a.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return dl(a,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(r,s){r.setData("Text",s.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:Z.supportPointer!==!1&&"PointerEvent"in window&&!kr,emptyInsertThreshold:5};Zr.initializePlugins(this,a,n);for(var i in n)!(i in o)&&(o[i]=n[i]);vl(o);for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this));this.nativeDraggable=o.forceFallback?!1:oc,this.nativeDraggable&&(this.options.touchStartThreshold=1),o.supportPointer?le(a,"pointerdown",this._onTapStart):(le(a,"mousedown",this._onTapStart),le(a,"touchstart",this._onTapStart)),this.nativeDraggable&&(le(a,"dragover",this),le(a,"dragenter",this)),ki.push(this.el),o.store&&o.store.get&&this.sort(o.store.get(this)||[]),dt(this,tc())}Z.prototype={constructor:Z,_isOutsideThisEl:function(o){!this.el.contains(o)&&o!==this.el&&(kn=null)},_getDirection:function(o,n){return typeof this.options.direction=="function"?this.options.direction.call(this,o,n,F):this.options.direction},_onTapStart:function(o){if(o.cancelable){var n=this,i=this.el,e=this.options,t=e.preventOnFilter,r=o.type,s=o.touches&&o.touches[0]||o.pointerType&&o.pointerType==="touch"&&o,l=(s||o).target,u=o.target.shadowRoot&&(o.path&&o.path[0]||o.composedPath&&o.composedPath()[0])||l,c=e.filter;if(gc(i),!F&&!(/mousedown|pointerdown/.test(r)&&o.button!==0||e.disabled)&&!u.isContentEditable&&!(!this.nativeDraggable&&kr&&l&&l.tagName.toUpperCase()==="SELECT")&&(l=bt(l,e.draggable,i,!1),!(l&&l.animated)&&xi!==l)){if($n=ke(l),Nr=ke(l,e.draggable),typeof c=="function"){if(c.call(this,o,l,this)){qe({sortable:n,rootEl:u,name:"filter",targetEl:l,toEl:i,fromEl:i}),rt("filter",n,{evt:o}),t&&o.cancelable&&o.preventDefault();return}}else if(c&&(c=c.split(",").some(function(f){if(f=bt(u,f.trim(),i,!1),f)return qe({sortable:n,rootEl:f,name:"filter",targetEl:l,fromEl:i,toEl:i}),rt("filter",n,{evt:o}),!0}),c)){t&&o.cancelable&&o.preventDefault();return}e.handle&&!bt(u,e.handle,i,!1)||this._prepareDragStart(o,s,l)}}},_prepareDragStart:function(o,n,i){var e=this,t=e.el,r=e.options,s=t.ownerDocument,l;if(i&&!F&&i.parentNode===t){var u=_e(i);if(Oe=t,F=i,Me=F.parentNode,pn=F.nextSibling,xi=i,ni=r.group,Z.dragged=F,ln={target:F,clientX:(n||o).clientX,clientY:(n||o).clientY},Ya=ln.clientX-u.left,Xa=ln.clientY-u.top,this._lastX=(n||o).clientX,this._lastY=(n||o).clientY,F.style["will-change"]="all",l=function(){if(rt("delayEnded",e,{evt:o}),Z.eventCanceled){e._onDrop();return}e._disableDelayedDragEvents(),!Fa&&e.nativeDraggable&&(F.draggable=!0),e._triggerDragStart(o,n),qe({sortable:e,name:"choose",originalEvent:o}),Ie(F,r.chosenClass,!0)},r.ignore.split(",").forEach(function(c){ul(F,c.trim(),go)}),le(s,"dragover",un),le(s,"mousemove",un),le(s,"touchmove",un),le(s,"mouseup",e._onDrop),le(s,"touchend",e._onDrop),le(s,"touchcancel",e._onDrop),Fa&&this.nativeDraggable&&(this.options.touchStartThreshold=4,F.draggable=!0),rt("delayStart",this,{evt:o}),r.delay&&(!r.delayOnTouchOnly||n)&&(!this.nativeDraggable||!(zr||Ht))){if(Z.eventCanceled){this._onDrop();return}le(s,"mouseup",e._disableDelayedDrag),le(s,"touchend",e._disableDelayedDrag),le(s,"touchcancel",e._disableDelayedDrag),le(s,"mousemove",e._delayedDragTouchMoveHandler),le(s,"touchmove",e._delayedDragTouchMoveHandler),r.supportPointer&&le(s,"pointermove",e._delayedDragTouchMoveHandler),e._dragStartTimer=setTimeout(l,r.delay)}else l()}},_delayedDragTouchMoveHandler:function(o){var n=o.touches?o.touches[0]:o;Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){F&&go(F),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var o=this.el.ownerDocument;ae(o,"mouseup",this._disableDelayedDrag),ae(o,"touchend",this._disableDelayedDrag),ae(o,"touchcancel",this._disableDelayedDrag),ae(o,"mousemove",this._delayedDragTouchMoveHandler),ae(o,"touchmove",this._delayedDragTouchMoveHandler),ae(o,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(o,n){n=n||o.pointerType=="touch"&&o,!this.nativeDraggable||n?this.options.supportPointer?le(document,"pointermove",this._onTouchMove):n?le(document,"touchmove",this._onTouchMove):le(document,"mousemove",this._onTouchMove):(le(F,"dragend",this),le(Oe,"dragstart",this._onDragStart));try{document.selection?Ci(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(o,n){if(Yn=!1,Oe&&F){rt("dragStarted",this,{evt:n}),this.nativeDraggable&&le(document,"dragover",lc);var i=this.options;!o&&Ie(F,i.dragClass,!1),Ie(F,i.ghostClass,!0),Z.active=this,o&&this._appendGhost(),qe({sortable:this,name:"start",originalEvent:n})}else this._nulling()},_emulateDragOver:function(){if(gt){this._lastX=gt.clientX,this._lastY=gt.clientY,pl();for(var o=document.elementFromPoint(gt.clientX,gt.clientY),n=o;o&&o.shadowRoot&&(o=o.shadowRoot.elementFromPoint(gt.clientX,gt.clientY),o!==n);)n=o;if(F.parentNode[Je]._isOutsideThisEl(o),n)do{if(n[Je]){var i=void 0;if(i=n[Je]._onDragOver({clientX:gt.clientX,clientY:gt.clientY,target:o,rootEl:n}),i&&!this.options.dragoverBubble)break}o=n}while(n=n.parentNode);gl()}},_onTouchMove:function(o){if(ln){var n=this.options,i=n.fallbackTolerance,e=n.fallbackOffset,t=o.touches?o.touches[0]:o,r=re&&bn(re,!0),s=re&&r&&r.a,l=re&&r&&r.d,u=ii&&Ze&&Ha(Ze),c=(t.clientX-ln.clientX+e.x)/(s||1)+(u?u[0]-po[0]:0)/(s||1),f=(t.clientY-ln.clientY+e.y)/(l||1)+(u?u[1]-po[1]:0)/(l||1);if(!Z.active&&!Yn){if(i&&Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))<i)return;this._onDragStart(o,!0)}if(re){r?(r.e+=c-(ho||0),r.f+=f-(vo||0)):r={a:1,b:0,c:0,d:1,e:c,f};var h="matrix(".concat(r.a,",").concat(r.b,",").concat(r.c,",").concat(r.d,",").concat(r.e,",").concat(r.f,")");V(re,"webkitTransform",h),V(re,"mozTransform",h),V(re,"msTransform",h),V(re,"transform",h),ho=c,vo=f,gt=t}o.cancelable&&o.preventDefault()}},_appendGhost:function(){if(!re){var o=this.options.fallbackOnBody?document.body:Oe,n=_e(F,!0,ii,!0,o),i=this.options;if(ii){for(Ze=o;V(Ze,"position")==="static"&&V(Ze,"transform")==="none"&&Ze!==document;)Ze=Ze.parentNode;Ze!==document.body&&Ze!==document.documentElement?(Ze===document&&(Ze=_t()),n.top+=Ze.scrollTop,n.left+=Ze.scrollLeft):Ze=_t(),po=Ha(Ze)}re=F.cloneNode(!0),Ie(re,i.ghostClass,!1),Ie(re,i.fallbackClass,!0),Ie(re,i.dragClass,!0),V(re,"transition",""),V(re,"transform",""),V(re,"box-sizing","border-box"),V(re,"margin",0),V(re,"top",n.top),V(re,"left",n.left),V(re,"width",n.width),V(re,"height",n.height),V(re,"opacity","0.8"),V(re,"position",ii?"absolute":"fixed"),V(re,"zIndex","100000"),V(re,"pointerEvents","none"),Z.ghost=re,o.appendChild(re),V(re,"transform-origin",Ya/parseInt(re.style.width)*100+"% "+Xa/parseInt(re.style.height)*100+"%")}},_onDragStart:function(o,n){var i=this,e=o.dataTransfer,t=i.options;if(rt("dragStart",this,{evt:o}),Z.eventCanceled){this._onDrop();return}rt("setupClone",this),Z.eventCanceled||(we=aa(F),we.draggable=!1,we.style["will-change"]="",this._hideClone(),Ie(we,this.options.chosenClass,!1),Z.clone=we),i.cloneId=Ci(function(){rt("clone",i),!Z.eventCanceled&&(i.options.removeCloneOnHide||Oe.insertBefore(we,F),i._hideClone(),qe({sortable:i,name:"clone"}))}),!n&&Ie(F,t.dragClass,!0),n?(wi=!0,i._loopId=setInterval(i._emulateDragOver,50)):(ae(document,"mouseup",i._onDrop),ae(document,"touchend",i._onDrop),ae(document,"touchcancel",i._onDrop),e&&(e.effectAllowed="move",t.setData&&t.setData.call(i,e,F)),le(document,"drop",i),V(F,"transform","translateZ(0)")),Yn=!0,i._dragStartId=Ci(i._dragStarted.bind(i,n,o)),le(document,"selectstart",i),Tr=!0,kr&&V(document.body,"user-select","none")},_onDragOver:function(o){var n=this.el,i=o.target,e,t,r,s=this.options,l=s.group,u=Z.active,c=ni===l,f=s.sort,h=Ke||u,v,p=this,y=!1;if(_o)return;function g(oe,fe){rt(oe,p,It({evt:o,isOwner:c,axis:v?"vertical":"horizontal",revert:r,dragRect:e,targetRect:t,canSort:f,fromSortable:h,target:i,completed:b,onMove:function(Se,B){return oi(Oe,n,F,e,Se,_e(Se),o,B)},changed:x},fe))}function E(){g("dragOverAnimationCapture"),p.captureAnimationState(),p!==h&&h.captureAnimationState()}function b(oe){return g("dragOverCompleted",{insertion:oe}),oe&&(c?u._hideClone():u._showClone(p),p!==h&&(Ie(F,Ke?Ke.options.ghostClass:u.options.ghostClass,!1),Ie(F,s.ghostClass,!0)),Ke!==p&&p!==Z.active?Ke=p:p===Z.active&&Ke&&(Ke=null),h===p&&(p._ignoreWhileAnimating=i),p.animateAll(function(){g("dragOverAnimationComplete"),p._ignoreWhileAnimating=null}),p!==h&&(h.animateAll(),h._ignoreWhileAnimating=null)),(i===F&&!F.animated||i===n&&!i.animated)&&(kn=null),!s.dragoverBubble&&!o.rootEl&&i!==document&&(F.parentNode[Je]._isOutsideThisEl(o.target),!oe&&un(o)),!s.dragoverBubble&&o.stopPropagation&&o.stopPropagation(),y=!0}function x(){st=ke(F),zt=ke(F,s.draggable),qe({sortable:p,name:"change",toEl:n,newIndex:st,newDraggableIndex:zt,originalEvent:o})}if(o.preventDefault!==void 0&&o.cancelable&&o.preventDefault(),i=bt(i,s.draggable,n,!0),g("dragOver"),Z.eventCanceled)return y;if(F.contains(o.target)||i.animated&&i.animatingX&&i.animatingY||p._ignoreWhileAnimating===i)return b(!1);if(wi=!1,u&&!s.disabled&&(c?f||(r=Me!==Oe):Ke===this||(this.lastPutMode=ni.checkPull(this,u,F,o))&&l.checkPut(this,u,F,o))){if(v=this._getDirection(o,i)==="vertical",e=_e(F),g("dragOverValid"),Z.eventCanceled)return y;if(r)return Me=Oe,E(),this._hideClone(),g("revert"),Z.eventCanceled||(pn?Oe.insertBefore(F,pn):Oe.appendChild(F)),b(!0);var S=oa(n,s.draggable);if(!S||hc(o,v,this)&&!S.animated){if(S===F)return b(!1);if(S&&n===o.target&&(i=S),i&&(t=_e(i)),oi(Oe,n,F,e,i,t,o,!!i)!==!1)return E(),n.appendChild(F),Me=n,x(),b(!0)}else if(S&&fc(o,v,this)){var C=Qn(n,0,s,!0);if(C===F)return b(!1);if(i=C,t=_e(i),oi(Oe,n,F,e,i,t,o,!1)!==!1)return E(),n.insertBefore(F,C),Me=n,x(),b(!0)}else if(i.parentNode===n){t=_e(i);var T=0,O,P=F.parentNode!==n,D=!ac(F.animated&&F.toRect||e,i.animated&&i.toRect||t,v),I=v?"top":"left",G=Ua(i,"top","top")||Ua(F,"top","top"),w=G?G.scrollTop:void 0;kn!==i&&(O=t[I],Gr=!1,ri=!D&&s.invertSwap||P),T=dc(o,i,t,v,D?1:s.swapThreshold,s.invertedSwapThreshold==null?s.swapThreshold:s.invertedSwapThreshold,ri,kn===i);var R;if(T!==0){var L=ke(F);do L-=T,R=Me.children[L];while(R&&(V(R,"display")==="none"||R===re))}if(T===0||R===i)return b(!1);kn=i,Rr=T;var k=i.nextElementSibling,N=!1;N=T===1;var H=oi(Oe,n,F,e,i,t,o,N);if(H!==!1)return(H===1||H===-1)&&(N=H===1),_o=!0,setTimeout(cc,30),E(),N&&!k?n.appendChild(F):i.parentNode.insertBefore(F,N?k:i),G&&fl(G,0,w-G.scrollTop),Me=F.parentNode,O!==void 0&&!ri&&(Si=Math.abs(O-_e(i)[I])),x(),b(!0)}if(n.contains(F))return b(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){ae(document,"mousemove",this._onTouchMove),ae(document,"touchmove",this._onTouchMove),ae(document,"pointermove",this._onTouchMove),ae(document,"dragover",un),ae(document,"mousemove",un),ae(document,"touchmove",un)},_offUpEvents:function(){var o=this.el.ownerDocument;ae(o,"mouseup",this._onDrop),ae(o,"touchend",this._onDrop),ae(o,"pointerup",this._onDrop),ae(o,"touchcancel",this._onDrop),ae(document,"selectstart",this)},_onDrop:function(o){var n=this.el,i=this.options;if(st=ke(F),zt=ke(F,i.draggable),rt("drop",this,{evt:o}),Me=F&&F.parentNode,st=ke(F),zt=ke(F,i.draggable),Z.eventCanceled){this._nulling();return}Yn=!1,ri=!1,Gr=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Io(this.cloneId),Io(this._dragStartId),this.nativeDraggable&&(ae(document,"drop",this),ae(n,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),kr&&V(document.body,"user-select",""),V(F,"transform",""),o&&(Tr&&(o.cancelable&&o.preventDefault(),!i.dropBubble&&o.stopPropagation()),re&&re.parentNode&&re.parentNode.removeChild(re),(Oe===Me||Ke&&Ke.lastPutMode!=="clone")&&we&&we.parentNode&&we.parentNode.removeChild(we),F&&(this.nativeDraggable&&ae(F,"dragend",this),go(F),F.style["will-change"]="",Tr&&!Yn&&Ie(F,Ke?Ke.options.ghostClass:this.options.ghostClass,!1),Ie(F,this.options.chosenClass,!1),qe({sortable:this,name:"unchoose",toEl:Me,newIndex:null,newDraggableIndex:null,originalEvent:o}),Oe!==Me?(st>=0&&(qe({rootEl:Me,name:"add",toEl:Me,fromEl:Oe,originalEvent:o}),qe({sortable:this,name:"remove",toEl:Me,originalEvent:o}),qe({rootEl:Me,name:"sort",toEl:Me,fromEl:Oe,originalEvent:o}),qe({sortable:this,name:"sort",toEl:Me,originalEvent:o})),Ke&&Ke.save()):st!==$n&&st>=0&&(qe({sortable:this,name:"update",toEl:Me,originalEvent:o}),qe({sortable:this,name:"sort",toEl:Me,originalEvent:o})),Z.active&&((st==null||st===-1)&&(st=$n,zt=Nr),qe({sortable:this,name:"end",toEl:Me,originalEvent:o}),this.save()))),this._nulling()},_nulling:function(){rt("nulling",this),Oe=F=Me=re=pn=we=xi=Zt=ln=gt=Tr=st=zt=$n=Nr=kn=Rr=Ke=ni=Z.dragged=Z.ghost=Z.clone=Z.active=null,Li.forEach(function(o){o.checked=!0}),Li.length=ho=vo=0},handleEvent:function(o){switch(o.type){case"drop":case"dragend":this._onDrop(o);break;case"dragenter":case"dragover":F&&(this._onDragOver(o),uc(o));break;case"selectstart":o.preventDefault();break}},toArray:function(){for(var o=[],n,i=this.el.children,e=0,t=i.length,r=this.options;e<t;e++)n=i[e],bt(n,r.draggable,this.el,!1)&&o.push(n.getAttribute(r.dataIdAttr)||pc(n));return o},sort:function(o,n){var i={},e=this.el;this.toArray().forEach(function(t,r){var s=e.children[r];bt(s,this.options.draggable,e,!1)&&(i[t]=s)},this),n&&this.captureAnimationState(),o.forEach(function(t){i[t]&&(e.removeChild(i[t]),e.appendChild(i[t]))}),n&&this.animateAll()},save:function(){var o=this.options.store;o&&o.set&&o.set(this)},closest:function(o,n){return bt(o,n||this.options.draggable,this.el,!1)},option:function(o,n){var i=this.options;if(n===void 0)return i[o];var e=Zr.modifyOption(this,o,n);typeof e<"u"?i[o]=e:i[o]=n,o==="group"&&vl(i)},destroy:function(){rt("destroy",this);var o=this.el;o[Je]=null,ae(o,"mousedown",this._onTapStart),ae(o,"touchstart",this._onTapStart),ae(o,"pointerdown",this._onTapStart),this.nativeDraggable&&(ae(o,"dragover",this),ae(o,"dragenter",this)),Array.prototype.forEach.call(o.querySelectorAll("[draggable]"),function(n){n.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),ki.splice(ki.indexOf(this.el),1),this.el=o=null},_hideClone:function(){if(!Zt){if(rt("hideClone",this),Z.eventCanceled)return;V(we,"display","none"),this.options.removeCloneOnHide&&we.parentNode&&we.parentNode.removeChild(we),Zt=!0}},_showClone:function(o){if(o.lastPutMode!=="clone"){this._hideClone();return}if(Zt){if(rt("showClone",this),Z.eventCanceled)return;F.parentNode==Oe&&!this.options.group.revertClone?Oe.insertBefore(we,F):pn?Oe.insertBefore(we,pn):Oe.appendChild(we),this.options.group.revertClone&&this.animate(F,we),V(we,"display",""),Zt=!1}}};function uc(a){a.dataTransfer&&(a.dataTransfer.dropEffect="move"),a.cancelable&&a.preventDefault()}function oi(a,o,n,i,e,t,r,s){var l,u=a[Je],c=u.options.onMove,f;return window.CustomEvent&&!Ht&&!zr?l=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(l=document.createEvent("Event"),l.initEvent("move",!0,!0)),l.to=o,l.from=a,l.dragged=n,l.draggedRect=i,l.related=e||o,l.relatedRect=t||_e(o),l.willInsertAfter=s,l.originalEvent=r,a.dispatchEvent(l),c&&(f=c.call(u,l,r)),f}function go(a){a.draggable=!1}function cc(){_o=!1}function fc(a,o,n){var i=_e(Qn(n.el,0,n.options,!0)),e=10;return o?a.clientX<i.left-e||a.clientY<i.top&&a.clientX<i.right:a.clientY<i.top-e||a.clientY<i.bottom&&a.clientX<i.left}function hc(a,o,n){var i=_e(oa(n.el,n.options.draggable)),e=10;return o?a.clientX>i.right+e||a.clientX<=i.right&&a.clientY>i.bottom&&a.clientX>=i.left:a.clientX>i.right&&a.clientY>i.top||a.clientX<=i.right&&a.clientY>i.bottom+e}function dc(a,o,n,i,e,t,r,s){var l=i?a.clientY:a.clientX,u=i?n.height:n.width,c=i?n.top:n.left,f=i?n.bottom:n.right,h=!1;if(!r){if(s&&Si<u*e){if(!Gr&&(Rr===1?l>c+u*t/2:l<f-u*t/2)&&(Gr=!0),Gr)h=!0;else if(Rr===1?l<c+Si:l>f-Si)return-Rr}else if(l>c+u*(1-e)/2&&l<f-u*(1-e)/2)return vc(o)}return h=h||r,h&&(l<c+u*t/2||l>f-u*t/2)?l>c+u/2?1:-1:0}function vc(a){return ke(F)<ke(a)?1:-1}function pc(a){for(var o=a.tagName+a.className+a.src+a.href+a.textContent,n=o.length,i=0;n--;)i+=o.charCodeAt(n);return i.toString(36)}function gc(a){Li.length=0;for(var o=a.getElementsByTagName("input"),n=o.length;n--;){var i=o[n];i.checked&&Li.push(i)}}function Ci(a){return setTimeout(a,0)}function Io(a){return clearTimeout(a)}to&&le(document,"touchmove",function(a){(Z.active||Yn)&&a.cancelable&&a.preventDefault()});Z.utils={on:le,off:ae,css:V,find:ul,is:function(o,n){return!!bt(o,n,o,!1)},extend:qu,throttle:cl,closest:bt,toggleClass:Ie,clone:aa,index:ke,nextTick:Ci,cancelNextTick:Io,detectDirection:dl,getChild:Qn};Z.get=function(a){return a[Je]};Z.mount=function(){for(var a=arguments.length,o=new Array(a),n=0;n<a;n++)o[n]=arguments[n];o[0].constructor===Array&&(o=o[0]),o.forEach(function(i){if(!i.prototype||!i.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(i));i.utils&&(Z.utils=It(It({},Z.utils),i.utils)),Zr.mount(i)})};Z.create=function(a,o){return new Z(a,o)};Z.version=zu;var Be=[],Or,Mo,wo=!1,yo,mo,Ni,Ar;function yc(){function a(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var o in this)o.charAt(0)==="_"&&typeof this[o]=="function"&&(this[o]=this[o].bind(this))}return a.prototype={dragStarted:function(n){var i=n.originalEvent;this.sortable.nativeDraggable?le(document,"dragover",this._handleAutoScroll):this.options.supportPointer?le(document,"pointermove",this._handleFallbackAutoScroll):i.touches?le(document,"touchmove",this._handleFallbackAutoScroll):le(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(n){var i=n.originalEvent;!this.options.dragOverBubble&&!i.rootEl&&this._handleAutoScroll(i)},drop:function(){this.sortable.nativeDraggable?ae(document,"dragover",this._handleAutoScroll):(ae(document,"pointermove",this._handleFallbackAutoScroll),ae(document,"touchmove",this._handleFallbackAutoScroll),ae(document,"mousemove",this._handleFallbackAutoScroll)),Wa(),Pi(),ec()},nulling:function(){Ni=Mo=Or=wo=Ar=yo=mo=null,Be.length=0},_handleFallbackAutoScroll:function(n){this._handleAutoScroll(n,!0)},_handleAutoScroll:function(n,i){var e=this,t=(n.touches?n.touches[0]:n).clientX,r=(n.touches?n.touches[0]:n).clientY,s=document.elementFromPoint(t,r);if(Ni=n,i||this.options.forceAutoScrollFallback||zr||Ht||kr){Eo(n,this.options,s,i);var l=qt(s,!0);wo&&(!Ar||t!==yo||r!==mo)&&(Ar&&Wa(),Ar=setInterval(function(){var u=qt(document.elementFromPoint(t,r),!0);u!==l&&(l=u,Pi()),Eo(n,e.options,u,i)},10),yo=t,mo=r)}else{if(!this.options.bubbleScroll||qt(s,!0)===_t()){Pi();return}Eo(n,this.options,qt(s,!1),!1)}}},dt(a,{pluginName:"scroll",initializeByDefault:!0})}function Pi(){Be.forEach(function(a){clearInterval(a.pid)}),Be=[]}function Wa(){clearInterval(Ar)}var Eo=cl(function(a,o,n,i){if(o.scroll){var e=(a.touches?a.touches[0]:a).clientX,t=(a.touches?a.touches[0]:a).clientY,r=o.scrollSensitivity,s=o.scrollSpeed,l=_t(),u=!1,c;Mo!==n&&(Mo=n,Pi(),Or=o.scroll,c=o.scrollFn,Or===!0&&(Or=qt(n,!0)));var f=0,h=Or;do{var v=h,p=_e(v),y=p.top,g=p.bottom,E=p.left,b=p.right,x=p.width,S=p.height,C=void 0,T=void 0,O=v.scrollWidth,P=v.scrollHeight,D=V(v),I=v.scrollLeft,G=v.scrollTop;v===l?(C=x<O&&(D.overflowX==="auto"||D.overflowX==="scroll"||D.overflowX==="visible"),T=S<P&&(D.overflowY==="auto"||D.overflowY==="scroll"||D.overflowY==="visible")):(C=x<O&&(D.overflowX==="auto"||D.overflowX==="scroll"),T=S<P&&(D.overflowY==="auto"||D.overflowY==="scroll"));var w=C&&(Math.abs(b-e)<=r&&I+x<O)-(Math.abs(E-e)<=r&&!!I),R=T&&(Math.abs(g-t)<=r&&G+S<P)-(Math.abs(y-t)<=r&&!!G);if(!Be[f])for(var L=0;L<=f;L++)Be[L]||(Be[L]={});(Be[f].vx!=w||Be[f].vy!=R||Be[f].el!==v)&&(Be[f].el=v,Be[f].vx=w,Be[f].vy=R,clearInterval(Be[f].pid),(w!=0||R!=0)&&(u=!0,Be[f].pid=setInterval((function(){i&&this.layer===0&&Z.active._onTouchMove(Ni);var k=Be[this.layer].vy?Be[this.layer].vy*s:0,N=Be[this.layer].vx?Be[this.layer].vx*s:0;typeof c=="function"&&c.call(Z.dragged.parentNode[Je],N,k,a,Ni,Be[this.layer].el)!=="continue"||fl(Be[this.layer].el,N,k)}).bind({layer:f}),24))),f++}while(o.bubbleScroll&&h!==l&&(h=qt(h,!1)));wo=u}},30),yl=function(o){var n=o.originalEvent,i=o.putSortable,e=o.dragEl,t=o.activeSortable,r=o.dispatchSortableEvent,s=o.hideGhostForTarget,l=o.unhideGhostForTarget;if(n){var u=i||t;s();var c=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n,f=document.elementFromPoint(c.clientX,c.clientY);l(),u&&!u.el.contains(f)&&(r("spill"),this.onSpill({dragEl:e,putSortable:i}))}};function sa(){}sa.prototype={startIndex:null,dragStart:function(o){var n=o.oldDraggableIndex;this.startIndex=n},onSpill:function(o){var n=o.dragEl,i=o.putSortable;this.sortable.captureAnimationState(),i&&i.captureAnimationState();var e=Qn(this.sortable.el,this.startIndex,this.options);e?this.sortable.el.insertBefore(n,e):this.sortable.el.appendChild(n),this.sortable.animateAll(),i&&i.animateAll()},drop:yl};dt(sa,{pluginName:"revertOnSpill"});function la(){}la.prototype={onSpill:function(o){var n=o.dragEl,i=o.putSortable,e=i||this.sortable;e.captureAnimationState(),n.parentNode&&n.parentNode.removeChild(n),e.animateAll()},drop:yl};dt(la,{pluginName:"removeOnSpill"});var ct;function mc(){function a(){this.defaults={swapClass:"sortable-swap-highlight"}}return a.prototype={dragStart:function(n){var i=n.dragEl;ct=i},dragOverValid:function(n){var i=n.completed,e=n.target,t=n.onMove,r=n.activeSortable,s=n.changed,l=n.cancel;if(r.options.swap){var u=this.sortable.el,c=this.options;if(e&&e!==u){var f=ct;t(e)!==!1?(Ie(e,c.swapClass,!0),ct=e):ct=null,f&&f!==ct&&Ie(f,c.swapClass,!1)}s(),i(!0),l()}},drop:function(n){var i=n.activeSortable,e=n.putSortable,t=n.dragEl,r=e||this.sortable,s=this.options;ct&&Ie(ct,s.swapClass,!1),ct&&(s.swap||e&&e.options.swap)&&t!==ct&&(r.captureAnimationState(),r!==i&&i.captureAnimationState(),Ec(t,ct),r.animateAll(),r!==i&&i.animateAll())},nulling:function(){ct=null}},dt(a,{pluginName:"swap",eventProperties:function(){return{swapItem:ct}}})}function Ec(a,o){var n=a.parentNode,i=o.parentNode,e,t;!n||!i||n.isEqualNode(o)||i.isEqualNode(a)||(e=ke(a),t=ke(o),n.isEqualNode(i)&&e<t&&t++,n.insertBefore(o,n.children[e]),i.insertBefore(a,i.children[t]))}var ee=[],at=[],dr,yt,vr=!1,it=!1,Ln=!1,Pe,pr,ai;function bc(){function a(o){for(var n in this)n.charAt(0)==="_"&&typeof this[n]=="function"&&(this[n]=this[n].bind(this));o.options.supportPointer?le(document,"pointerup",this._deselectMultiDrag):(le(document,"mouseup",this._deselectMultiDrag),le(document,"touchend",this._deselectMultiDrag)),le(document,"keydown",this._checkKeyDown),le(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,setData:function(e,t){var r="";ee.length&&yt===o?ee.forEach(function(s,l){r+=(l?", ":"")+s.textContent}):r=t.textContent,e.setData("Text",r)}}}return a.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(n){var i=n.dragEl;Pe=i},delayEnded:function(){this.isMultiDrag=~ee.indexOf(Pe)},setupClone:function(n){var i=n.sortable,e=n.cancel;if(this.isMultiDrag){for(var t=0;t<ee.length;t++)at.push(aa(ee[t])),at[t].sortableIndex=ee[t].sortableIndex,at[t].draggable=!1,at[t].style["will-change"]="",Ie(at[t],this.options.selectedClass,!1),ee[t]===Pe&&Ie(at[t],this.options.chosenClass,!1);i._hideClone(),e()}},clone:function(n){var i=n.sortable,e=n.rootEl,t=n.dispatchSortableEvent,r=n.cancel;this.isMultiDrag&&(this.options.removeCloneOnHide||ee.length&&yt===i&&(Ka(!0,e),t("clone"),r()))},showClone:function(n){var i=n.cloneNowShown,e=n.rootEl,t=n.cancel;this.isMultiDrag&&(Ka(!1,e),at.forEach(function(r){V(r,"display","")}),i(),ai=!1,t())},hideClone:function(n){var i=this;n.sortable;var e=n.cloneNowHidden,t=n.cancel;this.isMultiDrag&&(at.forEach(function(r){V(r,"display","none"),i.options.removeCloneOnHide&&r.parentNode&&r.parentNode.removeChild(r)}),e(),ai=!0,t())},dragStartGlobal:function(n){n.sortable,!this.isMultiDrag&&yt&&yt.multiDrag._deselectMultiDrag(),ee.forEach(function(i){i.sortableIndex=ke(i)}),ee=ee.sort(function(i,e){return i.sortableIndex-e.sortableIndex}),Ln=!0},dragStarted:function(n){var i=this,e=n.sortable;if(this.isMultiDrag){if(this.options.sort&&(e.captureAnimationState(),this.options.animation)){ee.forEach(function(r){r!==Pe&&V(r,"position","absolute")});var t=_e(Pe,!1,!0,!0);ee.forEach(function(r){r!==Pe&&Va(r,t)}),it=!0,vr=!0}e.animateAll(function(){it=!1,vr=!1,i.options.animation&&ee.forEach(function(r){co(r)}),i.options.sort&&si()})}},dragOver:function(n){var i=n.target,e=n.completed,t=n.cancel;it&&~ee.indexOf(i)&&(e(!1),t())},revert:function(n){var i=n.fromSortable,e=n.rootEl,t=n.sortable,r=n.dragRect;ee.length>1&&(ee.forEach(function(s){t.addAnimationState({target:s,rect:it?_e(s):r}),co(s),s.fromRect=r,i.removeAnimationState(s)}),it=!1,xc(!this.options.removeCloneOnHide,e))},dragOverCompleted:function(n){var i=n.sortable,e=n.isOwner,t=n.insertion,r=n.activeSortable,s=n.parentEl,l=n.putSortable,u=this.options;if(t){if(e&&r._hideClone(),vr=!1,u.animation&&ee.length>1&&(it||!e&&!r.options.sort&&!l)){var c=_e(Pe,!1,!0,!0);ee.forEach(function(h){h!==Pe&&(Va(h,c),s.appendChild(h))}),it=!0}if(!e)if(it||si(),ee.length>1){var f=ai;r._showClone(i),r.options.animation&&!ai&&f&&at.forEach(function(h){r.addAnimationState({target:h,rect:pr}),h.fromRect=pr,h.thisAnimationDuration=null})}else r._showClone(i)}},dragOverAnimationCapture:function(n){var i=n.dragRect,e=n.isOwner,t=n.activeSortable;if(ee.forEach(function(s){s.thisAnimationDuration=null}),t.options.animation&&!e&&t.multiDrag.isMultiDrag){pr=dt({},i);var r=bn(Pe,!0);pr.top-=r.f,pr.left-=r.e}},dragOverAnimationComplete:function(){it&&(it=!1,si())},drop:function(n){var i=n.originalEvent,e=n.rootEl,t=n.parentEl,r=n.sortable,s=n.dispatchSortableEvent,l=n.oldIndex,u=n.putSortable,c=u||this.sortable;if(i){var f=this.options,h=t.children;if(!Ln)if(f.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),Ie(Pe,f.selectedClass,!~ee.indexOf(Pe)),~ee.indexOf(Pe))ee.splice(ee.indexOf(Pe),1),dr=null,Pr({sortable:r,rootEl:e,name:"deselect",targetEl:Pe,originalEvt:i});else{if(ee.push(Pe),Pr({sortable:r,rootEl:e,name:"select",targetEl:Pe,originalEvt:i}),i.shiftKey&&dr&&r.el.contains(dr)){var v=ke(dr),p=ke(Pe);if(~v&&~p&&v!==p){var y,g;for(p>v?(g=v,y=p):(g=p,y=v+1);g<y;g++)~ee.indexOf(h[g])||(Ie(h[g],f.selectedClass,!0),ee.push(h[g]),Pr({sortable:r,rootEl:e,name:"select",targetEl:h[g],originalEvt:i}))}}else dr=Pe;yt=c}if(Ln&&this.isMultiDrag){if(it=!1,(t[Je].options.sort||t!==e)&&ee.length>1){var E=_e(Pe),b=ke(Pe,":not(."+this.options.selectedClass+")");if(!vr&&f.animation&&(Pe.thisAnimationDuration=null),c.captureAnimationState(),!vr&&(f.animation&&(Pe.fromRect=E,ee.forEach(function(S){if(S.thisAnimationDuration=null,S!==Pe){var C=it?_e(S):E;S.fromRect=C,c.addAnimationState({target:S,rect:C})}})),si(),ee.forEach(function(S){h[b]?t.insertBefore(S,h[b]):t.appendChild(S),b++}),l===ke(Pe))){var x=!1;ee.forEach(function(S){if(S.sortableIndex!==ke(S)){x=!0;return}}),x&&s("update")}ee.forEach(function(S){co(S)}),c.animateAll()}yt=c}(e===t||u&&u.lastPutMode!=="clone")&&at.forEach(function(S){S.parentNode&&S.parentNode.removeChild(S)})}},nullingGlobal:function(){this.isMultiDrag=Ln=!1,at.length=0},destroyGlobal:function(){this._deselectMultiDrag(),ae(document,"pointerup",this._deselectMultiDrag),ae(document,"mouseup",this._deselectMultiDrag),ae(document,"touchend",this._deselectMultiDrag),ae(document,"keydown",this._checkKeyDown),ae(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(n){if(!(typeof Ln<"u"&&Ln)&&yt===this.sortable&&!(n&&bt(n.target,this.options.draggable,this.sortable.el,!1))&&!(n&&n.button!==0))for(;ee.length;){var i=ee[0];Ie(i,this.options.selectedClass,!1),ee.shift(),Pr({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:i,originalEvt:n})}},_checkKeyDown:function(n){n.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(n){n.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},dt(a,{pluginName:"multiDrag",utils:{select:function(n){var i=n.parentNode[Je];!i||!i.options.multiDrag||~ee.indexOf(n)||(yt&&yt!==i&&(yt.multiDrag._deselectMultiDrag(),yt=i),Ie(n,i.options.selectedClass,!0),ee.push(n))},deselect:function(n){var i=n.parentNode[Je],e=ee.indexOf(n);!i||!i.options.multiDrag||!~e||(Ie(n,i.options.selectedClass,!1),ee.splice(e,1))}},eventProperties:function(){var n=this,i=[],e=[];return ee.forEach(function(t){i.push({multiDragElement:t,index:t.sortableIndex});var r;it&&t!==Pe?r=-1:it?r=ke(t,":not(."+n.options.selectedClass+")"):r=ke(t),e.push({multiDragElement:t,index:r})}),{items:Yu(ee),clones:[].concat(at),oldIndicies:i,newIndicies:e}},optionListeners:{multiDragKey:function(n){return n=n.toLowerCase(),n==="ctrl"?n="Control":n.length>1&&(n=n.charAt(0).toUpperCase()+n.substr(1)),n}}})}function xc(a,o){ee.forEach(function(n,i){var e=o.children[n.sortableIndex+(a?Number(i):0)];e?o.insertBefore(n,e):o.appendChild(n)})}function Ka(a,o){at.forEach(function(n,i){var e=o.children[n.sortableIndex+(a?Number(i):0)];e?o.insertBefore(n,e):o.appendChild(n)})}function si(){ee.forEach(function(a){a!==Pe&&a.parentNode&&a.parentNode.removeChild(a)})}Z.mount(new yc);Z.mount(la,sa);const Sc=Object.freeze(Object.defineProperty({__proto__:null,MultiDrag:bc,Sortable:Z,Swap:mc,default:Z},Symbol.toStringTag,{value:"Module"})),Cc=bu(Sc);(function(a,o){(function(i,e){a.exports=e(xu,Cc)})(typeof self<"u"?self:Su,function(n,i){return function(e){var t={};function r(s){if(t[s])return t[s].exports;var l=t[s]={i:s,l:!1,exports:{}};return e[s].call(l.exports,l,l.exports,r),l.l=!0,l.exports}return r.m=e,r.c=t,r.d=function(s,l,u){r.o(s,l)||Object.defineProperty(s,l,{enumerable:!0,get:u})},r.r=function(s){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},r.t=function(s,l){if(l&1&&(s=r(s)),l&8||l&4&&typeof s=="object"&&s&&s.__esModule)return s;var u=Object.create(null);if(r.r(u),Object.defineProperty(u,"default",{enumerable:!0,value:s}),l&2&&typeof s!="string")for(var c in s)r.d(u,c,(function(f){return s[f]}).bind(null,c));return u},r.n=function(s){var l=s&&s.__esModule?function(){return s.default}:function(){return s};return r.d(l,"a",l),l},r.o=function(s,l){return Object.prototype.hasOwnProperty.call(s,l)},r.p="",r(r.s="fb15")}({"00ee":function(e,t,r){var s=r("b622"),l=s("toStringTag"),u={};u[l]="z",e.exports=String(u)==="[object z]"},"0366":function(e,t,r){var s=r("1c0b");e.exports=function(l,u,c){if(s(l),u===void 0)return l;switch(c){case 0:return function(){return l.call(u)};case 1:return function(f){return l.call(u,f)};case 2:return function(f,h){return l.call(u,f,h)};case 3:return function(f,h,v){return l.call(u,f,h,v)}}return function(){return l.apply(u,arguments)}}},"057f":function(e,t,r){var s=r("fc6a"),l=r("241c").f,u={}.toString,c=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],f=function(h){try{return l(h)}catch{return c.slice()}};e.exports.f=function(v){return c&&u.call(v)=="[object Window]"?f(v):l(s(v))}},"06cf":function(e,t,r){var s=r("83ab"),l=r("d1e7"),u=r("5c6c"),c=r("fc6a"),f=r("c04e"),h=r("5135"),v=r("0cfb"),p=Object.getOwnPropertyDescriptor;t.f=s?p:function(g,E){if(g=c(g),E=f(E,!0),v)try{return p(g,E)}catch{}if(h(g,E))return u(!l.f.call(g,E),g[E])}},"0cfb":function(e,t,r){var s=r("83ab"),l=r("d039"),u=r("cc12");e.exports=!s&&!l(function(){return Object.defineProperty(u("div"),"a",{get:function(){return 7}}).a!=7})},"13d5":function(e,t,r){var s=r("23e7"),l=r("d58f").left,u=r("a640"),c=r("ae40"),f=u("reduce"),h=c("reduce",{1:0});s({target:"Array",proto:!0,forced:!f||!h},{reduce:function(p){return l(this,p,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"14c3":function(e,t,r){var s=r("c6b6"),l=r("9263");e.exports=function(u,c){var f=u.exec;if(typeof f=="function"){var h=f.call(u,c);if(typeof h!="object")throw TypeError("RegExp exec method returned something other than an Object or null");return h}if(s(u)!=="RegExp")throw TypeError("RegExp#exec called on incompatible receiver");return l.call(u,c)}},"159b":function(e,t,r){var s=r("da84"),l=r("fdbc"),u=r("17c2"),c=r("9112");for(var f in l){var h=s[f],v=h&&h.prototype;if(v&&v.forEach!==u)try{c(v,"forEach",u)}catch{v.forEach=u}}},"17c2":function(e,t,r){var s=r("b727").forEach,l=r("a640"),u=r("ae40"),c=l("forEach"),f=u("forEach");e.exports=!c||!f?function(v){return s(this,v,arguments.length>1?arguments[1]:void 0)}:[].forEach},"1be4":function(e,t,r){var s=r("d066");e.exports=s("document","documentElement")},"1c0b":function(e,t){e.exports=function(r){if(typeof r!="function")throw TypeError(String(r)+" is not a function");return r}},"1c7e":function(e,t,r){var s=r("b622"),l=s("iterator"),u=!1;try{var c=0,f={next:function(){return{done:!!c++}},return:function(){u=!0}};f[l]=function(){return this},Array.from(f,function(){throw 2})}catch{}e.exports=function(h,v){if(!v&&!u)return!1;var p=!1;try{var y={};y[l]=function(){return{next:function(){return{done:p=!0}}}},h(y)}catch{}return p}},"1d80":function(e,t){e.exports=function(r){if(r==null)throw TypeError("Can't call method on "+r);return r}},"1dde":function(e,t,r){var s=r("d039"),l=r("b622"),u=r("2d00"),c=l("species");e.exports=function(f){return u>=51||!s(function(){var h=[],v=h.constructor={};return v[c]=function(){return{foo:1}},h[f](Boolean).foo!==1})}},"23cb":function(e,t,r){var s=r("a691"),l=Math.max,u=Math.min;e.exports=function(c,f){var h=s(c);return h<0?l(h+f,0):u(h,f)}},"23e7":function(e,t,r){var s=r("da84"),l=r("06cf").f,u=r("9112"),c=r("6eeb"),f=r("ce4e"),h=r("e893"),v=r("94ca");e.exports=function(p,y){var g=p.target,E=p.global,b=p.stat,x,S,C,T,O,P;if(E?S=s:b?S=s[g]||f(g,{}):S=(s[g]||{}).prototype,S)for(C in y){if(O=y[C],p.noTargetGet?(P=l(S,C),T=P&&P.value):T=S[C],x=v(E?C:g+(b?".":"#")+C,p.forced),!x&&T!==void 0){if(typeof O==typeof T)continue;h(O,T)}(p.sham||T&&T.sham)&&u(O,"sham",!0),c(S,C,O,p)}}},"241c":function(e,t,r){var s=r("ca84"),l=r("7839"),u=l.concat("length","prototype");t.f=Object.getOwnPropertyNames||function(f){return s(f,u)}},"25f0":function(e,t,r){var s=r("6eeb"),l=r("825a"),u=r("d039"),c=r("ad6d"),f="toString",h=RegExp.prototype,v=h[f],p=u(function(){return v.call({source:"a",flags:"b"})!="/a/b"}),y=v.name!=f;(p||y)&&s(RegExp.prototype,f,function(){var E=l(this),b=String(E.source),x=E.flags,S=String(x===void 0&&E instanceof RegExp&&!("flags"in h)?c.call(E):x);return"/"+b+"/"+S},{unsafe:!0})},"2ca0":function(e,t,r){var s=r("23e7"),l=r("06cf").f,u=r("50c4"),c=r("5a34"),f=r("1d80"),h=r("ab13"),v=r("c430"),p="".startsWith,y=Math.min,g=h("startsWith"),E=!v&&!g&&!!function(){var b=l(String.prototype,"startsWith");return b&&!b.writable}();s({target:"String",proto:!0,forced:!E&&!g},{startsWith:function(x){var S=String(f(this));c(x);var C=u(y(arguments.length>1?arguments[1]:void 0,S.length)),T=String(x);return p?p.call(S,T,C):S.slice(C,C+T.length)===T}})},"2d00":function(e,t,r){var s=r("da84"),l=r("342f"),u=s.process,c=u&&u.versions,f=c&&c.v8,h,v;f?(h=f.split("."),v=h[0]+h[1]):l&&(h=l.match(/Edge\/(\d+)/),(!h||h[1]>=74)&&(h=l.match(/Chrome\/(\d+)/),h&&(v=h[1]))),e.exports=v&&+v},"342f":function(e,t,r){var s=r("d066");e.exports=s("navigator","userAgent")||""},"35a1":function(e,t,r){var s=r("f5df"),l=r("3f8c"),u=r("b622"),c=u("iterator");e.exports=function(f){if(f!=null)return f[c]||f["@@iterator"]||l[s(f)]}},"37e8":function(e,t,r){var s=r("83ab"),l=r("9bf2"),u=r("825a"),c=r("df75");e.exports=s?Object.defineProperties:function(h,v){u(h);for(var p=c(v),y=p.length,g=0,E;y>g;)l.f(h,E=p[g++],v[E]);return h}},"3bbe":function(e,t,r){var s=r("861d");e.exports=function(l){if(!s(l)&&l!==null)throw TypeError("Can't set "+String(l)+" as a prototype");return l}},"3ca3":function(e,t,r){var s=r("6547").charAt,l=r("69f3"),u=r("7dd0"),c="String Iterator",f=l.set,h=l.getterFor(c);u(String,"String",function(v){f(this,{type:c,string:String(v),index:0})},function(){var p=h(this),y=p.string,g=p.index,E;return g>=y.length?{value:void 0,done:!0}:(E=s(y,g),p.index+=E.length,{value:E,done:!1})})},"3f8c":function(e,t){e.exports={}},4160:function(e,t,r){var s=r("23e7"),l=r("17c2");s({target:"Array",proto:!0,forced:[].forEach!=l},{forEach:l})},"428f":function(e,t,r){var s=r("da84");e.exports=s},"44ad":function(e,t,r){var s=r("d039"),l=r("c6b6"),u="".split;e.exports=s(function(){return!Object("z").propertyIsEnumerable(0)})?function(c){return l(c)=="String"?u.call(c,""):Object(c)}:Object},"44d2":function(e,t,r){var s=r("b622"),l=r("7c73"),u=r("9bf2"),c=s("unscopables"),f=Array.prototype;f[c]==null&&u.f(f,c,{configurable:!0,value:l(null)}),e.exports=function(h){f[c][h]=!0}},"44e7":function(e,t,r){var s=r("861d"),l=r("c6b6"),u=r("b622"),c=u("match");e.exports=function(f){var h;return s(f)&&((h=f[c])!==void 0?!!h:l(f)=="RegExp")}},4930:function(e,t,r){var s=r("d039");e.exports=!!Object.getOwnPropertySymbols&&!s(function(){return!String(Symbol())})},"4d64":function(e,t,r){var s=r("fc6a"),l=r("50c4"),u=r("23cb"),c=function(f){return function(h,v,p){var y=s(h),g=l(y.length),E=u(p,g),b;if(f&&v!=v){for(;g>E;)if(b=y[E++],b!=b)return!0}else for(;g>E;E++)if((f||E in y)&&y[E]===v)return f||E||0;return!f&&-1}};e.exports={includes:c(!0),indexOf:c(!1)}},"4de4":function(e,t,r){var s=r("23e7"),l=r("b727").filter,u=r("1dde"),c=r("ae40"),f=u("filter"),h=c("filter");s({target:"Array",proto:!0,forced:!f||!h},{filter:function(p){return l(this,p,arguments.length>1?arguments[1]:void 0)}})},"4df4":function(e,t,r){var s=r("0366"),l=r("7b0b"),u=r("9bdd"),c=r("e95a"),f=r("50c4"),h=r("8418"),v=r("35a1");e.exports=function(y){var g=l(y),E=typeof this=="function"?this:Array,b=arguments.length,x=b>1?arguments[1]:void 0,S=x!==void 0,C=v(g),T=0,O,P,D,I,G,w;if(S&&(x=s(x,b>2?arguments[2]:void 0,2)),C!=null&&!(E==Array&&c(C)))for(I=C.call(g),G=I.next,P=new E;!(D=G.call(I)).done;T++)w=S?u(I,x,[D.value,T],!0):D.value,h(P,T,w);else for(O=f(g.length),P=new E(O);O>T;T++)w=S?x(g[T],T):g[T],h(P,T,w);return P.length=T,P}},"4fad":function(e,t,r){var s=r("23e7"),l=r("6f53").entries;s({target:"Object",stat:!0},{entries:function(c){return l(c)}})},"50c4":function(e,t,r){var s=r("a691"),l=Math.min;e.exports=function(u){return u>0?l(s(u),9007199254740991):0}},5135:function(e,t){var r={}.hasOwnProperty;e.exports=function(s,l){return r.call(s,l)}},5319:function(e,t,r){var s=r("d784"),l=r("825a"),u=r("7b0b"),c=r("50c4"),f=r("a691"),h=r("1d80"),v=r("8aa5"),p=r("14c3"),y=Math.max,g=Math.min,E=Math.floor,b=/\$([$&'`]|\d\d?|<[^>]*>)/g,x=/\$([$&'`]|\d\d?)/g,S=function(C){return C===void 0?C:String(C)};s("replace",2,function(C,T,O,P){var D=P.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,I=P.REPLACE_KEEPS_$0,G=D?"$":"$0";return[function(L,k){var N=h(this),H=L==null?void 0:L[C];return H!==void 0?H.call(L,N,k):T.call(String(N),L,k)},function(R,L){if(!D&&I||typeof L=="string"&&L.indexOf(G)===-1){var k=O(T,R,this,L);if(k.done)return k.value}var N=l(R),H=String(this),oe=typeof L=="function";oe||(L=String(L));var fe=N.global;if(fe){var Re=N.unicode;N.lastIndex=0}for(var Se=[];;){var B=p(N,H);if(B===null||(Se.push(B),!fe))break;var $=String(B[0]);$===""&&(N.lastIndex=v(H,c(N.lastIndex),Re))}for(var te="",he=0,se=0;se<Se.length;se++){B=Se[se];for(var ne=String(B[0]),pe=y(g(f(B.index),H.length),0),Ce=[],vt=1;vt<B.length;vt++)Ce.push(S(B[vt]));var Lt=B.groups;if(oe){var Vt=[ne].concat(Ce,pe,H);Lt!==void 0&&Vt.push(Lt);var Xe=String(L.apply(void 0,Vt))}else Xe=w(ne,H,pe,Ce,Lt,L);pe>=he&&(te+=H.slice(he,pe)+Xe,he=pe+ne.length)}return te+H.slice(he)}];function w(R,L,k,N,H,oe){var fe=k+R.length,Re=N.length,Se=x;return H!==void 0&&(H=u(H),Se=b),T.call(oe,Se,function(B,$){var te;switch($.charAt(0)){case"$":return"$";case"&":return R;case"`":return L.slice(0,k);case"'":return L.slice(fe);case"<":te=H[$.slice(1,-1)];break;default:var he=+$;if(he===0)return B;if(he>Re){var se=E(he/10);return se===0?B:se<=Re?N[se-1]===void 0?$.charAt(1):N[se-1]+$.charAt(1):B}te=N[he-1]}return te===void 0?"":te})}})},5692:function(e,t,r){var s=r("c430"),l=r("c6cd");(e.exports=function(u,c){return l[u]||(l[u]=c!==void 0?c:{})})("versions",[]).push({version:"3.6.5",mode:s?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},"56ef":function(e,t,r){var s=r("d066"),l=r("241c"),u=r("7418"),c=r("825a");e.exports=s("Reflect","ownKeys")||function(h){var v=l.f(c(h)),p=u.f;return p?v.concat(p(h)):v}},"5a34":function(e,t,r){var s=r("44e7");e.exports=function(l){if(s(l))throw TypeError("The method doesn't accept regular expressions");return l}},"5c6c":function(e,t){e.exports=function(r,s){return{enumerable:!(r&1),configurable:!(r&2),writable:!(r&4),value:s}}},"5db7":function(e,t,r){var s=r("23e7"),l=r("a2bf"),u=r("7b0b"),c=r("50c4"),f=r("1c0b"),h=r("65f0");s({target:"Array",proto:!0},{flatMap:function(p){var y=u(this),g=c(y.length),E;return f(p),E=h(y,0),E.length=l(E,y,y,g,0,1,p,arguments.length>1?arguments[1]:void 0),E}})},6547:function(e,t,r){var s=r("a691"),l=r("1d80"),u=function(c){return function(f,h){var v=String(l(f)),p=s(h),y=v.length,g,E;return p<0||p>=y?c?"":void 0:(g=v.charCodeAt(p),g<55296||g>56319||p+1===y||(E=v.charCodeAt(p+1))<56320||E>57343?c?v.charAt(p):g:c?v.slice(p,p+2):(g-55296<<10)+(E-56320)+65536)}};e.exports={codeAt:u(!1),charAt:u(!0)}},"65f0":function(e,t,r){var s=r("861d"),l=r("e8b5"),u=r("b622"),c=u("species");e.exports=function(f,h){var v;return l(f)&&(v=f.constructor,typeof v=="function"&&(v===Array||l(v.prototype))?v=void 0:s(v)&&(v=v[c],v===null&&(v=void 0))),new(v===void 0?Array:v)(h===0?0:h)}},"69f3":function(e,t,r){var s=r("7f9a"),l=r("da84"),u=r("861d"),c=r("9112"),f=r("5135"),h=r("f772"),v=r("d012"),p=l.WeakMap,y,g,E,b=function(D){return E(D)?g(D):y(D,{})},x=function(D){return function(I){var G;if(!u(I)||(G=g(I)).type!==D)throw TypeError("Incompatible receiver, "+D+" required");return G}};if(s){var S=new p,C=S.get,T=S.has,O=S.set;y=function(D,I){return O.call(S,D,I),I},g=function(D){return C.call(S,D)||{}},E=function(D){return T.call(S,D)}}else{var P=h("state");v[P]=!0,y=function(D,I){return c(D,P,I),I},g=function(D){return f(D,P)?D[P]:{}},E=function(D){return f(D,P)}}e.exports={set:y,get:g,has:E,enforce:b,getterFor:x}},"6eeb":function(e,t,r){var s=r("da84"),l=r("9112"),u=r("5135"),c=r("ce4e"),f=r("8925"),h=r("69f3"),v=h.get,p=h.enforce,y=String(String).split("String");(e.exports=function(g,E,b,x){var S=x?!!x.unsafe:!1,C=x?!!x.enumerable:!1,T=x?!!x.noTargetGet:!1;if(typeof b=="function"&&(typeof E=="string"&&!u(b,"name")&&l(b,"name",E),p(b).source=y.join(typeof E=="string"?E:"")),g===s){C?g[E]=b:c(E,b);return}else S?!T&&g[E]&&(C=!0):delete g[E];C?g[E]=b:l(g,E,b)})(Function.prototype,"toString",function(){return typeof this=="function"&&v(this).source||f(this)})},"6f53":function(e,t,r){var s=r("83ab"),l=r("df75"),u=r("fc6a"),c=r("d1e7").f,f=function(h){return function(v){for(var p=u(v),y=l(p),g=y.length,E=0,b=[],x;g>E;)x=y[E++],(!s||c.call(p,x))&&b.push(h?[x,p[x]]:p[x]);return b}};e.exports={entries:f(!0),values:f(!1)}},"73d9":function(e,t,r){var s=r("44d2");s("flatMap")},7418:function(e,t){t.f=Object.getOwnPropertySymbols},"746f":function(e,t,r){var s=r("428f"),l=r("5135"),u=r("e538"),c=r("9bf2").f;e.exports=function(f){var h=s.Symbol||(s.Symbol={});l(h,f)||c(h,f,{value:u.f(f)})}},7839:function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},"7b0b":function(e,t,r){var s=r("1d80");e.exports=function(l){return Object(s(l))}},"7c73":function(e,t,r){var s=r("825a"),l=r("37e8"),u=r("7839"),c=r("d012"),f=r("1be4"),h=r("cc12"),v=r("f772"),p=">",y="<",g="prototype",E="script",b=v("IE_PROTO"),x=function(){},S=function(D){return y+E+p+D+y+"/"+E+p},C=function(D){D.write(S("")),D.close();var I=D.parentWindow.Object;return D=null,I},T=function(){var D=h("iframe"),I="java"+E+":",G;return D.style.display="none",f.appendChild(D),D.src=String(I),G=D.contentWindow.document,G.open(),G.write(S("document.F=Object")),G.close(),G.F},O,P=function(){try{O=document.domain&&new ActiveXObject("htmlfile")}catch{}P=O?C(O):T();for(var D=u.length;D--;)delete P[g][u[D]];return P()};c[b]=!0,e.exports=Object.create||function(I,G){var w;return I!==null?(x[g]=s(I),w=new x,x[g]=null,w[b]=I):w=P(),G===void 0?w:l(w,G)}},"7dd0":function(e,t,r){var s=r("23e7"),l=r("9ed3"),u=r("e163"),c=r("d2bb"),f=r("d44e"),h=r("9112"),v=r("6eeb"),p=r("b622"),y=r("c430"),g=r("3f8c"),E=r("ae93"),b=E.IteratorPrototype,x=E.BUGGY_SAFARI_ITERATORS,S=p("iterator"),C="keys",T="values",O="entries",P=function(){return this};e.exports=function(D,I,G,w,R,L,k){l(G,I,w);var N=function(se){if(se===R&&Se)return Se;if(!x&&se in fe)return fe[se];switch(se){case C:return function(){return new G(this,se)};case T:return function(){return new G(this,se)};case O:return function(){return new G(this,se)}}return function(){return new G(this)}},H=I+" Iterator",oe=!1,fe=D.prototype,Re=fe[S]||fe["@@iterator"]||R&&fe[R],Se=!x&&Re||N(R),B=I=="Array"&&fe.entries||Re,$,te,he;if(B&&($=u(B.call(new D)),b!==Object.prototype&&$.next&&(!y&&u($)!==b&&(c?c($,b):typeof $[S]!="function"&&h($,S,P)),f($,H,!0,!0),y&&(g[H]=P))),R==T&&Re&&Re.name!==T&&(oe=!0,Se=function(){return Re.call(this)}),(!y||k)&&fe[S]!==Se&&h(fe,S,Se),g[I]=Se,R)if(te={values:N(T),keys:L?Se:N(C),entries:N(O)},k)for(he in te)(x||oe||!(he in fe))&&v(fe,he,te[he]);else s({target:I,proto:!0,forced:x||oe},te);return te}},"7f9a":function(e,t,r){var s=r("da84"),l=r("8925"),u=s.WeakMap;e.exports=typeof u=="function"&&/native code/.test(l(u))},"825a":function(e,t,r){var s=r("861d");e.exports=function(l){if(!s(l))throw TypeError(String(l)+" is not an object");return l}},"83ab":function(e,t,r){var s=r("d039");e.exports=!s(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},8418:function(e,t,r){var s=r("c04e"),l=r("9bf2"),u=r("5c6c");e.exports=function(c,f,h){var v=s(f);v in c?l.f(c,v,u(0,h)):c[v]=h}},"861d":function(e,t){e.exports=function(r){return typeof r=="object"?r!==null:typeof r=="function"}},8875:function(e,t,r){var s,l,u;(function(c,f){l=[],s=f,u=typeof s=="function"?s.apply(t,l):s,u!==void 0&&(e.exports=u)})(typeof self<"u"?self:this,function(){function c(){var f=Object.getOwnPropertyDescriptor(document,"currentScript");if(!f&&"currentScript"in document&&document.currentScript||f&&f.get!==c&&document.currentScript)return document.currentScript;try{throw new Error}catch(O){var h=/.*at [^(]*\((.*):(.+):(.+)\)$/ig,v=/@([^@]*):(\d+):(\d+)\s*$/ig,p=h.exec(O.stack)||v.exec(O.stack),y=p&&p[1]||!1,g=p&&p[2]||!1,E=document.location.href.replace(document.location.hash,""),b,x,S,C=document.getElementsByTagName("script");y===E&&(b=document.documentElement.outerHTML,x=new RegExp("(?:[^\\n]+?\\n){0,"+(g-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),S=b.replace(x,"$1").trim());for(var T=0;T<C.length;T++)if(C[T].readyState==="interactive"||C[T].src===y||y===E&&C[T].innerHTML&&C[T].innerHTML.trim()===S)return C[T];return null}}return c})},8925:function(e,t,r){var s=r("c6cd"),l=Function.toString;typeof s.inspectSource!="function"&&(s.inspectSource=function(u){return l.call(u)}),e.exports=s.inspectSource},"8aa5":function(e,t,r){var s=r("6547").charAt;e.exports=function(l,u,c){return u+(c?s(l,u).length:1)}},"8bbf":function(e,t){e.exports=n},"90e3":function(e,t){var r=0,s=Math.random();e.exports=function(l){return"Symbol("+String(l===void 0?"":l)+")_"+(++r+s).toString(36)}},9112:function(e,t,r){var s=r("83ab"),l=r("9bf2"),u=r("5c6c");e.exports=s?function(c,f,h){return l.f(c,f,u(1,h))}:function(c,f,h){return c[f]=h,c}},9263:function(e,t,r){var s=r("ad6d"),l=r("9f7f"),u=RegExp.prototype.exec,c=String.prototype.replace,f=u,h=function(){var g=/a/,E=/b*/g;return u.call(g,"a"),u.call(E,"a"),g.lastIndex!==0||E.lastIndex!==0}(),v=l.UNSUPPORTED_Y||l.BROKEN_CARET,p=/()??/.exec("")[1]!==void 0,y=h||p||v;y&&(f=function(E){var b=this,x,S,C,T,O=v&&b.sticky,P=s.call(b),D=b.source,I=0,G=E;return O&&(P=P.replace("y",""),P.indexOf("g")===-1&&(P+="g"),G=String(E).slice(b.lastIndex),b.lastIndex>0&&(!b.multiline||b.multiline&&E[b.lastIndex-1]!==`
`)&&(D="(?: "+D+")",G=" "+G,I++),S=new RegExp("^(?:"+D+")",P)),p&&(S=new RegExp("^"+D+"$(?!\\s)",P)),h&&(x=b.lastIndex),C=u.call(O?S:b,G),O?C?(C.input=C.input.slice(I),C[0]=C[0].slice(I),C.index=b.lastIndex,b.lastIndex+=C[0].length):b.lastIndex=0:h&&C&&(b.lastIndex=b.global?C.index+C[0].length:x),p&&C&&C.length>1&&c.call(C[0],S,function(){for(T=1;T<arguments.length-2;T++)arguments[T]===void 0&&(C[T]=void 0)}),C}),e.exports=f},"94ca":function(e,t,r){var s=r("d039"),l=/#|\.prototype\./,u=function(p,y){var g=f[c(p)];return g==v?!0:g==h?!1:typeof y=="function"?s(y):!!y},c=u.normalize=function(p){return String(p).replace(l,".").toLowerCase()},f=u.data={},h=u.NATIVE="N",v=u.POLYFILL="P";e.exports=u},"99af":function(e,t,r){var s=r("23e7"),l=r("d039"),u=r("e8b5"),c=r("861d"),f=r("7b0b"),h=r("50c4"),v=r("8418"),p=r("65f0"),y=r("1dde"),g=r("b622"),E=r("2d00"),b=g("isConcatSpreadable"),x=9007199254740991,S="Maximum allowed index exceeded",C=E>=51||!l(function(){var D=[];return D[b]=!1,D.concat()[0]!==D}),T=y("concat"),O=function(D){if(!c(D))return!1;var I=D[b];return I!==void 0?!!I:u(D)},P=!C||!T;s({target:"Array",proto:!0,forced:P},{concat:function(I){var G=f(this),w=p(G,0),R=0,L,k,N,H,oe;for(L=-1,N=arguments.length;L<N;L++)if(oe=L===-1?G:arguments[L],O(oe)){if(H=h(oe.length),R+H>x)throw TypeError(S);for(k=0;k<H;k++,R++)k in oe&&v(w,R,oe[k])}else{if(R>=x)throw TypeError(S);v(w,R++,oe)}return w.length=R,w}})},"9bdd":function(e,t,r){var s=r("825a");e.exports=function(l,u,c,f){try{return f?u(s(c)[0],c[1]):u(c)}catch(v){var h=l.return;throw h!==void 0&&s(h.call(l)),v}}},"9bf2":function(e,t,r){var s=r("83ab"),l=r("0cfb"),u=r("825a"),c=r("c04e"),f=Object.defineProperty;t.f=s?f:function(v,p,y){if(u(v),p=c(p,!0),u(y),l)try{return f(v,p,y)}catch{}if("get"in y||"set"in y)throw TypeError("Accessors not supported");return"value"in y&&(v[p]=y.value),v}},"9ed3":function(e,t,r){var s=r("ae93").IteratorPrototype,l=r("7c73"),u=r("5c6c"),c=r("d44e"),f=r("3f8c"),h=function(){return this};e.exports=function(v,p,y){var g=p+" Iterator";return v.prototype=l(s,{next:u(1,y)}),c(v,g,!1,!0),f[g]=h,v}},"9f7f":function(e,t,r){var s=r("d039");function l(u,c){return RegExp(u,c)}t.UNSUPPORTED_Y=s(function(){var u=l("a","y");return u.lastIndex=2,u.exec("abcd")!=null}),t.BROKEN_CARET=s(function(){var u=l("^r","gy");return u.lastIndex=2,u.exec("str")!=null})},a2bf:function(e,t,r){var s=r("e8b5"),l=r("50c4"),u=r("0366"),c=function(f,h,v,p,y,g,E,b){for(var x=y,S=0,C=E?u(E,b,3):!1,T;S<p;){if(S in v){if(T=C?C(v[S],S,h):v[S],g>0&&s(T))x=c(f,h,T,l(T.length),x,g-1)-1;else{if(x>=9007199254740991)throw TypeError("Exceed the acceptable array length");f[x]=T}x++}S++}return x};e.exports=c},a352:function(e,t){e.exports=i},a434:function(e,t,r){var s=r("23e7"),l=r("23cb"),u=r("a691"),c=r("50c4"),f=r("7b0b"),h=r("65f0"),v=r("8418"),p=r("1dde"),y=r("ae40"),g=p("splice"),E=y("splice",{ACCESSORS:!0,0:0,1:2}),b=Math.max,x=Math.min,S=9007199254740991,C="Maximum allowed length exceeded";s({target:"Array",proto:!0,forced:!g||!E},{splice:function(O,P){var D=f(this),I=c(D.length),G=l(O,I),w=arguments.length,R,L,k,N,H,oe;if(w===0?R=L=0:w===1?(R=0,L=I-G):(R=w-2,L=x(b(u(P),0),I-G)),I+R-L>S)throw TypeError(C);for(k=h(D,L),N=0;N<L;N++)H=G+N,H in D&&v(k,N,D[H]);if(k.length=L,R<L){for(N=G;N<I-L;N++)H=N+L,oe=N+R,H in D?D[oe]=D[H]:delete D[oe];for(N=I;N>I-L+R;N--)delete D[N-1]}else if(R>L)for(N=I-L;N>G;N--)H=N+L-1,oe=N+R-1,H in D?D[oe]=D[H]:delete D[oe];for(N=0;N<R;N++)D[N+G]=arguments[N+2];return D.length=I-L+R,k}})},a4d3:function(e,t,r){var s=r("23e7"),l=r("da84"),u=r("d066"),c=r("c430"),f=r("83ab"),h=r("4930"),v=r("fdbf"),p=r("d039"),y=r("5135"),g=r("e8b5"),E=r("861d"),b=r("825a"),x=r("7b0b"),S=r("fc6a"),C=r("c04e"),T=r("5c6c"),O=r("7c73"),P=r("df75"),D=r("241c"),I=r("057f"),G=r("7418"),w=r("06cf"),R=r("9bf2"),L=r("d1e7"),k=r("9112"),N=r("6eeb"),H=r("5692"),oe=r("f772"),fe=r("d012"),Re=r("90e3"),Se=r("b622"),B=r("e538"),$=r("746f"),te=r("d44e"),he=r("69f3"),se=r("b727").forEach,ne=oe("hidden"),pe="Symbol",Ce="prototype",vt=Se("toPrimitive"),Lt=he.set,Vt=he.getterFor(pe),Xe=Object[Ce],$e=l.Symbol,sn=u("JSON","stringify"),Tt=w.f,Ot=R.f,qr=I.f,ao=L.f,pt=H("symbols"),Yt=H("op-symbols"),In=H("string-to-symbol-registry"),sr=H("symbol-to-string-registry"),lr=H("wks"),ur=l.QObject,cr=!ur||!ur[Ce]||!ur[Ce].findChild,fr=f&&p(function(){return O(Ot({},"a",{get:function(){return Ot(this,"a",{value:7}).a}})).a!=7})?function(q,Y,z){var de=Tt(Xe,Y);de&&delete Xe[Y],Ot(q,Y,z),de&&q!==Xe&&Ot(Xe,Y,de)}:Ot,hr=function(q,Y){var z=pt[q]=O($e[Ce]);return Lt(z,{type:pe,tag:q,description:Y}),f||(z.description=Y),z},_=v?function(q){return typeof q=="symbol"}:function(q){return Object(q)instanceof $e},A=function(Y,z,de){Y===Xe&&A(Yt,z,de),b(Y);var ge=C(z,!0);return b(de),y(pt,ge)?(de.enumerable?(y(Y,ne)&&Y[ne][ge]&&(Y[ne][ge]=!1),de=O(de,{enumerable:T(0,!1)})):(y(Y,ne)||Ot(Y,ne,T(1,{})),Y[ne][ge]=!0),fr(Y,ge,de)):Ot(Y,ge,de)},M=function(Y,z){b(Y);var de=S(z),ge=P(de).concat(me(de));return se(ge,function(nt){(!f||U.call(de,nt))&&A(Y,nt,de[nt])}),Y},j=function(Y,z){return z===void 0?O(Y):M(O(Y),z)},U=function(Y){var z=C(Y,!0),de=ao.call(this,z);return this===Xe&&y(pt,z)&&!y(Yt,z)?!1:de||!y(this,z)||!y(pt,z)||y(this,ne)&&this[ne][z]?de:!0},Q=function(Y,z){var de=S(Y),ge=C(z,!0);if(!(de===Xe&&y(pt,ge)&&!y(Yt,ge))){var nt=Tt(de,ge);return nt&&y(pt,ge)&&!(y(de,ne)&&de[ne][ge])&&(nt.enumerable=!0),nt}},ie=function(Y){var z=qr(S(Y)),de=[];return se(z,function(ge){!y(pt,ge)&&!y(fe,ge)&&de.push(ge)}),de},me=function(Y){var z=Y===Xe,de=qr(z?Yt:S(Y)),ge=[];return se(de,function(nt){y(pt,nt)&&(!z||y(Xe,nt))&&ge.push(pt[nt])}),ge};if(h||($e=function(){if(this instanceof $e)throw TypeError("Symbol is not a constructor");var Y=!arguments.length||arguments[0]===void 0?void 0:String(arguments[0]),z=Re(Y),de=function(ge){this===Xe&&de.call(Yt,ge),y(this,ne)&&y(this[ne],z)&&(this[ne][z]=!1),fr(this,z,T(1,ge))};return f&&cr&&fr(Xe,z,{configurable:!0,set:de}),hr(z,Y)},N($e[Ce],"toString",function(){return Vt(this).tag}),N($e,"withoutSetter",function(q){return hr(Re(q),q)}),L.f=U,R.f=A,w.f=Q,D.f=I.f=ie,G.f=me,B.f=function(q){return hr(Se(q),q)},f&&(Ot($e[Ce],"description",{configurable:!0,get:function(){return Vt(this).description}}),c||N(Xe,"propertyIsEnumerable",U,{unsafe:!0}))),s({global:!0,wrap:!0,forced:!h,sham:!h},{Symbol:$e}),se(P(lr),function(q){$(q)}),s({target:pe,stat:!0,forced:!h},{for:function(q){var Y=String(q);if(y(In,Y))return In[Y];var z=$e(Y);return In[Y]=z,sr[z]=Y,z},keyFor:function(Y){if(!_(Y))throw TypeError(Y+" is not a symbol");if(y(sr,Y))return sr[Y]},useSetter:function(){cr=!0},useSimple:function(){cr=!1}}),s({target:"Object",stat:!0,forced:!h,sham:!f},{create:j,defineProperty:A,defineProperties:M,getOwnPropertyDescriptor:Q}),s({target:"Object",stat:!0,forced:!h},{getOwnPropertyNames:ie,getOwnPropertySymbols:me}),s({target:"Object",stat:!0,forced:p(function(){G.f(1)})},{getOwnPropertySymbols:function(Y){return G.f(x(Y))}}),sn){var Ge=!h||p(function(){var q=$e();return sn([q])!="[null]"||sn({a:q})!="{}"||sn(Object(q))!="{}"});s({target:"JSON",stat:!0,forced:Ge},{stringify:function(Y,z,de){for(var ge=[Y],nt=1,so;arguments.length>nt;)ge.push(arguments[nt++]);if(so=z,!(!E(z)&&Y===void 0||_(Y)))return g(z)||(z=function(yu,ei){if(typeof so=="function"&&(ei=so.call(this,yu,ei)),!_(ei))return ei}),ge[1]=z,sn.apply(null,ge)}})}$e[Ce][vt]||k($e[Ce],vt,$e[Ce].valueOf),te($e,pe),fe[ne]=!0},a630:function(e,t,r){var s=r("23e7"),l=r("4df4"),u=r("1c7e"),c=!u(function(f){Array.from(f)});s({target:"Array",stat:!0,forced:c},{from:l})},a640:function(e,t,r){var s=r("d039");e.exports=function(l,u){var c=[][l];return!!c&&s(function(){c.call(null,u||function(){throw 1},1)})}},a691:function(e,t){var r=Math.ceil,s=Math.floor;e.exports=function(l){return isNaN(l=+l)?0:(l>0?s:r)(l)}},ab13:function(e,t,r){var s=r("b622"),l=s("match");e.exports=function(u){var c=/./;try{"/./"[u](c)}catch{try{return c[l]=!1,"/./"[u](c)}catch{}}return!1}},ac1f:function(e,t,r){var s=r("23e7"),l=r("9263");s({target:"RegExp",proto:!0,forced:/./.exec!==l},{exec:l})},ad6d:function(e,t,r){var s=r("825a");e.exports=function(){var l=s(this),u="";return l.global&&(u+="g"),l.ignoreCase&&(u+="i"),l.multiline&&(u+="m"),l.dotAll&&(u+="s"),l.unicode&&(u+="u"),l.sticky&&(u+="y"),u}},ae40:function(e,t,r){var s=r("83ab"),l=r("d039"),u=r("5135"),c=Object.defineProperty,f={},h=function(v){throw v};e.exports=function(v,p){if(u(f,v))return f[v];p||(p={});var y=[][v],g=u(p,"ACCESSORS")?p.ACCESSORS:!1,E=u(p,0)?p[0]:h,b=u(p,1)?p[1]:void 0;return f[v]=!!y&&!l(function(){if(g&&!s)return!0;var x={length:-1};g?c(x,1,{enumerable:!0,get:h}):x[1]=1,y.call(x,E,b)})}},ae93:function(e,t,r){var s=r("e163"),l=r("9112"),u=r("5135"),c=r("b622"),f=r("c430"),h=c("iterator"),v=!1,p=function(){return this},y,g,E;[].keys&&(E=[].keys(),"next"in E?(g=s(s(E)),g!==Object.prototype&&(y=g)):v=!0),y==null&&(y={}),!f&&!u(y,h)&&l(y,h,p),e.exports={IteratorPrototype:y,BUGGY_SAFARI_ITERATORS:v}},b041:function(e,t,r){var s=r("00ee"),l=r("f5df");e.exports=s?{}.toString:function(){return"[object "+l(this)+"]"}},b0c0:function(e,t,r){var s=r("83ab"),l=r("9bf2").f,u=Function.prototype,c=u.toString,f=/^\s*function ([^ (]*)/,h="name";s&&!(h in u)&&l(u,h,{configurable:!0,get:function(){try{return c.call(this).match(f)[1]}catch{return""}}})},b622:function(e,t,r){var s=r("da84"),l=r("5692"),u=r("5135"),c=r("90e3"),f=r("4930"),h=r("fdbf"),v=l("wks"),p=s.Symbol,y=h?p:p&&p.withoutSetter||c;e.exports=function(g){return u(v,g)||(f&&u(p,g)?v[g]=p[g]:v[g]=y("Symbol."+g)),v[g]}},b64b:function(e,t,r){var s=r("23e7"),l=r("7b0b"),u=r("df75"),c=r("d039"),f=c(function(){u(1)});s({target:"Object",stat:!0,forced:f},{keys:function(v){return u(l(v))}})},b727:function(e,t,r){var s=r("0366"),l=r("44ad"),u=r("7b0b"),c=r("50c4"),f=r("65f0"),h=[].push,v=function(p){var y=p==1,g=p==2,E=p==3,b=p==4,x=p==6,S=p==5||x;return function(C,T,O,P){for(var D=u(C),I=l(D),G=s(T,O,3),w=c(I.length),R=0,L=P||f,k=y?L(C,w):g?L(C,0):void 0,N,H;w>R;R++)if((S||R in I)&&(N=I[R],H=G(N,R,D),p)){if(y)k[R]=H;else if(H)switch(p){case 3:return!0;case 5:return N;case 6:return R;case 2:h.call(k,N)}else if(b)return!1}return x?-1:E||b?b:k}};e.exports={forEach:v(0),map:v(1),filter:v(2),some:v(3),every:v(4),find:v(5),findIndex:v(6)}},c04e:function(e,t,r){var s=r("861d");e.exports=function(l,u){if(!s(l))return l;var c,f;if(u&&typeof(c=l.toString)=="function"&&!s(f=c.call(l))||typeof(c=l.valueOf)=="function"&&!s(f=c.call(l))||!u&&typeof(c=l.toString)=="function"&&!s(f=c.call(l)))return f;throw TypeError("Can't convert object to primitive value")}},c430:function(e,t){e.exports=!1},c6b6:function(e,t){var r={}.toString;e.exports=function(s){return r.call(s).slice(8,-1)}},c6cd:function(e,t,r){var s=r("da84"),l=r("ce4e"),u="__core-js_shared__",c=s[u]||l(u,{});e.exports=c},c740:function(e,t,r){var s=r("23e7"),l=r("b727").findIndex,u=r("44d2"),c=r("ae40"),f="findIndex",h=!0,v=c(f);f in[]&&Array(1)[f](function(){h=!1}),s({target:"Array",proto:!0,forced:h||!v},{findIndex:function(y){return l(this,y,arguments.length>1?arguments[1]:void 0)}}),u(f)},c8ba:function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch{typeof window=="object"&&(r=window)}e.exports=r},c975:function(e,t,r){var s=r("23e7"),l=r("4d64").indexOf,u=r("a640"),c=r("ae40"),f=[].indexOf,h=!!f&&1/[1].indexOf(1,-0)<0,v=u("indexOf"),p=c("indexOf",{ACCESSORS:!0,1:0});s({target:"Array",proto:!0,forced:h||!v||!p},{indexOf:function(g){return h?f.apply(this,arguments)||0:l(this,g,arguments.length>1?arguments[1]:void 0)}})},ca84:function(e,t,r){var s=r("5135"),l=r("fc6a"),u=r("4d64").indexOf,c=r("d012");e.exports=function(f,h){var v=l(f),p=0,y=[],g;for(g in v)!s(c,g)&&s(v,g)&&y.push(g);for(;h.length>p;)s(v,g=h[p++])&&(~u(y,g)||y.push(g));return y}},caad:function(e,t,r){var s=r("23e7"),l=r("4d64").includes,u=r("44d2"),c=r("ae40"),f=c("indexOf",{ACCESSORS:!0,1:0});s({target:"Array",proto:!0,forced:!f},{includes:function(v){return l(this,v,arguments.length>1?arguments[1]:void 0)}}),u("includes")},cc12:function(e,t,r){var s=r("da84"),l=r("861d"),u=s.document,c=l(u)&&l(u.createElement);e.exports=function(f){return c?u.createElement(f):{}}},ce4e:function(e,t,r){var s=r("da84"),l=r("9112");e.exports=function(u,c){try{l(s,u,c)}catch{s[u]=c}return c}},d012:function(e,t){e.exports={}},d039:function(e,t){e.exports=function(r){try{return!!r()}catch{return!0}}},d066:function(e,t,r){var s=r("428f"),l=r("da84"),u=function(c){return typeof c=="function"?c:void 0};e.exports=function(c,f){return arguments.length<2?u(s[c])||u(l[c]):s[c]&&s[c][f]||l[c]&&l[c][f]}},d1e7:function(e,t,r){var s={}.propertyIsEnumerable,l=Object.getOwnPropertyDescriptor,u=l&&!s.call({1:2},1);t.f=u?function(f){var h=l(this,f);return!!h&&h.enumerable}:s},d28b:function(e,t,r){var s=r("746f");s("iterator")},d2bb:function(e,t,r){var s=r("825a"),l=r("3bbe");e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var u=!1,c={},f;try{f=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set,f.call(c,[]),u=c instanceof Array}catch{}return function(v,p){return s(v),l(p),u?f.call(v,p):v.__proto__=p,v}}():void 0)},d3b7:function(e,t,r){var s=r("00ee"),l=r("6eeb"),u=r("b041");s||l(Object.prototype,"toString",u,{unsafe:!0})},d44e:function(e,t,r){var s=r("9bf2").f,l=r("5135"),u=r("b622"),c=u("toStringTag");e.exports=function(f,h,v){f&&!l(f=v?f:f.prototype,c)&&s(f,c,{configurable:!0,value:h})}},d58f:function(e,t,r){var s=r("1c0b"),l=r("7b0b"),u=r("44ad"),c=r("50c4"),f=function(h){return function(v,p,y,g){s(p);var E=l(v),b=u(E),x=c(E.length),S=h?x-1:0,C=h?-1:1;if(y<2)for(;;){if(S in b){g=b[S],S+=C;break}if(S+=C,h?S<0:x<=S)throw TypeError("Reduce of empty array with no initial value")}for(;h?S>=0:x>S;S+=C)S in b&&(g=p(g,b[S],S,E));return g}};e.exports={left:f(!1),right:f(!0)}},d784:function(e,t,r){r("ac1f");var s=r("6eeb"),l=r("d039"),u=r("b622"),c=r("9263"),f=r("9112"),h=u("species"),v=!l(function(){var b=/./;return b.exec=function(){var x=[];return x.groups={a:"7"},x},"".replace(b,"$<a>")!=="7"}),p=function(){return"a".replace(/./,"$0")==="$0"}(),y=u("replace"),g=function(){return/./[y]?/./[y]("a","$0")==="":!1}(),E=!l(function(){var b=/(?:)/,x=b.exec;b.exec=function(){return x.apply(this,arguments)};var S="ab".split(b);return S.length!==2||S[0]!=="a"||S[1]!=="b"});e.exports=function(b,x,S,C){var T=u(b),O=!l(function(){var R={};return R[T]=function(){return 7},""[b](R)!=7}),P=O&&!l(function(){var R=!1,L=/a/;return b==="split"&&(L={},L.constructor={},L.constructor[h]=function(){return L},L.flags="",L[T]=/./[T]),L.exec=function(){return R=!0,null},L[T](""),!R});if(!O||!P||b==="replace"&&!(v&&p&&!g)||b==="split"&&!E){var D=/./[T],I=S(T,""[b],function(R,L,k,N,H){return L.exec===c?O&&!H?{done:!0,value:D.call(L,k,N)}:{done:!0,value:R.call(k,L,N)}:{done:!1}},{REPLACE_KEEPS_$0:p,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:g}),G=I[0],w=I[1];s(String.prototype,b,G),s(RegExp.prototype,T,x==2?function(R,L){return w.call(R,this,L)}:function(R){return w.call(R,this)})}C&&f(RegExp.prototype[T],"sham",!0)}},d81d:function(e,t,r){var s=r("23e7"),l=r("b727").map,u=r("1dde"),c=r("ae40"),f=u("map"),h=c("map");s({target:"Array",proto:!0,forced:!f||!h},{map:function(p){return l(this,p,arguments.length>1?arguments[1]:void 0)}})},da84:function(e,t,r){(function(s){var l=function(u){return u&&u.Math==Math&&u};e.exports=l(typeof globalThis=="object"&&globalThis)||l(typeof window=="object"&&window)||l(typeof self=="object"&&self)||l(typeof s=="object"&&s)||Function("return this")()}).call(this,r("c8ba"))},dbb4:function(e,t,r){var s=r("23e7"),l=r("83ab"),u=r("56ef"),c=r("fc6a"),f=r("06cf"),h=r("8418");s({target:"Object",stat:!0,sham:!l},{getOwnPropertyDescriptors:function(p){for(var y=c(p),g=f.f,E=u(y),b={},x=0,S,C;E.length>x;)C=g(y,S=E[x++]),C!==void 0&&h(b,S,C);return b}})},dbf1:function(e,t,r){(function(s){r.d(t,"a",function(){return u});function l(){return typeof window<"u"?window.console:s.console}var u=l()}).call(this,r("c8ba"))},ddb0:function(e,t,r){var s=r("da84"),l=r("fdbc"),u=r("e260"),c=r("9112"),f=r("b622"),h=f("iterator"),v=f("toStringTag"),p=u.values;for(var y in l){var g=s[y],E=g&&g.prototype;if(E){if(E[h]!==p)try{c(E,h,p)}catch{E[h]=p}if(E[v]||c(E,v,y),l[y]){for(var b in u)if(E[b]!==u[b])try{c(E,b,u[b])}catch{E[b]=u[b]}}}}},df75:function(e,t,r){var s=r("ca84"),l=r("7839");e.exports=Object.keys||function(c){return s(c,l)}},e01a:function(e,t,r){var s=r("23e7"),l=r("83ab"),u=r("da84"),c=r("5135"),f=r("861d"),h=r("9bf2").f,v=r("e893"),p=u.Symbol;if(l&&typeof p=="function"&&(!("description"in p.prototype)||p().description!==void 0)){var y={},g=function(){var T=arguments.length<1||arguments[0]===void 0?void 0:String(arguments[0]),O=this instanceof g?new p(T):T===void 0?p():p(T);return T===""&&(y[O]=!0),O};v(g,p);var E=g.prototype=p.prototype;E.constructor=g;var b=E.toString,x=String(p("test"))=="Symbol(test)",S=/^Symbol\((.*)\)[^)]+$/;h(E,"description",{configurable:!0,get:function(){var T=f(this)?this.valueOf():this,O=b.call(T);if(c(y,T))return"";var P=x?O.slice(7,-1):O.replace(S,"$1");return P===""?void 0:P}}),s({global:!0,forced:!0},{Symbol:g})}},e163:function(e,t,r){var s=r("5135"),l=r("7b0b"),u=r("f772"),c=r("e177"),f=u("IE_PROTO"),h=Object.prototype;e.exports=c?Object.getPrototypeOf:function(v){return v=l(v),s(v,f)?v[f]:typeof v.constructor=="function"&&v instanceof v.constructor?v.constructor.prototype:v instanceof Object?h:null}},e177:function(e,t,r){var s=r("d039");e.exports=!s(function(){function l(){}return l.prototype.constructor=null,Object.getPrototypeOf(new l)!==l.prototype})},e260:function(e,t,r){var s=r("fc6a"),l=r("44d2"),u=r("3f8c"),c=r("69f3"),f=r("7dd0"),h="Array Iterator",v=c.set,p=c.getterFor(h);e.exports=f(Array,"Array",function(y,g){v(this,{type:h,target:s(y),index:0,kind:g})},function(){var y=p(this),g=y.target,E=y.kind,b=y.index++;return!g||b>=g.length?(y.target=void 0,{value:void 0,done:!0}):E=="keys"?{value:b,done:!1}:E=="values"?{value:g[b],done:!1}:{value:[b,g[b]],done:!1}},"values"),u.Arguments=u.Array,l("keys"),l("values"),l("entries")},e439:function(e,t,r){var s=r("23e7"),l=r("d039"),u=r("fc6a"),c=r("06cf").f,f=r("83ab"),h=l(function(){c(1)}),v=!f||h;s({target:"Object",stat:!0,forced:v,sham:!f},{getOwnPropertyDescriptor:function(y,g){return c(u(y),g)}})},e538:function(e,t,r){var s=r("b622");t.f=s},e893:function(e,t,r){var s=r("5135"),l=r("56ef"),u=r("06cf"),c=r("9bf2");e.exports=function(f,h){for(var v=l(h),p=c.f,y=u.f,g=0;g<v.length;g++){var E=v[g];s(f,E)||p(f,E,y(h,E))}}},e8b5:function(e,t,r){var s=r("c6b6");e.exports=Array.isArray||function(u){return s(u)=="Array"}},e95a:function(e,t,r){var s=r("b622"),l=r("3f8c"),u=s("iterator"),c=Array.prototype;e.exports=function(f){return f!==void 0&&(l.Array===f||c[u]===f)}},f5df:function(e,t,r){var s=r("00ee"),l=r("c6b6"),u=r("b622"),c=u("toStringTag"),f=l(function(){return arguments}())=="Arguments",h=function(v,p){try{return v[p]}catch{}};e.exports=s?l:function(v){var p,y,g;return v===void 0?"Undefined":v===null?"Null":typeof(y=h(p=Object(v),c))=="string"?y:f?l(p):(g=l(p))=="Object"&&typeof p.callee=="function"?"Arguments":g}},f772:function(e,t,r){var s=r("5692"),l=r("90e3"),u=s("keys");e.exports=function(c){return u[c]||(u[c]=l(c))}},fb15:function(e,t,r){if(r.r(t),typeof window<"u"){var s=window.document.currentScript;{var l=r("8875");s=l(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:l})}var u=s&&s.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);u&&(r.p=u[1])}r("99af"),r("4de4"),r("4160"),r("c975"),r("d81d"),r("a434"),r("159b"),r("a4d3"),r("e439"),r("dbb4"),r("b64b");function c(_,A,M){return A in _?Object.defineProperty(_,A,{value:M,enumerable:!0,configurable:!0,writable:!0}):_[A]=M,_}function f(_,A){var M=Object.keys(_);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(_);A&&(j=j.filter(function(U){return Object.getOwnPropertyDescriptor(_,U).enumerable})),M.push.apply(M,j)}return M}function h(_){for(var A=1;A<arguments.length;A++){var M=arguments[A]!=null?arguments[A]:{};A%2?f(Object(M),!0).forEach(function(j){c(_,j,M[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_,Object.getOwnPropertyDescriptors(M)):f(Object(M)).forEach(function(j){Object.defineProperty(_,j,Object.getOwnPropertyDescriptor(M,j))})}return _}function v(_){if(Array.isArray(_))return _}r("e01a"),r("d28b"),r("e260"),r("d3b7"),r("3ca3"),r("ddb0");function p(_,A){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(_)))){var M=[],j=!0,U=!1,Q=void 0;try{for(var ie=_[Symbol.iterator](),me;!(j=(me=ie.next()).done)&&(M.push(me.value),!(A&&M.length===A));j=!0);}catch(Ge){U=!0,Q=Ge}finally{try{!j&&ie.return!=null&&ie.return()}finally{if(U)throw Q}}return M}}r("a630"),r("fb6a"),r("b0c0"),r("25f0");function y(_,A){(A==null||A>_.length)&&(A=_.length);for(var M=0,j=new Array(A);M<A;M++)j[M]=_[M];return j}function g(_,A){if(_){if(typeof _=="string")return y(_,A);var M=Object.prototype.toString.call(_).slice(8,-1);if(M==="Object"&&_.constructor&&(M=_.constructor.name),M==="Map"||M==="Set")return Array.from(_);if(M==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(M))return y(_,A)}}function E(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function b(_,A){return v(_)||p(_,A)||g(_,A)||E()}function x(_){if(Array.isArray(_))return y(_)}function S(_){if(typeof Symbol<"u"&&Symbol.iterator in Object(_))return Array.from(_)}function C(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function T(_){return x(_)||S(_)||g(_)||C()}var O=r("a352"),P=r.n(O);function D(_){_.parentElement!==null&&_.parentElement.removeChild(_)}function I(_,A,M){var j=M===0?_.children[0]:_.children[M-1].nextSibling;_.insertBefore(A,j)}var G=r("dbf1");r("13d5"),r("4fad"),r("ac1f"),r("5319");function w(_){var A=Object.create(null);return function(j){var U=A[j];return U||(A[j]=_(j))}}var R=/-(\w)/g,L=w(function(_){return _.replace(R,function(A,M){return M.toUpperCase()})});r("5db7"),r("73d9");var k=["Start","Add","Remove","Update","End"],N=["Choose","Unchoose","Sort","Filter","Clone"],H=["Move"],oe=[H,k,N].flatMap(function(_){return _}).map(function(_){return"on".concat(_)}),fe={manage:H,manageAndEmit:k,emit:N};function Re(_){return oe.indexOf(_)!==-1}r("caad"),r("2ca0");var Se=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","math","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","section","select","slot","small","source","span","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"];function B(_){return Se.includes(_)}function $(_){return["transition-group","TransitionGroup"].includes(_)}function te(_){return["id","class","role","style"].includes(_)||_.startsWith("data-")||_.startsWith("aria-")||_.startsWith("on")}function he(_){return _.reduce(function(A,M){var j=b(M,2),U=j[0],Q=j[1];return A[U]=Q,A},{})}function se(_){var A=_.$attrs,M=_.componentData,j=M===void 0?{}:M,U=he(Object.entries(A).filter(function(Q){var ie=b(Q,2),me=ie[0];return ie[1],te(me)}));return h(h({},U),j)}function ne(_){var A=_.$attrs,M=_.callBackBuilder,j=he(pe(A));Object.entries(M).forEach(function(Q){var ie=b(Q,2),me=ie[0],Ge=ie[1];fe[me].forEach(function(q){j["on".concat(q)]=Ge(q)})});var U="[data-draggable]".concat(j.draggable||"");return h(h({},j),{},{draggable:U})}function pe(_){return Object.entries(_).filter(function(A){var M=b(A,2),j=M[0];return M[1],!te(j)}).map(function(A){var M=b(A,2),j=M[0],U=M[1];return[L(j),U]}).filter(function(A){var M=b(A,2),j=M[0];return M[1],!Re(j)})}r("c740");function Ce(_,A){if(!(_ instanceof A))throw new TypeError("Cannot call a class as a function")}function vt(_,A){for(var M=0;M<A.length;M++){var j=A[M];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(_,j.key,j)}}function Lt(_,A,M){return A&&vt(_.prototype,A),_}var Vt=function(A){var M=A.el;return M},Xe=function(A,M){return A.__draggable_context=M},$e=function(A){return A.__draggable_context},sn=function(){function _(A){var M=A.nodes,j=M.header,U=M.default,Q=M.footer,ie=A.root,me=A.realList;Ce(this,_),this.defaultNodes=U,this.children=[].concat(T(j),T(U),T(Q)),this.externalComponent=ie.externalComponent,this.rootTransition=ie.transition,this.tag=ie.tag,this.realList=me}return Lt(_,[{key:"render",value:function(M,j){var U=this.tag,Q=this.children,ie=this._isRootComponent,me=ie?{default:function(){return Q}}:Q;return M(U,j,me)}},{key:"updated",value:function(){var M=this.defaultNodes,j=this.realList;M.forEach(function(U,Q){Xe(Vt(U),{element:j[Q],index:Q})})}},{key:"getUnderlyingVm",value:function(M){return $e(M)}},{key:"getVmIndexFromDomIndex",value:function(M,j){var U=this.defaultNodes,Q=U.length,ie=j.children,me=ie.item(M);if(me===null)return Q;var Ge=$e(me);if(Ge)return Ge.index;if(Q===0)return 0;var q=Vt(U[0]),Y=T(ie).findIndex(function(z){return z===q});return M<Y?0:Q}},{key:"_isRootComponent",get:function(){return this.externalComponent||this.rootTransition}}]),_}(),Tt=r("8bbf");function Ot(_,A){var M=_[A];return M?M():[]}function qr(_){var A=_.$slots,M=_.realList,j=_.getKey,U=M||[],Q=["header","footer"].map(function(z){return Ot(A,z)}),ie=b(Q,2),me=ie[0],Ge=ie[1],q=A.item;if(!q)throw new Error("draggable element must have an item slot");var Y=U.flatMap(function(z,de){return q({element:z,index:de}).map(function(ge){return ge.key=j(z),ge.props=h(h({},ge.props||{}),{},{"data-draggable":!0}),ge})});if(Y.length!==U.length)throw new Error("Item slot must have only one child");return{header:me,footer:Ge,default:Y}}function ao(_){var A=$(_),M=!B(_)&&!A;return{transition:A,externalComponent:M,tag:M?Object(Tt.resolveComponent)(_):A?Tt.TransitionGroup:_}}function pt(_){var A=_.$slots,M=_.tag,j=_.realList,U=_.getKey,Q=qr({$slots:A,realList:j,getKey:U}),ie=ao(M);return new sn({nodes:Q,root:ie,realList:j})}function Yt(_,A){var M=this;Object(Tt.nextTick)(function(){return M.$emit(_.toLowerCase(),A)})}function In(_){var A=this;return function(M,j){if(A.realList!==null)return A["onDrag".concat(_)](M,j)}}function sr(_){var A=this,M=In.call(this,_);return function(j,U){M.call(A,j,U),Yt.call(A,_,j)}}var lr=null,ur={list:{type:Array,required:!1,default:null},modelValue:{type:Array,required:!1,default:null},itemKey:{type:[String,Function],required:!0},clone:{type:Function,default:function(A){return A}},tag:{type:String,default:"div"},move:{type:Function,default:null},componentData:{type:Object,required:!1,default:null}},cr=["update:modelValue","change"].concat(T([].concat(T(fe.manageAndEmit),T(fe.emit)).map(function(_){return _.toLowerCase()}))),fr=Object(Tt.defineComponent)({name:"draggable",inheritAttrs:!1,props:ur,emits:cr,data:function(){return{error:!1}},render:function(){try{this.error=!1;var A=this.$slots,M=this.$attrs,j=this.tag,U=this.componentData,Q=this.realList,ie=this.getKey,me=pt({$slots:A,tag:j,realList:Q,getKey:ie});this.componentStructure=me;var Ge=se({$attrs:M,componentData:U});return me.render(Tt.h,Ge)}catch(q){return this.error=!0,Object(Tt.h)("pre",{style:{color:"red"}},q.stack)}},created:function(){this.list!==null&&this.modelValue!==null&&G.a.error("modelValue and list props are mutually exclusive! Please set one or another.")},mounted:function(){var A=this;if(!this.error){var M=this.$attrs,j=this.$el,U=this.componentStructure;U.updated();var Q=ne({$attrs:M,callBackBuilder:{manageAndEmit:function(Ge){return sr.call(A,Ge)},emit:function(Ge){return Yt.bind(A,Ge)},manage:function(Ge){return In.call(A,Ge)}}}),ie=j.nodeType===1?j:j.parentElement;this._sortable=new P.a(ie,Q),this.targetDomElement=ie,ie.__draggable_component__=this}},updated:function(){this.componentStructure.updated()},beforeUnmount:function(){this._sortable!==void 0&&this._sortable.destroy()},computed:{realList:function(){var A=this.list;return A||this.modelValue},getKey:function(){var A=this.itemKey;return typeof A=="function"?A:function(M){return M[A]}}},watch:{$attrs:{handler:function(A){var M=this._sortable;M&&pe(A).forEach(function(j){var U=b(j,2),Q=U[0],ie=U[1];M.option(Q,ie)})},deep:!0}},methods:{getUnderlyingVm:function(A){return this.componentStructure.getUnderlyingVm(A)||null},getUnderlyingPotencialDraggableComponent:function(A){return A.__draggable_component__},emitChanges:function(A){var M=this;Object(Tt.nextTick)(function(){return M.$emit("change",A)})},alterList:function(A){if(this.list){A(this.list);return}var M=T(this.modelValue);A(M),this.$emit("update:modelValue",M)},spliceList:function(){var A=arguments,M=function(U){return U.splice.apply(U,T(A))};this.alterList(M)},updatePosition:function(A,M){var j=function(Q){return Q.splice(M,0,Q.splice(A,1)[0])};this.alterList(j)},getRelatedContextFromMoveEvent:function(A){var M=A.to,j=A.related,U=this.getUnderlyingPotencialDraggableComponent(M);if(!U)return{component:U};var Q=U.realList,ie={list:Q,component:U};if(M!==j&&Q){var me=U.getUnderlyingVm(j)||{};return h(h({},me),ie)}return ie},getVmIndexFromDomIndex:function(A){return this.componentStructure.getVmIndexFromDomIndex(A,this.targetDomElement)},onDragStart:function(A){this.context=this.getUnderlyingVm(A.item),A.item._underlying_vm_=this.clone(this.context.element),lr=A.item},onDragAdd:function(A){var M=A.item._underlying_vm_;if(M!==void 0){D(A.item);var j=this.getVmIndexFromDomIndex(A.newIndex);this.spliceList(j,0,M);var U={element:M,newIndex:j};this.emitChanges({added:U})}},onDragRemove:function(A){if(I(this.$el,A.item,A.oldIndex),A.pullMode==="clone"){D(A.clone);return}var M=this.context,j=M.index,U=M.element;this.spliceList(j,1);var Q={element:U,oldIndex:j};this.emitChanges({removed:Q})},onDragUpdate:function(A){D(A.item),I(A.from,A.item,A.oldIndex);var M=this.context.index,j=this.getVmIndexFromDomIndex(A.newIndex);this.updatePosition(M,j);var U={element:this.context.element,oldIndex:M,newIndex:j};this.emitChanges({moved:U})},computeFutureIndex:function(A,M){if(!A.element)return 0;var j=T(M.to.children).filter(function(me){return me.style.display!=="none"}),U=j.indexOf(M.related),Q=A.component.getVmIndexFromDomIndex(U),ie=j.indexOf(lr)!==-1;return ie||!M.willInsertAfter?Q:Q+1},onDragMove:function(A,M){var j=this.move,U=this.realList;if(!j||!U)return!0;var Q=this.getRelatedContextFromMoveEvent(A),ie=this.computeFutureIndex(Q,A),me=h(h({},this.context),{},{futureIndex:ie}),Ge=h(h({},A),{},{relatedContext:Q,draggedContext:me});return j(Ge,M)},onDragEnd:function(){lr=null}}}),hr=fr;t.default=hr},fb6a:function(e,t,r){var s=r("23e7"),l=r("861d"),u=r("e8b5"),c=r("23cb"),f=r("50c4"),h=r("fc6a"),v=r("8418"),p=r("b622"),y=r("1dde"),g=r("ae40"),E=y("slice"),b=g("slice",{ACCESSORS:!0,0:0,1:2}),x=p("species"),S=[].slice,C=Math.max;s({target:"Array",proto:!0,forced:!E||!b},{slice:function(O,P){var D=h(this),I=f(D.length),G=c(O,I),w=c(P===void 0?I:P,I),R,L,k;if(u(D)&&(R=D.constructor,typeof R=="function"&&(R===Array||u(R.prototype))?R=void 0:l(R)&&(R=R[x],R===null&&(R=void 0)),R===Array||R===void 0))return S.call(D,G,w);for(L=new(R===void 0?Array:R)(C(w-G,0)),k=0;G<w;G++,k++)G in D&&v(L,k,D[G]);return L.length=k,L}})},fc6a:function(e,t,r){var s=r("44ad"),l=r("1d80");e.exports=function(u){return s(l(u))}},fdbc:function(e,t){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},fdbf:function(e,t,r){var s=r("4930");e.exports=s&&!Symbol.sham&&typeof Symbol.iterator=="symbol"}}).default})})(al);var Pc=al.exports;const Tc=Cu(Pc);function zn(a){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?zn=function(o){return typeof o}:zn=function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},zn(a)}function X(a,o){if(!(a instanceof o))throw new TypeError("Cannot call a class as a function")}function za(a,o){for(var n=0;n<o.length;n++){var i=o[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(a,i.key,i)}}function J(a,o,n){return o&&za(a.prototype,o),n&&za(a,n),a}function d(a,o,n){return o in a?Object.defineProperty(a,o,{value:n,enumerable:!0,configurable:!0,writable:!0}):a[o]=n,a}function be(a,o){if(typeof o!="function"&&o!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(o&&o.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),o&&ko(a,o)}function De(a){return De=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},De(a)}function ko(a,o){return ko=Object.setPrototypeOf||function(i,e){return i.__proto__=e,i},ko(a,o)}function Oc(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function m(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function Ac(a,o){return o&&(typeof o=="object"||typeof o=="function")?o:m(a)}function xe(a){var o=Oc();return function(){var i=De(a),e;if(o){var t=De(this).constructor;e=Reflect.construct(i,arguments,t)}else e=i.apply(this,arguments);return Ac(this,e)}}function Dc(a,o){for(;!Object.prototype.hasOwnProperty.call(a,o)&&(a=De(a),a!==null););return a}function Le(a,o,n){return typeof Reflect<"u"&&Reflect.get?Le=Reflect.get:Le=function(e,t,r){var s=Dc(e,t);if(s){var l=Object.getOwnPropertyDescriptor(s,t);return l.get?l.get.call(r):l.value}},Le(a,o,n||a)}function Ti(a,o){return Ic(a)||wc(a,o)||ml(a,o)||Lc()}function qn(a){return _c(a)||Mc(a)||ml(a)||kc()}function _c(a){if(Array.isArray(a))return Lo(a)}function Ic(a){if(Array.isArray(a))return a}function Mc(a){if(typeof Symbol<"u"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function wc(a,o){var n=a==null?null:typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(n!=null){var i=[],e=!0,t=!1,r,s;try{for(n=n.call(a);!(e=(r=n.next()).done)&&(i.push(r.value),!(o&&i.length===o));e=!0);}catch(l){t=!0,s=l}finally{try{!e&&n.return!=null&&n.return()}finally{if(t)throw s}}return i}}function ml(a,o){if(a){if(typeof a=="string")return Lo(a,o);var n=Object.prototype.toString.call(a).slice(8,-1);if(n==="Object"&&a.constructor&&(n=a.constructor.name),n==="Map"||n==="Set")return Array.from(a);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Lo(a,o)}}function Lo(a,o){(o==null||o>a.length)&&(o=a.length);for(var n=0,i=new Array(o);n<o;n++)i[n]=a[n];return i}function kc(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Lc(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cn(a,o,n){return a==="*"?!0:a.length>0?a.indexOf(o)!==-1:!n}function W(a,o,n){var i;a=a||{},o=o||{};var e=a,t=o;for(i in t)e[i]=t[i];return a}function No(a){return Object.prototype.toString.call(a)==="[object Number]"}function Ne(a){return typeof a=="string"}function El(a){return typeof a=="boolean"}function er(a){return a==null?!1:Object.prototype.toString.call(a)==="[object Object]"}function Nc(a){return Object.prototype.toString.call(a)==="[object Date]"}function Sn(a){return Object.prototype.toString.call(a)==="[object Function]"}function Ri(a){if(Ne(a))return""+a;if(El(a))return!!a;if(Nc(a))return new Date(a.getTime());if(Sn(a))return a;if(Array.isArray(a)){for(var o=[],n=0;n<a.length;n++)o.push(Ri(a[n]));return o}else if(er(a)){var i={};for(var e in a)i[e]=Ri(a[e]);return i}else return a}function Gi(a,o,n,i){var e={},t,r,s={};for(n=n||[],i=i||[],r=0;r<n.length;r++)e[n[r]]=!0;for(r=0;r<i.length;r++)s[i[r]]=!0;var l=Ri(a);for(r in o)if(l[r]==null||s[r])l[r]=o[r];else if(e[r])t=[],t.push.apply(t,Array.isArray(l[r])?l[r]:[l[r]]),t.push(o[r]),l[r]=t;else if(Ne(o[r])||El(o[r])||Sn(o[r])||No(o[r]))l[r]=o[r];else if(Array.isArray(o[r]))t=[],Array.isArray(l[r])&&t.push.apply(t,l[r]),t.push.apply(t,o[r]),l[r]=t;else if(er(o[r])){er(l[r])||(l[r]={});for(var u in o[r])l[r][u]=o[r][u]}return l}function bl(a,o,n){for(var i=0;i<n.length;i++){var e=n[i][0][n[i][1]].apply(n[i][0],n[i][2]);if(e===o)return e}return a}function Rc(a,o,n,i){var e=function(s){var l=s.match(/(\${.*?})/g);if(l!=null)for(var u=0;u<l.length;u++){var c=o[l[u].substring(2,l[u].length-1)]||"";c!=null&&(s=s.replace(l[u],c))}if(l=s.match(/({{.*?}})/g),l!=null)for(var f=0;f<l.length;f++){var h=o[l[f].substring(2,l[f].length-2)]||"";h!=null&&(s=s.replace(l[f],h))}return s},t=function r(s){if(s!=null){if(Ne(s))return e(s);if(Sn(s)&&!i&&(s.name||"").indexOf(n)===0)return s(o);if(Array.isArray(s)){for(var l=[],u=0;u<s.length;u++)l.push(r(s[u]));return l}else if(er(s)){var c={};for(var f in s)c[f]=r(s[f]);return c}else return s}};return t(a)}function K(a,o){if(a)for(var n=0;n<a.length;n++)o(a[n]);else return null}function rn(a,o){if(a){for(var n=0;n<a.length;n++)if(o(a[n]))return n}return-1}function Gc(a,o){var n=[];if(a)for(var i=0;i<a.length;i++)o(a[i])&&n.push(i);return n}function ua(a,o){var n=rn(a,o);return n===-1?null:a[n]}function jc(a,o){var n=Gc(a,o);return n.map(function(i){return a[i]})}function xl(a,o){var n=null;return a.forEach(function(i){o(i)&&(n=i)}),n}function Fc(a){var o=[];return a.forEach(function(n){o.push(n)}),o}function Ye(a,o){var n=rn(a,o);return n>-1&&a.splice(n,1),n!==-1}function li(a){if(Array.fromArray!=null)return Array.from(a);var o=[];return Array.prototype.push.apply(o,a),o}function Za(a,o){var n=a.indexOf(o);return n>-1&&a.splice(n,1),n!==-1}function Sl(a,o,n,i){var e=a[o];return e==null&&(e=[],a[o]=e),e[i?"unshift":"push"](n),e}function gr(a,o,n){return a.indexOf(o)===-1?(a.push(o),!0):!1}var We=[];for(var yr=0;yr<256;yr++)We[yr]=(yr<16?"0":"")+yr.toString(16);function He(){var a=Math.random()*4294967295|0,o=Math.random()*4294967295|0,n=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return We[a&255]+We[a>>8&255]+We[a>>16&255]+We[a>>24&255]+"-"+We[o&255]+We[o>>8&255]+"-"+We[o>>16&15|64]+We[o>>24&255]+"-"+We[n&63|128]+We[n>>8&255]+"-"+We[n>>16&255]+We[n>>24&255]+We[i&255]+We[i>>8&255]+We[i>>16&255]+We[i>>24&255]}function ji(a,o,n){var i={x:a.x-o.x,y:a.y-o.y},e=Math.cos(n/360*Math.PI*2),t=Math.sin(n/360*Math.PI*2);return{x:i.x*e-i.y*t+o.x,y:i.y*e+i.x*t+o.y,cr:e,sr:t}}function ca(a){if(a==null)return null;for(var o=a.replace(/^\s\s*/,""),n=/\s/,i=o.length;n.test(o.charAt(--i)););return o.slice(0,i+1)}function Bc(a,o){a=a.length==null||typeof a=="string"?[a]:a;for(var n=0;n<a.length;n++)o(a[n])}function Cl(a,o){for(var n=[],i=0;i<a.length;i++)n.push(o(a[i]));return n}function Ue(){for(var a=arguments.length,o=new Array(a),n=0;n<a;n++)o[n]=arguments[n];if(typeof console<"u")try{var i=arguments[arguments.length-1];console.log(i)}catch{}}function Fi(a){return a<0?-1:a>0?1:0}function ui(a,o,n){return function(){var i=null;try{o!=null&&(i=o.apply(this,arguments))}catch(e){Ue("jsPlumb function failed : "+e)}if(a!=null&&(n==null||i!==n))try{i=a.apply(this,arguments)}catch(e){Ue("wrapped function failed : "+e)}return i}}function Ja(a,o,n){return a.has(o)||a.set(o,n()),a.get(o)}function Pl(a,o){for(var n=a.__proto__;n!=null;){if(n instanceof o)return!0;n=n.__proto__}return!1}function Uc(a,o,n,i){if(o.length===0)o.push(a);else{for(var e=i?-1:1,t=0,r=o.length,s=Math.floor((t+r)/2);r>t;){var l=n(a,o[s])*e;l<0?r=s:t=s+1,s=Math.floor((t+r)/2)}o.splice(s,0,a)}}function Cn(a,o,n){n=n||a.parentNode;for(var i=n.querySelectorAll(o),e=0;e<i.length;e++)if(i[e]===a)return!0;return!1}function Ur(a,o){a.stopPropagation?a.stopPropagation():a.returnValue=!1,!o&&a.preventDefault&&a.preventDefault()}function Rt(a,o,n,i){if(i&&Cn(a,o,n))return a;for(a=a.parentNode;a!=null&&a!==n;){if(Cn(a,o))return a;a=a.parentNode}}function ot(a){return a.srcElement||a.target}function Hc(a,o,n){o=ca(o),typeof a.className.baseVal<"u"?a.className.baseVal=o:a.className=o;try{var i=a.classList;if(i!=null){for(;i.length>0;)i.remove(i.item(0));for(var e=0;e<n.length;e++)n[e]&&i.add(n[e])}}catch(t){Ue("WARN: cannot set class list",t)}}function fa(a){return a.className!=null?typeof a.className.baseVal>"u"?a.className:a.className.baseVal:""}function Tl(a,o,n){var i=o==null?[]:Array.isArray(o)?o:o.split(/\s+/),e=n==null?[]:Array.isArray(n)?n:n.split(/\s+/),t=fa(a),r=t.split(/\s+/),s=function(u,c){for(var f=0;f<c.length;f++)if(u)r.indexOf(c[f])===-1&&r.push(c[f]);else{var h=r.indexOf(c[f]);h!==-1&&r.splice(h,1)}};s(!0,i),s(!1,e),Hc(a,r.join(" "),r)}function Hr(a){return!Ne(a)&&!Array.isArray(a)&&a.length!=null&&a.documentElement==null&&a.nodeType==null}function Vc(a){return fa(a)}function gn(a,o){var n=function(e,t){if(e!=null&&t!=null&&t.length>0)if(e.classList){var r=ca(t).split(/\s+/);K(r,function(s){e.classList.add(s)})}else Tl(e,t)};Hr(a)?K(a,function(i){return n(i,o)}):n(a,o)}function Yc(a,o){return a.classList?a.classList.contains(o):fa(a).indexOf(o)!==-1}function Ro(a,o){var n=function(e,t){if(e!=null&&t!=null&&t.length>0)if(e.classList){var r=ca(t).split(/\s+/);r.forEach(function(s){e.classList.remove(s)})}else Tl(e,null,t)};Hr(a)?K(a,function(i){return n(i,o)}):n(a,o)}function Xc(a,o){var n=this,i=function(t,r){t!=null&&r!=null&&r.length>0&&(t.classList?t.classList.toggle(r):n.hasClass(t,r)?n.removeClass(t,r):n.addClass(t,r))};Hr(a)?K(a,function(e){return i(e,o)}):i(a,o)}function Ol(a,o,n,i){return Al(null,a,o,n,i)}function Al(a,o,n,i,e){var t=a==null?document.createElement(o):document.createElementNS(a,o),r;n=n||{};for(r in n)t.style[r]=n[r];i&&(t.className=i),e=e||{};for(r in e)t.setAttribute(r,""+e[r]);return t}function Xn(a){var o=a.getBoundingClientRect(),n=document.body,i=document.documentElement,e=window.pageYOffset||i.scrollTop||n.scrollTop,t=window.pageXOffset||i.scrollLeft||n.scrollLeft,r=i.clientTop||n.clientTop||0,s=i.clientLeft||n.clientLeft||0,l=o.top+e-r,u=o.left+t-s;return{x:Math.round(u),y:Math.round(l)}}function $c(a){return{w:a.offsetWidth,h:a.offsetHeight}}function Wc(a){try{return{w:parseFloat(a.width.baseVal.value),h:parseFloat(a.height.baseVal.value)}}catch{return{w:0,h:0}}}function Kc(a){try{return{x:parseFloat(a.x.baseVal.value),y:parseFloat(a.y.baseVal.value)}}catch{return{x:0,y:0}}}function ci(a,o){var n=o.getContainer().getBoundingClientRect(),i=a.getBoundingClientRect(),e=o.currentZoom;return{x:(i.left-n.left)/e,y:(i.top-n.top)/e}}function mr(a,o){var n=a.getBoundingClientRect(),i=o.currentZoom;return{w:n.width/i,h:n.height/i}}var Pn;(function(a){a.SVG="SVG",a.HTML="HTML"})(Pn||(Pn={}));function Go(a){return a instanceof SVGElement?Pn.SVG:Pn.HTML}function zc(a){return Go(a)===Pn.SVG}function Tn(){for(var a=arguments.length,o=new Array(a),n=0;n<a;n++)o[n]=arguments[n];return o.map(function(i){return"."+i}).join(",")}function Zc(){for(var a=arguments.length,o=new Array(a),n=0;n<a;n++)o[n]=arguments[n];return o.join(" ")}function no(){for(var a=arguments.length,o=new Array(a),n=0;n<a;n++)o[n]=arguments[n];return o.map(function(i){return"["+i+"]"}).join(",")}var jo="source",Dl="target",Fo="block",tr="none",Vr="absolute",Qa="fixed",Jc="static",_l="data-jtk-group",Jt="data-jtk-managed",Oi="data-jtk-not-draggable",qa="tabindex",Qc="data-jtk-scope",Il=Qc+"-",Ml="checkCondition",qc="checkDropAllowed",ha="jtk-connector",ef="jtk-connector-outline",tf="jtk-connected",Zn="jtk-endpoint",nf="jtk-endpoint-connected",rf="jtk-endpoint-full",da="jtk-floating-endpoint",of="jtk-endpoint-drop-allowed",af="jtk-endpoint-drop-forbidden",sf="jtk-endpoint-anchor",fi="jtk-group-collapsed",Er="jtk-group-expanded",ro="jtk-overlay",lf="anchor:changed",va="connection",wl="internal.connection",kl="connection:detach",pa="connection:move",uf="container:change",cf="endpoint:replaced",Ll="internal.endpoint:unregistered",ga="internal.connection:detached",Nl="element:manage",ff="group:added",hf="group:collapse",df="group:expand",vf="group:member:added",pf="group:member:removed",gf="group:removed",Rl="maxConnections",yf="group:nested:added",mf="group:nested:removed",Gl="element:unmanage",jl="zoom",Jn="isDetachAllowed",Ef="beforeDrag",Fl="beforeDrop",Bl="beforeDetach",bf="beforeStartDetach",Ae=no(Jt),xf="Cannot establish connection: source endpoint is full",Sf="Cannot establish connection: target endpoint is full",Cf="Cannot establish connection: source does not exist",Pf="Cannot establish connection: target does not exist",Tf="connectionOverlays",es={"stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},br="stroke-dasharray",bo="dashstyle",Of="fill",Af="stroke",Df="stroke-width",_f="strokeWidth",Ul="svg",Bo="path",ts={svg:"http://www.w3.org/2000/svg"};function Bt(a,o){for(var n in o)a.setAttribute(n,""+o[n])}function Ut(a,o){return o=o||{},o.version="1.1",o.xmlns=ts.svg,Al(ts.svg,a,null,null,o)}function Hl(a){return"position:absolute;left:"+a[0]+"px;top:"+a[1]+"px"}function Uo(a,o,n){if(o.setAttribute(Of,n.fill?n.fill:tr),o.setAttribute(Af,n.stroke?n.stroke:tr),n.strokeWidth&&o.setAttribute(Df,n.strokeWidth),n[bo]&&n[_f]&&!n[br]){var i=n[bo].indexOf(",")===-1?" ":",",e=n[bo].split(i),t="";K(e,function(s){t+=Math.floor(s*n.strokeWidth)+i}),o.setAttribute(br,t)}else n[br]&&o.setAttribute(br,n[br]);for(var r in es)n[r]&&o.setAttribute(es[r],n[r])}function Ai(a,o,n){a.childNodes.length>n?a.insertBefore(o,a.childNodes[n]):a.appendChild(o)}function Te(a,o,n){var i=[a,o];return i.join(":")}var ns="data-jtk-container",If="data-jtk-group-content",hi="data-jtk-enabled",xo="data-jtk-scope",_n="endpoint",wt="element",kt="connection",Vl="div",et="click",Gt="contextmenu",lt="dblclick",xt="dbltap",Mf="focus",ue="mousedown",ya="mouseenter",ma="mouseexit",Ve="mousemove",ce="mouseup",ft="mouseout",ht="mouseover",St="tap",wf="touchstart",kf="touchend",Lf="touchmove",Nf="drag:move",Rf="drag:stop",Gf="drag:start",Bi="revert",jf="connection:abort",rs="connection:drag",is=Te(wt,et),Ff=Te(wt,lt),os=Te(wt,xt),Bf=Te(wt,ft),Uf=Te(wt,ht),Hf=Te(wt,Ve),Vf=Te(wt,ce),Yf=Te(wt,ue),Xf=Te(wt,Gt),as=Te(wt,St),$f=Te(_n,et),Wf=Te(_n,lt),Kf=Te(_n,ft),zf=Te(_n,ht),Zf=Te(_n,ce),Jf=Te(_n,ue),Qf=Te(kt,et),qf=Te(kt,lt),eh=Te(kt,xt),th=Te(kt,ft),nh=Te(kt,ht),rh=Te(kt,ce),ih=Te(kt,ue),oh=Te(kt,Gt),ah=Te(kt,St),ss="position",mt=Tn(ha),fn=Tn(Zn),sh=no(_l),lh=no(If),Nt=Tn(ro),on;(function(a){a.Circle="Circle",a.Ellipse="Ellipse",a.Triangle="Triangle",a.Diamond="Diamond",a.Rectangle="Rectangle",a.Square="Square"})(on||(on={}));var Mt;(function(a){a.Assign="Assign",a.AutoDefault="AutoDefault",a.Bottom="Bottom",a.BottomLeft="BottomLeft",a.BottomRight="BottomRight",a.Center="Center",a.Continuous="Continuous",a.ContinuousBottom="ContinuousBottom",a.ContinuousLeft="ContinuousLeft",a.ContinuousRight="ContinuousRight",a.ContinuousTop="ContinuousTop",a.ContinuousLeftRight="ContinuousLeftRight",a.ContinuousTopBottom="ContinuousTopBottom",a.Left="Left",a.Perimeter="Perimeter",a.Right="Right",a.Top="Top",a.TopLeft="TopLeft",a.TopRight="TopRight"})(Mt||(Mt={}));function uh(){return{d:1/0,x:null,y:null,l:null,x1:null,y1:null,x2:null,y2:null}}function Ui(){return{xmin:1/0,xmax:-1/0,ymin:1/0,ymax:-1/0}}var Ea=function(){function a(o){X(this,a),this.params=o,d(this,"x1",void 0),d(this,"x2",void 0),d(this,"y1",void 0),d(this,"y2",void 0),d(this,"extents",Ui()),d(this,"type",void 0),this.x1=o.x1,this.y1=o.y1,this.x2=o.x2,this.y2=o.y2}return J(a,[{key:"findClosestPointOnPath",value:function(n,i){return uh()}},{key:"lineIntersection",value:function(n,i,e,t){return[]}},{key:"boxIntersection",value:function(n,i,e,t){var r=[];return r.push.apply(r,this.lineIntersection(n,i,n+e,i)),r.push.apply(r,this.lineIntersection(n+e,i,n+e,i+t)),r.push.apply(r,this.lineIntersection(n+e,i+t,n,i+t)),r.push.apply(r,this.lineIntersection(n,i+t,n,i)),r}},{key:"boundingBoxIntersection",value:function(n){return this.boxIntersection(n.x,n.y,n.w,n.h)}}]),a}(),Yl="undefined",Hi="default",Xl="true",Wn="false",mn="*",xr,Sr;function ch(a,o,n,i,e,t,r){return new Touch({target:a,identifier:He(),pageX:o,pageY:n,screenX:i,screenY:e,clientX:t||i,clientY:r||e})}function fh(){var a=[];return a.push.apply(a,arguments),a.item=function(o){return this[o]},a}function hh(a,o,n,i,e,t,r){return fh(ch(a,o,n,i,e,t,r))}function nr(a,o,n){n=n||a.parentNode;for(var i=n.querySelectorAll(o),e=0;e<i.length;e++)if(i[e]===a)return!0;return!1}function Yr(a){return a.srcElement||a.target}function Ho(a,o,n,i){if(i){var e=a.composedPath?a.composedPath():a.path;if(typeof e<"u"&&e.indexOf)return{path:e,end:e.indexOf(n)};var t={path:[],end:-1},r=function s(l){t.path.push(l),l===n?t.end=t.path.length-1:l.parentNode!=null&&s(l.parentNode)};return r(o),t}else return{path:[o],end:1}}function dh(a,o){var n=0,i;for(n=0,i=a.length;n<i&&a[n][0]!==o;n++);n<a.length&&a.splice(n,1)}var vh=1;function jr(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints!=null&&navigator.maxTouchPoints>0}function Di(){return"onmousedown"in document.documentElement}var jt=(xr={},d(xr,ue,wf),d(xr,ce,kf),d(xr,Ve,Lf),xr),ph="page",gh="screen",yh="client";function ba(a,o){if(a==null)return{x:0,y:0};var n=$l(a),i=bh(n,0);return{x:i[o+"X"],y:i[o+"Y"]}}function Vi(a){return ba(a,ph)}function mh(a){return ba(a,gh)}function Eh(a){return ba(a,yh)}function bh(a,o){return a.item?a.item(o):a[o]}function $l(a){return a.touches&&a.touches.length>0?a.touches:a.changedTouches&&a.changedTouches.length>0?a.changedTouches:a.targetTouches&&a.targetTouches.length>0?a.targetTouches:[a]}function xh(a){return $l(a).length}function Yi(a,o,n,i,e){if(Kl(a,o,n),i.__tauid=n.__tauid,a.addEventListener)a.addEventListener(o,n,!1,e);else if(a.attachEvent){var t=o+n.__tauid;a["e"+t]=n,a[t]=function(){a["e"+t]&&a["e"+t](window.event)},a.attachEvent("on"+o,a[t])}}function Xr(a,o,n){var i=this;n!=null&&Wl(a,function(e){if(Sh(e,o,n),n.__tauid!=null){if(e.removeEventListener)e.removeEventListener(o,n,!1),jr()&&jt[o]&&e.removeEventListener(jt[o],n,!1);else if(i.detachEvent){var t=o+n.__tauid;e[t]&&e.detachEvent("on"+o,e[t]),e[t]=null,e["e"+t]=null}}n.__taTouchProxy&&Xr(a,n.__taTouchProxy[1],n.__taTouchProxy[0])})}function Wl(a,o){if(a!=null)for(var n=typeof a=="string"?document.querySelectorAll(a):a.length!=null?a:[a],i=0;i<n.length;i++)o(n[i])}function Kl(a,o,n){var i=vh++;return a.__ta=a.__ta||{},a.__ta[o]=a.__ta[o]||{},a.__ta[o][i]=n,n.__tauid=i,i}function Sh(a,o,n){if(a.__ta&&a.__ta[o]&&delete a.__ta[o][n.__tauid],n.__taExtra){for(var i=0;i<n.__taExtra.length;i++)Xr(a,n.__taExtra[i][0],n.__taExtra[i][1]);n.__taExtra.length=0}n.__taUnstore&&n.__taUnstore()}var Ch=/:not\(([^)]+)\)/;function Xi(a,o,n,i){if(a==null)return n;var e=a.split(","),t=[],r=[];K(e,function(l){var u=l.match(Ch);u!=null?r.push(u[1]):t.push(l)}),r.length>0&&t.length===0&&t.push(mn);var s=function l(u){l.__tauid=n.__tauid;var c=Yr(u),f=!1,h=c,v=Ho(u,c,o,a!=null);if(v.end!=-1)for(var p=0;!f&&p<v.end;p++){h=v.path[p];for(var y=0;y<r.length;y++)if(nr(h,r[y],o))return;for(var g=0;!f&&g<t.length;g++)if(nr(h,t[g],o)){n.apply(h,[u,h]),f=!0;break}}};return Ph(n,i,s),s}function Ph(a,o,n){a.__taExtra=a.__taExtra||[],a.__taExtra.push([o,n])}var _i=function(o,n,i,e,t){if(jr()&&jt[n]){var r=Xi(e,o,i,jt[n]);Yi(o,jt[n],r,i,t)}n===Mf&&o.getAttribute(qa)==null&&o.setAttribute(qa,"1"),Yi(o,n,Xi(e,o,i,n),i,t)},So=(Sr={},d(Sr,St,{touches:1,taps:1}),d(Sr,xt,{touches:1,taps:2}),d(Sr,Gt,{touches:2,taps:1}),Sr);function ls(a,o,n,i){for(var e in n.__tamee[a])n.__tamee[a].hasOwnProperty(e)&&n.__tamee[a][e].apply(i,[o])}var Th=function(){function a(){X(this,a)}return J(a,null,[{key:"generate",value:function(n,i){return function(e,t,r,s){if(t==Gt&&Di())_i(e,t,r,s);else{if(e.__taTapHandler==null){var l=e.__taTapHandler={tap:[],dbltap:[],down:!1,taps:0,downSelectors:[]},u=function(p){for(var y=Yr(p),g=Ho(p,y,e,s!=null),E=!1,b=0;b<g.end;b++){if(E)return;y=g.path[b];for(var x=0;x<l.downSelectors.length;x++)if(l.downSelectors[x]==null||nr(y,l.downSelectors[x],e)){l.down=!0,setTimeout(f,n),setTimeout(h,i),E=!0;break}}},c=function(p){if(l.down){var y=Yr(p),g,E;l.taps++;var b=xh(p);for(var x in So)if(So.hasOwnProperty(x)){var S=So[x];if(S.touches===b&&(S.taps===1||S.taps===l.taps))for(var C=0;C<l[x].length;C++){E=Ho(p,y,e,l[x][C][1]!=null);for(var T=0;T<E.end;T++)if(g=E.path[T],l[x][C][1]==null||nr(g,l[x][C][1],e)){l[x][C][0].apply(g,[p,g]);break}}}}},f=function(){l.down=!1},h=function(){l.taps=0};e.__taTapHandler.downHandler=u,e.__taTapHandler.upHandler=c,_i(e,ue,u),_i(e,ce,c)}e.__taTapHandler.downSelectors.push(s),e.__taTapHandler[t].push([r,s]),r.__taUnstore=function(){e.__taTapHandler!=null&&(Ye(e.__taTapHandler.downSelectors,function(v){return v===s}),dh(e.__taTapHandler[t],r),e.__taTapHandler.downSelectors.length===0&&(Xr(e,ue,e.__taTapHandler.downHandler),Xr(e,ce,e.__taTapHandler.upHandler),delete e.__taTapHandler))}}}}}]),a}(),Oh=function(){function a(){X(this,a)}return J(a,null,[{key:"generate",value:function(){var n=[];return function(i,e,t,r){if(!i.__tamee){i.__tamee={over:!1,mouseenter:[],mouseexit:[]};var s=function(c){var f=Yr(c);(r==null&&f==i&&!i.__tamee.over||nr(f,r,i)&&(f.__tamee==null||!f.__tamee.over))&&(ls(ya,c,i,f),f.__tamee=f.__tamee||{},f.__tamee.over=!0,n.push(f))},l=function(c){for(var f=Yr(c),h=0;h<n.length;h++)f==n[h]&&!nr(c.relatedTarget||c.toElement,"*",f)&&(f.__tamee.over=!1,n.splice(h,1),ls(ma,c,i,f))};Yi(i,ht,Xi(r,i,s,ht),s),Yi(i,ft,Xi(r,i,l,ft),l)}t.__taUnstore=function(){delete i.__tamee[e][t.__tauid]},Kl(i,e,t),i.__tamee[e][t.__tauid]=t}}}]),a}(),xa=function(){function a(o){X(this,a),d(this,"clickThreshold",void 0),d(this,"dblClickThreshold",void 0),d(this,"tapHandler",void 0),d(this,"mouseEnterExitHandler",void 0),o=o||{},this.clickThreshold=o.clickThreshold||250,this.dblClickThreshold=o.dblClickThreshold||450,this.mouseEnterExitHandler=Oh.generate(),this.tapHandler=Th.generate(this.clickThreshold,this.dblClickThreshold)}return J(a,[{key:"_doBind",value:function(n,i,e,t,r){if(e!=null){var s=n;i===St||i===xt||i===Gt?this.tapHandler(s,i,e,t,r):i===ya||i==ma?this.mouseEnterExitHandler(s,i,e,t,r):_i(s,i,e,t,r)}}},{key:"on",value:function(n,i,e,t,r){var s=t==null?null:e,l=t??e;return this._doBind(n,i,l,s,r),this}},{key:"off",value:function(n,i,e){return Xr(n,i,e),this}},{key:"trigger",value:function(n,i,e,t,r){var s=Di()&&(typeof MouseEvent>"u"||e==null||e.constructor===MouseEvent),l=jr()&&!Di()&&jt[i]?jt[i]:i,u=!(jr()&&!Di()&&jt[i]),c=Vi(e),f=mh(e),h=Eh(e);return Wl(n,function(v){var p;e=e||{screenX:f.x,screenY:f.y,clientX:h.x,clientY:h.y};var y=function(S){t&&(S.payload=t)},g={TouchEvent:function(S){var C=hh(v,c.x,c.y,f.x,f.y,h.x,h.y),T=S.initTouchEvent||S.initEvent;T(l,!0,!0,window,null,f.x,f.y,h.x,h.y,!1,!1,!1,!1,C,C,C,1,0)},MouseEvents:function(S){S.initMouseEvent(l,!0,!0,window,r??1,f.x,f.y,h.x,h.y,!1,!1,!1,!1,1,v)}},E=!u&&!s&&jr()&&jt[i],b=E?"TouchEvent":"MouseEvents";p=document.createEvent(b),g[b](p),y(p),v.dispatchEvent(p)}),this}}]),a}(),Ah=[null,[1,-1],[1,1],[-1,1],[-1,-1]],Dh=[null,[-1,-1],[-1,1],[1,1],[1,-1]],hn=2*Math.PI;function rr(a,o){return o.x===a.x?o.y>a.y?1/0:-1/0:o.y===a.y?o.x>a.x?0:-0:(o.y-a.y)/(o.x-a.x)}function _h(a,o){return-1/rr(a,o)}function Vo(a,o){return Math.sqrt(Math.pow(o.y-a.y,2)+Math.pow(o.x-a.x,2))}function Sa(a,o){return o.x>a.x||o.x==a.x?o.y>a.y?2:1:o.y>a.y?3:4}function Ih(a,o){var n=rr(a,o),i=Math.atan(n),e=Sa(a,o);return(e==4||e==3)&&(i+=Math.PI),i<0&&(i+=2*Math.PI),i}function zl(a,o){var n=a.x,i=a.x+a.w,e=a.y,t=a.y+a.h,r=o.x,s=o.x+o.w,l=o.y,u=o.y+o.h;return n<=r&&r<=i&&e<=l&&l<=t||n<=s&&s<=i&&e<=l&&l<=t||n<=r&&r<=i&&e<=u&&u<=t||n<=s&&r<=i&&e<=u&&u<=t||r<=n&&n<=s&&l<=e&&e<=u||r<=i&&i<=s&&l<=e&&e<=u||r<=n&&n<=s&&l<=t&&t<=u||r<=i&&n<=s&&l<=t&&t<=u}function yn(a,o,n){var i=rr(a,o),e=Sa(a,o),t=n>0?Ah[e]:Dh[e],r=Math.atan(i),s=Math.abs(n*Math.sin(r))*t[1],l=Math.abs(n*Math.cos(r))*t[0];return{x:a.x+l,y:a.y+s}}function Mh(a,o,n){var i=rr(a,o),e=Math.atan(-1/i),t=n/2*Math.sin(e),r=n/2*Math.cos(e);return[{x:o.x+r,y:o.y+t},{x:o.x-r,y:o.y-t}]}function wh(a,o,n,i){n=n??(o.thresholdX==null?o.w/2:o.thresholdX),i=i??(o.thresholdY==null?o.h/2:o.thresholdY);var e=Math.floor(a.x/o.w),t=o.w*e,r=t+o.w,s=Math.abs(a.x-t)<=n?t:Math.abs(r-a.x)<=n?r:a.x,l=Math.floor(a.y/o.h),u=o.h*l,c=u+o.h,f=Math.abs(a.y-u)<=i?u:Math.abs(c-a.y)<=i?c:a.y;return{x:s,y:f}}function kh(a,o,n){if(Cn(o,n,a))return o;for(var i=o.parentNode;i!=null&&i!==a;){if(Cn(i,n,a))return i;i=i.parentNode}}function Lh(a){return typeof a=="function"?(a._katavorioId=He(),a._katavorioId):a}function us(a,o,n){var i=o.parentNode,e=a.getSize(i),t=a.getSize(o),r=n.x,s=r+t.w,l=n.y,u=l+t.h;return s>0&&r<e.w&&u>0&&l<e.h}function Nh(a,o,n){for(var i=null,e=o.getAttribute("katavorio-draggable"),t=e!=null?"[katavorio-draggable='"+e+"'] ":"",r=0;r<a.length;r++)if(i=kh(o,n,t+a[r].selector),i!=null){if(a[r].filter){var s=Cn(n,a[r].filter,i),l=a[r].filterExclude===!0;if(l&&!s||s)return null}return[a[r],i]}return null}var Zl="start",Jl="beforeStart",Ql="drag",Rh="drop",Gh="over",jh="out",ql="stop",eu="katavorio-draggable",Fh=eu,Bh=10,Uh=10,Co=function(){return!0},Hh=function(){return!1},Dr={delegatedDraggable:"katavorio-delegated-draggable",draggable:Fh,drag:"katavorio-drag",selected:"katavorio-drag-selected",noSelect:"katavorio-drag-no-select",ghostProxy:"katavorio-ghost-proxy",clonedDrag:"katavorio-clone-drag"},Pt;(function(a){a.absolutePosition="absolutePosition",a.transform="transform",a.xyAttributes="xyAttributes"})(Pt||(Pt={}));var Ca=new Map;Ca.set(Pt.absolutePosition,function(a,o){a.style.left="".concat(o.x,"px"),a.style.top="".concat(o.y,"px")});Ca.set(Pt.xyAttributes,function(a,o){a.setAttribute("x","".concat(o.x)),a.setAttribute("y","".concat(o.y))});var Pa=new Map;Pa.set(Pt.absolutePosition,function(a){return{x:a.offsetLeft,y:a.offsetTop}});Pa.set(Pt.xyAttributes,function(a){return{x:parseFloat(a.getAttribute("x")),y:parseFloat(a.getAttribute("y"))}});var Ta=new Map;Ta.set(Pt.absolutePosition,function(a,o){a.style.width="".concat(o.w,"px"),a.style.height="".concat(o.h,"px")});Ta.set(Pt.xyAttributes,function(a,o){a.setAttribute("width","".concat(o.w)),a.setAttribute("height","".concat(o.h))});var Oa=new Map;Oa.set(Pt.absolutePosition,function(a){return{w:a.offsetWidth,h:a.offsetHeight}});Oa.set(Pt.xyAttributes,function(a){return{w:parseFloat(a.getAttribute("width")),h:parseFloat(a.getAttribute("height"))}});var Po=[ql,Zl,Ql,Rh,Gh,jh,Jl],Vh=function(){},Nn=function(o,n){if(o!=null){o=!Ne(o)&&o.tagName==null&&o.length!=null?o:[o];for(var i=0;i<o.length;i++)n.apply(o[i],[o[i]])}},Yh=function(o,n,i){var e=o.srcElement||o.target;return!Cn(e,i.getInputFilterSelector(),n)},Xh=function(){function a(o,n){X(this,a),this.el=o,this.manager=n,d(this,"_class",void 0),d(this,"uuid",He()),d(this,"enabled",!0),d(this,"scopes",[]),d(this,"eventManager",void 0),this.eventManager=n.eventManager}return J(a,[{key:"setEnabled",value:function(n){this.enabled=n}},{key:"isEnabled",value:function(){return this.enabled}},{key:"toggleEnabled",value:function(){this.enabled=!this.enabled}},{key:"addScope",value:function(n){var i={};Nn(this.scopes,function(t){i[t]=!0}),Nn(n?n.split(/\s+/):[],function(t){i[t]=!0}),this.scopes.length=0;for(var e in i)this.scopes.push(e)}},{key:"removeScope",value:function(n){var i={};Nn(this.scopes,function(t){i[t]=!0}),Nn(n?n.split(/\s+/):[],function(t){delete i[t]}),this.scopes.length=0;for(var e in i)this.scopes.push(e)}},{key:"toggleScope",value:function(n){var i={};Nn(this.scopes,function(t){i[t]=!0}),Nn(n?n.split(/\s+/):[],function(t){i[t]?delete i[t]:i[t]=!0}),this.scopes.length=0;for(var e in i)this.scopes.push(e)}}]),a}();function $h(a){return{w:a.parentNode.offsetWidth+a.parentNode.scrollLeft,h:a.parentNode.offsetHeight+a.parentNode.scrollTop}}var Fr;(function(a){a.notNegative="notNegative",a.parent="parent",a.parentEnclosed="parentEnclosed"})(Fr||(Fr={}));var Wh=function(a){be(n,a);var o=xe(n);function n(i,e,t){var r;if(X(this,n),r=o.call(this,i,t),d(m(r),"_class",void 0),d(m(r),"rightButtonCanDrag",void 0),d(m(r),"consumeStartEvent",void 0),d(m(r),"clone",void 0),d(m(r),"scroll",void 0),d(m(r),"trackScroll",void 0),d(m(r),"_downAt",void 0),d(m(r),"_posAtDown",void 0),d(m(r),"_pagePosAtDown",void 0),d(m(r),"_pageDelta",{x:0,y:0}),d(m(r),"_moving",void 0),d(m(r),"_lastPosition",void 0),d(m(r),"_lastScrollValues",{x:0,y:0}),d(m(r),"_initialScroll",{x:0,y:0}),d(m(r),"_size",void 0),d(m(r),"_currentParentPosition",void 0),d(m(r),"_ghostParentPosition",void 0),d(m(r),"_dragEl",void 0),d(m(r),"_multipleDrop",void 0),d(m(r),"_ghostProxyOffsets",void 0),d(m(r),"_ghostDx",void 0),d(m(r),"_ghostDy",void 0),d(m(r),"_isConstrained",!1),d(m(r),"_ghostProxyParent",void 0),d(m(r),"_useGhostProxy",void 0),d(m(r),"_ghostProxyFunction",void 0),d(m(r),"_activeSelectorParams",void 0),d(m(r),"_availableSelectors",[]),d(m(r),"_canDrag",void 0),d(m(r),"_consumeFilteredEvents",void 0),d(m(r),"_parent",void 0),d(m(r),"_ignoreZoom",void 0),d(m(r),"_filters",{}),d(m(r),"_constrainRect",void 0),d(m(r),"_elementToDrag",void 0),d(m(r),"downListener",void 0),d(m(r),"moveListener",void 0),d(m(r),"upListener",void 0),d(m(r),"scrollTracker",void 0),d(m(r),"listeners",{start:[],drag:[],stop:[],over:[],out:[],beforeStart:[],revert:[]}),r._class=r.manager.css.draggable,gn(r.el,r._class),r.downListener=r._downListener.bind(m(r)),r.upListener=r._upListener.bind(m(r)),r.moveListener=r._moveListener.bind(m(r)),r.rightButtonCanDrag=e.rightButtonCanDrag===!0,r.consumeStartEvent=e.consumeStartEvent!==!1,r._dragEl=r.el,r.clone=e.clone===!0,r.scroll=e.scroll===!0,r.trackScroll=e.trackScroll!==!1,r._multipleDrop=e.multipleDrop!==!1,r._canDrag=e.canDrag||Co,r._consumeFilteredEvents=e.consumeFilteredEvents,r._parent=e.parent,r._ignoreZoom=e.ignoreZoom===!0,r._ghostProxyParent=e.ghostProxyParent,r.trackScroll&&(r.scrollTracker=r._trackScroll.bind(m(r)),document.addEventListener("scroll",r.scrollTracker)),e.ghostProxy===!0?r._useGhostProxy=Co:e.ghostProxy&&typeof e.ghostProxy=="function"?r._useGhostProxy=e.ghostProxy:r._useGhostProxy=function(l,u){return r._activeSelectorParams&&r._activeSelectorParams.useGhostProxy?r._activeSelectorParams.useGhostProxy(l,u):!1},e.makeGhostProxy?r._ghostProxyFunction=e.makeGhostProxy:r._ghostProxyFunction=function(l){return r._activeSelectorParams&&r._activeSelectorParams.makeGhostProxy?r._activeSelectorParams.makeGhostProxy(l):l.cloneNode(!0)},e.selector){var s=r.el.getAttribute(eu);s==null&&(s=""+new Date().getTime(),r.el.setAttribute("katavorio-draggable",s)),r._availableSelectors.push(e)}return r.eventManager.on(r.el,ue,r.downListener),r}return J(n,[{key:"_trackScroll",value:function(e){if(this._moving){var t={x:document.documentElement.scrollLeft,y:document.documentElement.scrollTop},r=t.x-this._lastScrollValues.x,s=t.y-this._lastScrollValues.y,l={x:r+this._lastPosition.x,y:s+this._lastPosition.y},u=l.x-this._downAt.x,c=l.y-this._downAt.y,f=this._ignoreZoom?1:this.manager.getZoom();this._dragEl&&this._dragEl.parentNode&&(u+=this._dragEl.parentNode.scrollLeft-this._initialScroll.x,c+=this._dragEl.parentNode.scrollTop-this._initialScroll.y),u/=f,c/=f,this.moveBy(u,c,e),this._lastPosition=l,this._lastScrollValues=t}}},{key:"on",value:function(e,t){this.listeners[e]&&this.listeners[e].push(t)}},{key:"off",value:function(e,t){if(this.listeners[e]){for(var r=[],s=0;s<this.listeners[e].length;s++)this.listeners[e][s]!==t&&r.push(this.listeners[e][s]);this.listeners[e]=r}}},{key:"_upListener",value:function(e){this._downAt&&(this._downAt=null,this.eventManager.off(document,Ve,this.moveListener),this.eventManager.off(document,ce,this.upListener),Ro(document.body,Dr.noSelect),this.unmark(e),this.stop(e),this._moving=!1,this.clone?(this._dragEl&&this._dragEl.parentNode&&this._dragEl.parentNode.removeChild(this._dragEl),this._dragEl=null):this._activeSelectorParams&&this._activeSelectorParams.revertFunction&&this._activeSelectorParams.revertFunction(this._dragEl,this.manager.getPosition(this._dragEl))===!0&&(this.manager.setPosition(this._dragEl,this._posAtDown),this._dispatch(Bi,this._dragEl)))}},{key:"_downListener",value:function(e){if(!e.defaultPrevented){var t=this.rightButtonCanDrag||e.which!==3&&e.button!==2;if(t&&this.isEnabled()&&this._canDrag()){var r=this._testFilter(e)&&Yh(e,this.el,this.manager);if(r){this._activeSelectorParams=null,this._elementToDrag=null,this._availableSelectors.length===0&&console.log("JSPLUMB: no available drag selectors");var s=e.target||e.srcElement,l=Nh(this._availableSelectors,this.el,s);if(l!=null&&(this._activeSelectorParams=l[0],this._elementToDrag=l[1]),this._activeSelectorParams==null||this._elementToDrag==null)return;var u=this._activeSelectorParams.dragInit?this._activeSelectorParams.dragInit(this._elementToDrag,e):null;if(u!=null&&(this._elementToDrag=u),this.clone)if(this._dragEl=this._elementToDrag.cloneNode(!0),gn(this._dragEl,Dr.clonedDrag),this._dragEl.setAttribute("id",null),this._dragEl.style.position="absolute",this._parent!=null){var c=this.manager.getPosition(this.el);this._dragEl.style.left=c.x+"px",this._dragEl.style.top=c.y+"px",this._parent.appendChild(this._dragEl)}else{var f=Xn(this._elementToDrag);this._dragEl.style.left=f.x+"px",this._dragEl.style.top=f.y+"px",document.body.appendChild(this._dragEl)}else this._dragEl=this._elementToDrag;this.consumeStartEvent&&Ur(e),this._downAt=Vi(e),this._dragEl&&this._dragEl.parentNode&&(this._initialScroll={x:this._dragEl.parentNode.scrollLeft,y:this._dragEl.parentNode.scrollTop}),this._posAtDown=this.manager.getPosition(this._dragEl),this._pagePosAtDown=Xn(this._dragEl),this._pageDelta={x:this._pagePosAtDown.x-this._posAtDown.x,y:this._pagePosAtDown.y-this._posAtDown.y},this._size=this.manager.getSize(this._dragEl),this.eventManager.on(document,Ve,this.moveListener),this.eventManager.on(document,ce,this.upListener),gn(document.body,Dr.noSelect),this._dispatch(Jl,{el:this.el,pos:this._posAtDown,e,drag:this,size:this._size})}else this._consumeFilteredEvents&&Ur(e)}}}},{key:"_moveListener",value:function(e){if(this._downAt){if(!this._moving){var t=this._dispatch(Zl,{el:this.el,pos:this._posAtDown,e,drag:this,size:this._size});if(t!==!1){if(!this._downAt)return;this.mark(t),this._moving=!0}else this.abort()}if(this._downAt){var r=Vi(e),s=r.x-this._downAt.x,l=r.y-this._downAt.y,u=this._ignoreZoom?1:this.manager.getZoom();this._lastPosition={x:r.x,y:r.y},this._lastScrollValues={x:document.documentElement.scrollLeft,y:document.documentElement.scrollTop},this._dragEl&&this._dragEl.parentNode&&(s+=this._dragEl.parentNode.scrollLeft-this._initialScroll.x,l+=this._dragEl.parentNode.scrollTop-this._initialScroll.y),s/=u,l/=u,this.moveBy(s,l,e)}}}},{key:"getDragDelta",value:function(){return this._posAtDown!=null&&this._downAt!=null?{x:this._downAt.x-this._posAtDown.x,y:this._downAt.y-this._posAtDown.y}:{x:0,y:0}}},{key:"mark",value:function(e){this._posAtDown=this.manager.getPosition(this._dragEl),this._pagePosAtDown=Xn(this._dragEl),this._pageDelta={x:this._pagePosAtDown.x-this._posAtDown.x,y:this._pagePosAtDown.y-this._posAtDown.y},this._size=this.manager.getSize(this._dragEl),gn(this._dragEl,this.manager.css.drag),this._constrainRect=$h(this._dragEl),this._ghostDx=0,this._ghostDy=0}},{key:"unmark",value:function(e){this._isConstrained&&this._useGhostProxy(this._elementToDrag,this._dragEl)?(this._ghostProxyOffsets={x:this._dragEl.offsetLeft-this._ghostDx,y:this._dragEl.offsetTop-this._ghostDy},this._dragEl.parentNode.removeChild(this._dragEl),this._dragEl=this._elementToDrag):this._ghostProxyOffsets=null,Ro(this._dragEl,this.manager.css.drag),this._isConstrained=!1}},{key:"moveBy",value:function(e,t,r){var s=this.toGrid({x:this._posAtDown.x+e,y:this._posAtDown.y+t}),l=this._doConstrain(s,this._dragEl,this._constrainRect,this._size,r);if(l!=null){if(this._useGhostProxy(this.el,this._dragEl))if(s.x!==l.x||s.y!==l.y){if(!this._isConstrained){var u=this._ghostProxyFunction(this._elementToDrag);gn(u,Dr.ghostProxy),this._ghostProxyParent?(this._ghostProxyParent.appendChild(u),this._currentParentPosition=Xn(this._elementToDrag.parentNode),this._ghostParentPosition=Xn(this._ghostProxyParent),this._ghostDx=this._currentParentPosition.x-this._ghostParentPosition.x,this._ghostDy=this._currentParentPosition.y-this._ghostParentPosition.y):this._elementToDrag.parentNode.appendChild(u),this._dragEl=u,this._isConstrained=!0}l=s}else this._isConstrained&&(this._dragEl.parentNode.removeChild(this._dragEl),this._dragEl=this._elementToDrag,this._isConstrained=!1,this._currentParentPosition=null,this._ghostParentPosition=null,this._ghostDx=0,this._ghostDy=0);this.manager.setPosition(this._dragEl,{x:l.x+this._ghostDx,y:l.y+this._ghostDy}),this._dispatch(Ql,{el:this.el,pos:l,e:r,drag:this,size:this._size,originalPos:this._posAtDown})}}},{key:"abort",value:function(){this._downAt!=null&&this._upListener()}},{key:"getDragElement",value:function(e){return e?this._elementToDrag||this.el:this._dragEl||this.el}},{key:"stop",value:function(e,t){if(t||this._moving){var r=[],s=this.manager.getPosition(this._dragEl);r.push([this._dragEl,s,this,this._size]),this._dispatch(ql,{el:this._dragEl,pos:this._ghostProxyOffsets||s,finalPos:s,e,drag:this,selection:r,size:this._size,originalPos:{x:this._posAtDown.x,y:this._posAtDown.y}})}else this._moving||this._activeSelectorParams.dragAbort&&this._activeSelectorParams.dragAbort(this._elementToDrag)}},{key:"_dispatch",value:function(e,t){var r=null;if(this._activeSelectorParams&&this._activeSelectorParams[e])r=this._activeSelectorParams[e](t);else if(this.listeners[e])for(var s=0;s<this.listeners[e].length;s++)try{var l=this.listeners[e][s](t);l!=null&&(r=l)}catch{}return r}},{key:"resolveGrid",value:function(){var e={grid:null,thresholdX:Bh/2,thresholdY:Uh/2};return this._activeSelectorParams!=null&&this._activeSelectorParams.grid!=null&&(e.grid=this._activeSelectorParams.grid,this._activeSelectorParams.snapThreshold!=null&&(e.thresholdX=this._activeSelectorParams.snapThreshold,e.thresholdY=this._activeSelectorParams.snapThreshold)),e}},{key:"toGrid",value:function(e){var t=this.resolveGrid(),r=t.grid,s=t.thresholdX,l=t.thresholdY;if(r==null)return e;var u=r?r.w/2:s,c=r?r.h/2:l;return wh(e,r,u,c)}},{key:"setUseGhostProxy",value:function(e){this._useGhostProxy=e?Co:Hh}},{key:"_doConstrain",value:function(e,t,r,s,l){return this._activeSelectorParams!=null&&this._activeSelectorParams.constrainFunction&&typeof this._activeSelectorParams.constrainFunction=="function"?this._activeSelectorParams.constrainFunction(e,t,r,s,l):e}},{key:"_testFilter",value:function(e){for(var t in this._filters){var r=this._filters[t],s=r[0](e);if(r[1]&&(s=!s),!s)return!1}return!0}},{key:"addFilter",value:function(e,t){var r=this;if(e){var s=Lh(e);this._filters[s]=[function(l){var u=l.srcElement||l.target,c;return Ne(e)?c=Cn(u,e,r.el):typeof e=="function"&&(c=e(l,r.el)),c},t!==!1]}}},{key:"removeFilter",value:function(e){var t=typeof e=="function"?e._katavorioId:e;delete this._filters[t]}},{key:"clearAllFilters",value:function(){this._filters={}}},{key:"addSelector",value:function(e,t){e.selector&&(t?this._availableSelectors.unshift(e):this._availableSelectors.push(e))}},{key:"destroy",value:function(){this.eventManager.off(this.el,ue,this.downListener),this.eventManager.off(document,Ve,this.moveListener),this.eventManager.off(document,ce,this.upListener),this.downListener=null,this.upListener=null,this.moveListener=null,this.scrollTracker!=null&&document.removeEventListener("scroll",this.scrollTracker)}}]),n}(Xh),Kh=["input","textarea","select","button","option"],zh=Kh.join(","),Zh=function(){function a(o){X(this,a),d(this,"eventManager",void 0),d(this,"zoom",1),d(this,"css",{}),d(this,"inputFilterSelector",void 0),d(this,"positioningStrategy",void 0),d(this,"_positionSetter",void 0),d(this,"_positionGetter",void 0),d(this,"_sizeSetter",void 0),d(this,"_sizeGetter",void 0),o=o||{},this.inputFilterSelector=o.inputFilterSelector||zh,this.eventManager=new xa,this.zoom=o.zoom||1,this.positioningStrategy=o.positioningStrategy||Pt.absolutePosition,this._positionGetter=Pa.get(this.positioningStrategy),this._positionSetter=Ca.get(this.positioningStrategy),this._sizeGetter=Oa.get(this.positioningStrategy),this._sizeSetter=Ta.get(this.positioningStrategy);var n=o.css||{};W(this.css,n)}return J(a,[{key:"getPosition",value:function(n){return this._positionGetter(n)}},{key:"setPosition",value:function(n,i){this._positionSetter(n,i)}},{key:"getSize",value:function(n){return this._sizeGetter(n)}},{key:"getZoom",value:function(){return this.zoom}},{key:"setZoom",value:function(n){this.zoom=n}},{key:"_prepareParams",value:function(n){n=n||{};var i={events:{}},e;for(e in n)i[e]=n[e];for(e=0;e<Po.length;e++)i.events[Po[e]]=n[Po[e]]||Vh;return i}},{key:"getInputFilterSelector",value:function(){return this.inputFilterSelector}},{key:"setInputFilterSelector",value:function(n){return this.inputFilterSelector=n,this}},{key:"draggable",value:function(n,i){if(n._katavorioDrag==null){var e=this._prepareParams(i),t=new Wh(n,e,this);return gn(n,Dr.delegatedDraggable),n._katavorioDrag=t,t}else return n._katavorioDrag}},{key:"destroyDraggable",value:function(n){n._katavorioDrag&&(n._katavorioDrag.destroy(),delete n._katavorioDrag)}}]),a}(),Ii="jtk-drag-selected",Jh=function(){function a(o){X(this,a),this.instance=o,d(this,"_dragSelection",[]),d(this,"_dragSizes",new Map),d(this,"_dragElements",new Map),d(this,"_dragElementStartPositions",new Map),d(this,"_dragElementPositions",new Map),d(this,"__activeSet",void 0)}return J(a,[{key:"_activeSet",get:function(){return this.__activeSet==null?this._dragSelection:this.__activeSet}},{key:"length",get:function(){return this._dragSelection.length}},{key:"filterActiveSet",value:function(n){var i=this;this.__activeSet=[],K(this._dragSelection,function(e){n(e)&&i.__activeSet.push(e)})}},{key:"clear",value:function(){var n=this;this.reset(),K(this._dragSelection,function(i){return n.instance.removeClass(i.jel,Ii)}),this._dragSelection.length=0}},{key:"reset",value:function(){this._dragElementStartPositions.clear(),this._dragElementPositions.clear(),this._dragSizes.clear(),this._dragElements.clear(),this.__activeSet=null}},{key:"initialisePositions",value:function(){var n=this;K(this._activeSet,function(i){var e=n.instance.viewport.getPosition(i.id),t={x:parseInt(""+i.jel.offsetLeft,10),y:parseInt(""+i.jel.offsetTop,10)};n._dragElementStartPositions.set(i.id,t),n._dragElementPositions.set(i.id,t),n._dragSizes.set(i.id,{w:e.w,h:e.h})})}},{key:"updatePositions",value:function(n,i,e){var t=this,r=n.x-i.x,s=n.y-i.y;K(this._activeSet,function(l){var u=t._dragElementStartPositions.get(l.id);if(u){var c=u.x+r,f=u.y+s,h=t._dragSizes.get(l.id),v={x:c,y:f,w:h.w,h:h.h};if(l.jel._jsPlumbParentGroup&&l.jel._jsPlumbParentGroup.constrain){var p={w:l.jel.parentNode.offsetWidth+l.jel.parentNode.scrollLeft,h:l.jel.parentNode.offsetHeight+l.jel.parentNode.scrollTop};v.x=Math.max(v.x,0),v.y=Math.max(v.y,0),v.x=Math.min(v.x,p.w-h.w),v.y=Math.min(v.y,p.h-h.h)}t._dragElementPositions.set(l.id,{x:c,y:f}),l.jel.style.left=v.x+"px",l.jel.style.top=v.y+"px",e(l.jel,l.id,h,v)}})}},{key:"each",value:function(n){var i=this;K(this._activeSet,function(e){var t=i._dragSizes.get(e.id),r=i._dragElementPositions.get(e.id),s=i._dragElementStartPositions.get(e.id);n(e.jel,e.id,r,t,s)})}},{key:"add",value:function(n,i){var e=n;i=i||this.instance.getId(e);var t=rn(this._dragSelection,function(r){return r.id===i});t===-1&&(this.instance.addClass(n,Ii),this._dragSelection.push({id:i,jel:e}))}},{key:"remove",value:function(n){var i=this,e=n;this._dragSelection=this._dragSelection.filter(function(t){var r=t.jel!==e;return r||i.instance.removeClass(t.jel,Ii),r})}},{key:"toggle",value:function(n){var i=n,e=rn(this._dragSelection,function(t){return t.jel===i});e!==-1?this.remove(i):this.add(n)}}]),a}(),Qh="jtk-delegated-draggable",qh="jtk-draggable",ed="jtk-drag",td="jtk-ghost-proxy",en="jtk-drag-active",nd="jtk-dragged",tn="jtk-drag-hover",rd=function(){function a(o,n,i){var e=this;X(this,a),this.instance=o,this.dragSelection=n,d(this,"collicat",void 0),d(this,"drag",void 0),d(this,"_draggables",{}),d(this,"_dlist",[]),d(this,"_elementsWithEndpoints",{}),d(this,"_draggablesForElements",{}),d(this,"handlers",[]),d(this,"_trackScroll",void 0),d(this,"_filtersToAdd",[]),this.collicat=new Zh({zoom:this.instance.currentZoom,css:{noSelect:this.instance.dragSelectClass,delegatedDraggable:Qh,draggable:qh,drag:ed,selected:Ii,active:en,hover:tn,ghostProxy:td}}),this.instance.bind(jl,function(t){e.collicat.setZoom(t)}),i=i||{},this._trackScroll=i.trackScroll!==!1}return J(a,[{key:"addHandler",value:function(n,i){var e=this,t=W({selector:n.selector},i||{});t.start=ui(t.start,function(l){return n.onStart(l)},!1),t.drag=ui(t.drag,function(l){return n.onDrag(l)}),t.stop=ui(t.stop,function(l){return n.onStop(l)});var r=(n.onBeforeStart||function(l){}).bind(n);if(t.beforeStart=ui(t.beforeStart,function(l){return r(l)}),t.dragInit=function(l,u){return n.onDragInit(l,u)},t.dragAbort=function(l){return n.onDragAbort(l)},n.useGhostProxy&&(t.useGhostProxy=n.useGhostProxy,t.makeGhostProxy=n.makeGhostProxy),t.constrainFunction==null&&t.containment!=null)switch(t.containment){case Fr.notNegative:{t.constrainFunction=function(l,u,c,f){return{x:Math.max(0,Math.min(l.x)),y:Math.max(0,Math.min(l.y))}};break}case Fr.parent:{var s=t.containmentPadding||5;t.constrainFunction=function(l,u,c,f){var h=l.x<0?0:l.x>c.w-s?c.w-s:l.x,v=l.y<0?0:l.y>c.h-s?c.h-s:l.y;return{x:h,y:v}};break}case Fr.parentEnclosed:{t.constrainFunction=function(l,u,c,f){var h=l.x<0?0:l.x+f.w>c.w?c.w-f.w:l.x,v=l.y<0?0:l.y+f.h>c.h?c.h-f.h:l.y;return{x:h,y:v}};break}}this.drag==null?(t.trackScroll=this._trackScroll,this.drag=this.collicat.draggable(this.instance.getContainer(),t),K(this._filtersToAdd,function(l){return e.drag.addFilter(l[0],l[1])}),this.drag.on(Bi,function(l){e.instance.revalidate(l)})):this.drag.addSelector(t),this.handlers.push({handler:n,options:t}),n.init(this.drag)}},{key:"addSelector",value:function(n,i){this.drag&&this.drag.addSelector(n,i)}},{key:"addFilter",value:function(n,i){this.drag==null?this._filtersToAdd.push([n,i===!0]):this.drag.addFilter(n,i)}},{key:"removeFilter",value:function(n){this.drag!=null&&this.drag.removeFilter(n)}},{key:"setFilters",value:function(n){var i=this;K(n,function(e){i.drag.addFilter(e[0],e[1])})}},{key:"reset",value:function(){var n=[];if(K(this.handlers,function(t){t.handler.reset()}),this.handlers.length=0,this.drag!=null){var i=this.drag._filters;for(var e in i)n.push([e,i[e][1]]);this.collicat.destroyDraggable(this.instance.getContainer())}return delete this.drag,n}},{key:"setOption",value:function(n,i){var e=ua(this.handlers,function(t){return t.handler===n});e!=null&&W(e.options,i||{})}}]),a}();function id(a,o){return Ne(o)?{id:o,active:!0}:{id:o.id,active:o.active}}function od(a,o){var n=xl(a.members,function(i){return i.el===o});return n!==null?n.active===!0:!1}function ad(a){for(var o=[],n=a._jsPlumbParentGroup;n!=null;)o.push(n.el),n=n.group;return o}var Yo=function(){function a(o,n){X(this,a),this.instance=o,this._dragSelection=n,d(this,"selector","> "+Ae+":not("+Tn(ro)+")"),d(this,"_dragOffset",null),d(this,"_groupLocations",[]),d(this,"_intersectingGroups",[]),d(this,"_currentDragParentGroup",null),d(this,"_dragGroupByElementIdMap",{}),d(this,"_dragGroupMap",{}),d(this,"_currentDragGroup",null),d(this,"_currentDragGroupOffsets",new Map),d(this,"_currentDragGroupSizes",new Map),d(this,"_currentDragGroupOriginalPositions",new Map),d(this,"_dragPayload",null),d(this,"drag",void 0),d(this,"originalPosition",void 0)}return J(a,[{key:"onDragInit",value:function(n){return null}},{key:"onDragAbort",value:function(n){return null}},{key:"getDropGroup",value:function(){var n=null;if(this._intersectingGroups.length>0){var i=this._intersectingGroups[0].groupLoc.group,e=this._intersectingGroups[0].intersectingElement,t=e._jsPlumbParentGroup;t!==i&&(t==null||!t.overrideDrop(e,i))&&(n=this._intersectingGroups[0])}return n}},{key:"onStop",value:function(n){var i,e=this,t=n.drag.getDragElement(),r=this.getDropGroup(),s=[];s.push({el:t,id:this.instance.getId(t),pos:n.finalPos,originalGroup:t._jsPlumbParentGroup,redrawResult:null,originalPos:n.originalPos,reverted:!1,dropGroup:r!=null?r.groupLoc.group:null});function l(p,y,g,E,b){var x=g.x,S=g.y;if(p._jsPlumbParentGroup&&p._jsPlumbParentGroup.constrain){var C={w:p.parentNode.offsetWidth+p.parentNode.scrollLeft,h:p.parentNode.offsetHeight+p.parentNode.scrollTop};x=Math.max(x,0),S=Math.max(S,0),x=Math.min(x,C.w-E.w),S=Math.min(S,C.h-E.h),g.x=x,g.y=S}s.push({el:p,id:y,pos:g,originalPos:b,originalGroup:p._jsPlumbParentGroup,redrawResult:null,reverted:!1,dropGroup:r==null?void 0:r.groupLoc.group})}if(this._dragSelection.each(function(p,y,g,E,b){p!==n.el&&l(p,y,{x:g.x,y:g.y},E,b)}),(i=this._currentDragGroup)===null||i===void 0||i.members.forEach(function(p){if(p.el!==n.el){var y=e._currentDragGroupOffsets.get(p.elId),g=e._currentDragGroupSizes.get(p.elId),E={x:n.finalPos.x+y[0].x,y:n.finalPos.y+y[0].y};l(p.el,p.elId,E,g,e._currentDragGroupOriginalPositions.get(p.elId))}}),K(s,function(p){var y=p.originalGroup!=null,g=y&&us(e.instance,p.el,p.pos),E={x:0,y:0};if(y&&!g){if(r==null){var b=e._pruneOrOrphan(p,!0,!0);b.pos!=null?p.pos=b.pos.pos:!b.pruned&&p.originalGroup.revert&&(p.pos=p.originalPos,p.reverted=!0)}}else y&&g&&(E=e._computeOffsetByParentGroup(p.originalGroup));r!=null&&!g?e.instance.groupManager.addToGroup(r.groupLoc.group,!1,p.el):p.dropGroup=null,p.reverted&&e.instance.setPosition(p.el,p.pos),p.redrawResult=e.instance.setElementPosition(p.el,p.pos.x+E.x,p.pos.y+E.y),e.instance.removeClass(p.el,nd),e.instance.select({source:p.el}).removeClass(e.instance.elementDraggingClass+" "+e.instance.sourceElementDraggingClass,!0),e.instance.select({target:p.el}).removeClass(e.instance.elementDraggingClass+" "+e.instance.targetElementDraggingClass,!0)}),s[0].originalGroup!=null){var u=t._jsPlumbParentGroup;if(u!==s[0].originalGroup){var c=n.drag.getDragElement(!0);if(s[0].originalGroup.ghost){var f=this.instance.getPosition(this.instance.getGroupContentArea(u)),h=this.instance.getPosition(this.instance.getGroupContentArea(s[0].originalGroup)),v={x:h.x+n.pos.x-f.x,y:h.y+n.pos.y-f.y};c.style.left=v.x+"px",c.style.top=v.y+"px",this.instance.revalidate(c)}}}this.instance.fire(Rf,{elements:s,e:n.e,el:t,payload:this._dragPayload}),this._cleanup()}},{key:"_cleanup",value:function(){var n=this;K(this._groupLocations,function(i){n.instance.removeClass(i.el,en),n.instance.removeClass(i.el,tn)}),this._currentDragParentGroup=null,this._groupLocations.length=0,this.instance.hoverSuspended=!1,this._dragOffset=null,this._dragSelection.reset(),this._dragPayload=null,this._currentDragGroupOffsets.clear(),this._currentDragGroupSizes.clear(),this._currentDragGroupOriginalPositions.clear(),this._currentDragGroup=null}},{key:"reset",value:function(){}},{key:"init",value:function(n){this.drag=n}},{key:"onDrag",value:function(n){var i=this,e=n.drag.getDragElement(),t=this.instance.getId(e),r=n.pos,s=this.instance.viewport.getPosition(t),l={x:r.x,y:r.y};this._intersectingGroups.length=0,this._dragOffset!=null&&(l.x+=this._dragOffset.x,l.y+=this._dragOffset.y);var u=function(h,v,p){if(p){var y=new Set;K(i._groupLocations,function(g){!y.has(g.group.id)&&zl(v,g.r)?(g.group!==i._currentDragParentGroup&&i.instance.addClass(g.el,tn),i._intersectingGroups.push({groupLoc:g,intersectingElement:n.drag.getDragElement(!0),d:0}),K(i.instance.groupManager.getAncestors(g.group),function(E){return y.add(E.id)})):i.instance.removeClass(g.el,tn)})}i.instance.setElementPosition(h,v.x,v.y),i.instance.fire(Nf,{el:h,e:n.e,pos:{x:v.x,y:v.y},originalPosition:i.originalPosition,payload:i._dragPayload})},c={x:l.x,y:l.y,w:s.w,h:s.h};u(e,c,!0),this._dragSelection.updatePositions(r,this.originalPosition,function(f,h,v,p){u(f,p,!1)}),this._currentDragGroupOffsets.forEach(function(f,h){var v=i._currentDragGroupSizes.get(h),p={x:c.x+f[0].x,y:c.y+f[0].y,w:v.w,h:v.h};f[1].style.left=p.x+"px",f[1].style.top=p.y+"px",u(f[1],p,!1)})}},{key:"_computeOffsetByParentGroup",value:function(n){var i=this.instance.getPosition(n.el),e=n.contentArea;if(e!==n.el){var t=this.instance.getPosition(e);i.x+=t.x,i.y+=t.y}if(n.el._jsPlumbParentGroup){var r=this._computeOffsetByParentGroup(n.el._jsPlumbParentGroup);i.x+=r.x,i.y+=r.y}return i}},{key:"onStart",value:function(n){var i=this,e=n.drag.getDragElement(),t=this.instance.getPosition(e);this.originalPosition={x:n.pos.x,y:n.pos.y},e._jsPlumbParentGroup&&(this._dragOffset=this._computeOffsetByParentGroup(e._jsPlumbParentGroup),this._currentDragParentGroup=e._jsPlumbParentGroup);var r=!0,s=e.getAttribute(Oi);if((this.instance.elementsDraggable===!1||s!=null&&s!==Wn)&&(r=!1),r){this._groupLocations.length=0,this._intersectingGroups.length=0,this.instance.hoverSuspended=!0;var l=n.drag.getDragElement(!0),u=l.querySelectorAll(Ae),c=ad(l),f=[];Array.prototype.push.apply(f,u),Array.prototype.push.apply(f,c),this._dragSelection.filterActiveSet(function(y){return f.indexOf(y.jel)===-1}),this._dragSelection.initialisePositions();var h=function(g,E,b){if(!g._isJsPlumbGroup||i.instance.allowNestedGroups){var x=!g._jsPlumbParentGroup,S=x||g._jsPlumbParentGroup.dropOverride!==!0,C=!x&&(g._jsPlumbParentGroup.ghost||g._jsPlumbParentGroup.constrain!==!0);(x||S&&C)&&(K(i.instance.groupManager.getGroups(),function(T){var O=g._jsPlumbGroup;if(T.droppable!==!1&&T.enabled!==!1&&g._jsPlumbGroup!==T&&!i.instance.groupManager.isDescendant(T,O)){var P=T.el,D=i.instance.getId(P),I=i.instance.viewport.getPosition(D),G={x:I.x,y:I.y,w:I.w,h:I.h},w={el:P,r:G,group:T};i._groupLocations.push(w),T!==i._currentDragParentGroup&&i.instance.addClass(P,en)}}),i._groupLocations.sort(function(T,O){return i.instance.groupManager.isDescendant(T.group,O.group)?-1:i.instance.groupManager.isAncestor(O.group,T.group)?1:0}))}return i.instance.select({source:g}).addClass(i.instance.elementDraggingClass+" "+i.instance.sourceElementDraggingClass,!0),i.instance.select({target:g}).addClass(i.instance.elementDraggingClass+" "+i.instance.targetElementDraggingClass,!0),i.instance.fire(Gf,{el:g,e:n.e,originalPosition:i.originalPosition,pos:i.originalPosition,dragGroup:E,dragGroupMemberSpec:b})},v=this.instance.getId(e);this._currentDragGroup=this._dragGroupByElementIdMap[v],this._currentDragGroup&&!od(this._currentDragGroup,e)&&(this._currentDragGroup=null);var p=h(e);if(p===!1)return this._cleanup(),!1;this._dragPayload=p,this._currentDragGroup!=null&&(this._currentDragGroupOffsets.clear(),this._currentDragGroupSizes.clear(),this._currentDragGroup.members.forEach(function(y){var g=i.instance.viewport.getPosition(y.elId);i._currentDragGroupOffsets.set(y.elId,[{x:g.x-t.x,y:g.y-t.y},y.el]),i._currentDragGroupSizes.set(y.elId,g),i._currentDragGroupOriginalPositions.set(y.elId,{x:g.x,y:g.y}),h(y.el,i._currentDragGroup,y)}))}return r}},{key:"addToDragGroup",value:function(n){var i=this,e=id(this.instance,n),t=this._dragGroupMap[e.id];t==null&&(t={id:e.id,members:new Set},this._dragGroupMap[e.id]=t);for(var r=arguments.length,s=new Array(r>1?r-1:0),l=1;l<r;l++)s[l-1]=arguments[l];this.removeFromDragGroup.apply(this,s),K(s,function(u){var c=i.instance.getId(u);t.members.add({elId:c,el:u,active:e.active}),i._dragGroupByElementIdMap[c]=t})}},{key:"removeFromDragGroup",value:function(){for(var n=this,i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];K(e,function(r){var s=n.instance.getId(r),l=n._dragGroupByElementIdMap[s];if(l!=null){var u=new Set;l.members.forEach(function(c){c.el!==r&&u.add(c)}),l.members=u,delete n._dragGroupByElementIdMap[s]}})}},{key:"setDragGroupState",value:function(n){for(var i=this,e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];var s=t.map(function(l){return i.instance.getId(l)});K(s,function(l){var u=i._dragGroupByElementIdMap[l];if(u!=null){var c=xl(u.members,function(f){return f.elId===l});c!=null&&(c.active=n)}})}},{key:"clearDragGroup",value:function(n){var i=this,e=this._dragGroupMap[n];e!=null&&(e.members.forEach(function(t){delete i._dragGroupByElementIdMap[t.elId]}),e.members.clear())}},{key:"_pruneOrOrphan",value:function(n,i,e){var t=n.el,r={pruned:!1,pos:null};if(e||!us(this.instance,t,n.pos)){var s=t._jsPlumbParentGroup;s.prune?(t._isJsPlumbGroup?this.instance.removeGroup(t._jsPlumbGroup):s.remove(n.el,!0),r.pruned=!0):s.orphan&&(r.pos=this.instance.groupManager.orphan(n.el,i),t._isJsPlumbGroup?s.removeGroup(t._jsPlumbGroup):s.remove(n.el))}return r}}]),a}(),cs={},fs={},hs={},nn={get:function(o,n,i){var e=cs[n];if(e)return new e(o,i);throw{message:"jsPlumb: unknown endpoint type '"+n+"'"}},clone:function(o){var n=hs[o.type];return nn.get(o.endpoint,o.type,n.getParams(o))},compute:function(o,n,i,e){var t=fs[o.type];if(t!=null)return t(o,n,i,e);Ue("jsPlumb: cannot find endpoint calculator for endpoint of type ",o.type)},registerHandler:function(o){hs[o.type]=o,cs[o.type]=o.cls,fs[o.type]=o.compute}},ar=function(){function a(o,n){X(this,a),this.endpoint=o,d(this,"typeId",void 0),d(this,"x",void 0),d(this,"y",void 0),d(this,"w",void 0),d(this,"h",void 0),d(this,"computedValue",void 0),d(this,"bounds",Ui()),d(this,"classes",[]),d(this,"instance",void 0),d(this,"type",void 0),n=n||{},this.instance=o.instance,o.cssClass&&this.classes.push(o.cssClass),n.cssClass&&this.classes.push(n.cssClass)}return J(a,[{key:"addClass",value:function(n){this.classes.push(n),this.instance.addEndpointClass(this.endpoint,n)}},{key:"removeClass",value:function(n){this.classes=this.classes.filter(function(i){return i!==n}),this.instance.removeEndpointClass(this.endpoint,n)}},{key:"compute",value:function(n,i,e){this.computedValue=nn.compute(this,n,i,e),this.bounds.xmin=this.x,this.bounds.ymin=this.y,this.bounds.xmax=this.x+this.w,this.bounds.ymax=this.y+this.h}},{key:"setVisible",value:function(n){this.instance.setEndpointVisible(this.endpoint,n)}}]),a}(),Rn,Gn,jn,ir;(function(a){a.top="top",a.left="left",a.right="right",a.bottom="bottom"})(ir||(ir={}));var je=ir.top,Qe=ir.left,ze=ir.right,tt=ir.bottom,sd=[Qe,ze],ld=[je,tt],ud=function(){function a(o,n,i){X(this,a),this.instance=o,this.element=n,d(this,"isFloating",!0),d(this,"isContinuous",void 0),d(this,"isDynamic",void 0),d(this,"locations",[]),d(this,"currentLocation",0),d(this,"locked",!1),d(this,"cssClass",""),d(this,"timestamp",null),d(this,"type","Floating"),d(this,"id",He()),d(this,"orientation",[0,0]),d(this,"size",void 0),this.size=o.viewport.getPosition(i),this.locations.push({x:.5,y:.5,ox:this.orientation[0],oy:this.orientation[1],offx:0,offy:0,iox:this.orientation[0],ioy:this.orientation[1],cls:""})}return J(a,[{key:"_updateOrientationInRouter",value:function(){this.instance.router.setAnchorOrientation(this,[this.locations[0].ox,this.locations[0].oy])}},{key:"over",value:function(n){this.orientation=this.instance.router.getEndpointOrientation(n),this.locations[0].ox=this.orientation[0],this.locations[0].oy=this.orientation[1],this._updateOrientationInRouter()}},{key:"out",value:function(){this.orientation=null,this.locations[0].ox=this.locations[0].iox,this.locations[0].oy=this.locations[0].ioy,this._updateOrientationInRouter()}}]),a}(),ds=(Rn={},d(Rn,je,tt),d(Rn,ze,Qe),d(Rn,Qe,ze),d(Rn,tt,je),Rn),tu=(Gn={},d(Gn,je,ze),d(Gn,ze,tt),d(Gn,Qe,je),d(Gn,tt,Qe),Gn),nu=(jn={},d(jn,je,Qe),d(jn,ze,je),d(jn,Qe,tt),d(jn,tt,ze),jn);function cd(a){return a.faces.length===0?je:a.faces[0]}function _r(a,o){return a.faces.indexOf(o)!==-1}function fd(a,o){return(a.clockwise?tu:nu)[o]}function hd(a,o){return(a.clockwise?nu:tu)[o]}function vs(a,o){return a.lockedAxis==null?a.lockedFace==null?_r(a,o)===!0:a.lockedFace===o:a.lockedAxis.indexOf(o)!==-1}function dd(a,o){if(_r(a,o))return o;if(_r(a,ds[o]))return ds[o];var n=fd(a,o);if(_r(a,n))return n;var i=hd(a,o);return _r(a,i)?i:o}var ps={x:.5,y:0,ox:0,oy:-1,offx:0,offy:0},gs={x:.5,y:1,ox:0,oy:1,offx:0,offy:0},ys={x:0,y:.5,ox:-1,oy:0,offx:0,offy:0},ms={x:1,y:.5,ox:1,oy:0,offx:0,offy:0},vd={x:0,y:0,ox:0,oy:-1,offx:0,offy:0},pd={x:1,y:0,ox:1,oy:-1,offx:0,offy:0},gd={x:0,y:1,ox:0,oy:1,offx:0,offy:0},yd={x:1,y:1,ox:0,oy:1,offx:0,offy:0},md={x:.5,y:.5,ox:0,oy:0,offx:0,offy:0},ru={Top:[ps],Bottom:[gs],Left:[ys],Right:[ms],TopLeft:[vd],TopRight:[pd],BottomLeft:[gd],BottomRight:[yd],Center:[md],AutoDefault:[ps,ys,gs,ms]},Ed={Continuous:{faces:[je,Qe,tt,ze]},ContinuousTop:{faces:[je]},ContinuousRight:{faces:[ze]},ContinuousBottom:{faces:[tt]},ContinuousLeft:{faces:[Qe]},ContinuousLeftRight:{faces:[Qe,ze]},ContinuousTopBottom:{faces:[je,tt]}};function Es(a,o){if(o=o||{},a===Mt.Perimeter)return Ad(o);var n=ru[a];if(n!=null)return $i(a,Cl(n,function(i){return W({iox:i.ox,ioy:i.oy},i)}),o);if(n=Ed[a],n!=null)return Sd(a,n.faces,o);throw{message:"jsPlumb: unknown anchor type '"+a+"'"}}function $i(a,o,n){return{type:a,locations:o,currentLocation:0,locked:!1,id:He(),isFloating:!1,isContinuous:!1,isDynamic:o.length>1,timestamp:null,cssClass:n.cssClass||""}}function bd(a,o,n){return new ud(a,o,n)}var xd="currentFace";function Sd(a,o,n){var i={type:a,locations:[],currentLocation:0,locked:!1,id:He(),cssClass:n.cssClass||"",isFloating:!1,isContinuous:!0,timestamp:null,faces:n.faces||o,lockedFace:null,lockedAxis:null,clockwise:n.clockwise!==!1,__currentFace:null};return Object.defineProperty(i,xd,{get:function(){return this.__currentFace},set:function(t){this.__currentFace=dd(this,t)}}),i}function bs(a){return a.length<7&&a.every(No)||a.length===7&&a.slice(0,5).every(No)&&Ne(a[6])}function Ir(a){if(Ne(a))return Es(a,null);if(Array.isArray(a))if(bs(a)){var o=a;return $i(null,[{x:o[0],y:o[1],ox:o[2],oy:o[3],offx:o[4]==null?0:o[4],offy:o[5]==null?0:o[5],iox:o[2],ioy:o[3],cls:o[6]||""}],{cssClass:o[6]||""})}else{var n=Cl(a,function(e){if(Ne(e)){var t=ru[e];return t!=null?W({iox:t[0].ox,ioy:t[0].oy,cls:""},t[0]):null}else if(bs(e))return{x:e[0],y:e[1],ox:e[2],oy:e[3],offx:e[4]==null?0:e[4],offy:e[5]==null?0:e[5],iox:e[2],ioy:e[3],cls:e[6]||""}}).filter(function(e){return e!=null});return $i("Dynamic",n,{})}else{var i=a;return Es(i.type,i.options)}}function iu(a){for(var o=.5,n=Math.PI*2/a,i=[],e=0,t=0;t<a;t++){var r=o+o*Math.sin(e),s=o+o*Math.cos(e);i.push({x:r,y:s,ox:0,oy:0,offx:0,offy:0,iox:0,ioy:0,cls:""}),e+=n}return i}function Cd(a,o){for(var n=o/a.length,i=[],e=function(s,l,u,c,f,h,v){n=o*f;for(var p=(u-s)/n,y=(c-l)/n,g=0;g<n;g++)i.push({x:s+p*g,y:l+y*g,ox:h??0,oy:v??0,offx:0,offy:0,iox:0,ioy:0,cls:""})},t=0;t<a.length;t++)e.apply(null,a[t]);return i}function Aa(a,o){for(var n=[],i=0;i<a.length;i++)n.push([a[i][0],a[i][1],a[i][2],a[i][3],1/a.length,a[i][4],a[i][5]]);return Cd(n,o)}function ou(a){return Aa([[0,0,1,0,0,-1],[1,0,1,1,1,0],[1,1,0,1,0,1],[0,1,0,0,-1,0]],a)}function Pd(a){return Aa([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]],a)}function Td(a){return Aa([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]],a)}function Od(a,o){for(var n=[],i=o/180*Math.PI,e=0;e<a.length;e++){var t=a[e].x-.5,r=a[e].y-.5;n.push({x:.5+(t*Math.cos(i)-r*Math.sin(i)),y:.5+(t*Math.sin(i)+r*Math.cos(i)),ox:a[e].ox,oy:a[e].oy,offx:0,offy:0,iox:0,ioy:0,cls:""})}return n}var an=new Map;an.set(on.Circle,iu);an.set(on.Ellipse,iu);an.set(on.Rectangle,ou);an.set(on.Square,ou);an.set(on.Diamond,Pd);an.set(on.Triangle,Td);function Ad(a){a=a||{};var o=a.anchorCount||60,n=a.shape;if(!n)throw new Error("no shape supplied to Perimeter Anchor type");if(!an.has(n))throw new Error("Shape ["+n+"] is unknown by Perimeter Anchor type");var i=an.get(n)(o);a.rotation&&(i=Od(i,a.rotation));var e=$i(Mt.Perimeter,i,a),t=W(e,{shape:n});return t}var xs=function(){function a(o,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;X(this,a),this.selector=o,this.def=n,this.exclude=i,d(this,"id",void 0),d(this,"redrop",void 0),this.id=He(),this.redrop=n.def.redrop||au}return J(a,[{key:"setEnabled",value:function(n){this.def.enabled=n}},{key:"isEnabled",value:function(){return this.def.enabled!==!1}}]),a}(),au="strict",Dd="any",_d="anySource",Id="anyTarget",Md="anySourceOrTarget";function wd(a,o,n,i,e,t){var r=bd(t,i,e),s={paintStyle:a.getPaintStyle(),preparedAnchor:r,element:i,scope:a.scope,cssClass:[da,a.cssClass].join(" ")};o!=null&&(Pl(o,ar)?s.existingEndpoint=o:s.endpoint=o);var l=t._internal_newEndpoint(s);return t._paintEndpoint(l,{}),l}function kd(a,o,n,i,e){for(var t=a.target||a.srcElement,r=!1,s=i.getSelector(o,n),l=0;l<s.length;l++)if(s[l]===t){r=!0;break}return e?!r:r}var Ld=Tn(en,tn),Ss="sourceSelectorEndpoint",Cs=function(){function a(o){X(this,a),this.instance=o,d(this,"jpc",void 0),d(this,"existingJpc",void 0),d(this,"_originalAnchorSpec",void 0),d(this,"ep",void 0),d(this,"endpointRepresentation",void 0),d(this,"canvasElement",void 0),d(this,"_activeDefinition",void 0),d(this,"placeholderInfo",{id:null,element:null}),d(this,"floatingIndex",void 0),d(this,"floatingId",void 0),d(this,"floatingElement",void 0),d(this,"floatingEndpoint",void 0),d(this,"floatingAnchor",void 0),d(this,"_stopped",void 0),d(this,"inPlaceCopy",void 0),d(this,"endpointDropTargets",[]),d(this,"currentDropTarget",null),d(this,"payload",void 0),d(this,"floatingConnections",{}),d(this,"_forceReattach",void 0),d(this,"_forceDetach",void 0),d(this,"mousedownHandler",void 0),d(this,"mouseupHandler",void 0),d(this,"selector",Tn(Zn));var n=o.getContainer();this.mousedownHandler=this._mousedownHandler.bind(this),this.mouseupHandler=this._mouseupHandler.bind(this),o.on(n,ue,Ae,this.mousedownHandler),o.on(n,ce,[Ae,Tn(Zn)].join(","),this.mouseupHandler)}return J(a,[{key:"_resolveDragParent",value:function(n,i){var e=this.instance.getContainer(),t=Rt(i,Ae,e,!0);if(n.parentSelector!=null){var r=Rt(i,n.parentSelector,e,!0);return r!=null&&(t=Rt(r.parentNode,Ae,e,!1)),r||t}else return t}},{key:"_mousedownHandler",value:function(n){var i,e;if(!(n.which===3||n.button===2)){var t=n.target||n.srcElement;if(e=this._getSourceDefinition(n),!(e!=null&&(i=this._resolveDragParent(e.def.def,t),i==null||i.getAttribute(hi)===Wn))&&e){var r=n.currentTarget,s;if(t.getAttribute(hi)!==Wn){if(Ur(n),this._activeDefinition=e,s=e.def.def,s.canAcceptNewConnection!=null&&!s.canAcceptNewConnection(i,n))return!1;var l=Fs(n,i,this.instance.currentZoom),u={element:i};if(W(u,s),u.isTemporarySource=!0,s.scope)u.scope=s.scope;else{var c=t.getAttribute(xo);c!=null&&(u.scope=c)}var f=s.parameterExtractor?s.parameterExtractor(i,t,n):{};if(u=Gi(u,f),u.maxConnections!=null&&u.maxConnections>=0){var h=this.instance.select({source:i}).length;if(h>=u.maxConnections)return Ur(n),s.onMaxConnections&&s.onMaxConnections({element:i,maxConnections:u.maxConnections},n),n.stopImmediatePropagation&&n.stopImmediatePropagation(),!1}if(s.anchorPositionFinder){var v=s.anchorPositionFinder(i,l,s,n);v!=null&&(u.anchor=v)}this._originalAnchorSpec=u.anchor||(this.instance.areDefaultAnchorsSet()?this.instance.defaults.anchors[0]:this.instance.defaults.anchor);var p=this.instance.router.prepareAnchor(this._originalAnchorSpec),y=[l.x,l.y,0,0];if(p.locations.length>0)y[2]=p.locations[0].ox,y[3]=p.locations[0].oy;else if(p.isContinuous){var g=l.x<.5?l.x:1-l.x,E=l.y<.5?l.y:1-l.y;y[2]=g<E?l.x<.5?-1:1:0,y[3]=E<g?l.y<.5?-1:1:0}u.anchor=y,u.deleteOnEmpty=!0,this.ep=this.instance._internal_newEndpoint(u);var b={};if(s.extract){for(var x in s.extract){var S=t.getAttribute(x);S&&(b[s.extract[x]]=S)}this.ep.mergeParameters(b)}if(u.uniqueEndpoint){var C=this.ep.elementId,T=this.instance.getManagedData(C,Ss,e.id);T==null?(this.instance.setManagedData(C,Ss,e.id,this.ep),this.ep.deleteOnEmpty=!1):this.ep.finalEndpoint=T}r._jsPlumbOrphanedEndpoints=r._jsPlumbOrphanedEndpoints||[],r._jsPlumbOrphanedEndpoints.push(this.ep),this.instance.trigger(this.ep.endpoint.canvas,ue,n,b)}}}}},{key:"_mouseupHandler",value:function(n){var i=n.currentTarget||n.srcElement;i._jsPlumbOrphanedEndpoints&&(Bc(i._jsPlumbOrphanedEndpoints,this.instance._maybePruneEndpoint.bind(this.instance)),i._jsPlumbOrphanedEndpoints.length=0),this._activeDefinition=null}},{key:"onDragInit",value:function(n){var i=ci(n,this.instance),e=mr(n,this.instance);return this._makeDraggablePlaceholder(i,e),this.placeholderInfo.element.jtk=n.jtk,this.placeholderInfo.element}},{key:"onDragAbort",value:function(n){this._cleanupDraggablePlaceholder()}},{key:"_makeDraggablePlaceholder",value:function(n,i){this.placeholderInfo=this.placeholderInfo||{};var e=Ol(Vl,{position:"absolute"});this.instance._appendElementToContainer(e);var t=this.instance.getId(e);return this.instance.setPosition(e,n),e.style.width=i.w+"px",e.style.height=i.h+"px",this.instance.manage(e),this.placeholderInfo.id=t,this.placeholderInfo.element=e,e}},{key:"_cleanupDraggablePlaceholder",value:function(){this.placeholderInfo.element&&(this.instance.unmanage(this.placeholderInfo.element,!0),delete this.placeholderInfo.element,delete this.placeholderInfo.id)}},{key:"reset",value:function(){var n=this.instance.getContainer();this.instance.off(n,ce,this.mouseupHandler),this.instance.off(n,ue,this.mousedownHandler)}},{key:"init",value:function(n){}},{key:"startNewConnectionDrag",value:function(n,i){this.jpc=this.instance._newConnection({sourceEndpoint:this.ep,targetEndpoint:this.floatingEndpoint,source:this.ep.element,target:this.placeholderInfo.element,paintStyle:this.ep.connectorStyle,hoverPaintStyle:this.ep.connectorHoverStyle,connector:this.ep.connector,overlays:this.ep.connectorOverlays,type:this.ep.edgeType,cssClass:this.ep.connectorClass,hoverClass:this.ep.connectorHoverClass,scope:n,data:i}),this.jpc.pending=!0,this.jpc.addClass(this.instance.draggingClass),this.ep.addClass(this.instance.draggingClass),this.instance.fire(rs,this.jpc)}},{key:"startExistingConnectionDrag",value:function(){this.existingJpc=!0,this.instance.setHover(this.jpc,!1);var n=this.jpc.endpoints[0].id===this.ep.id?0:1;this.ep.detachFromConnection(this.jpc,null,!0),this.floatingEndpoint.addConnection(this.jpc),this.instance.fire(rs,this.jpc),this.instance.sourceOrTargetChanged(this.jpc.endpoints[n].elementId,this.placeholderInfo.id,this.jpc,this.placeholderInfo.element,n),this.jpc.suspendedEndpoint=this.jpc.endpoints[n],this.jpc.suspendedElement=this.jpc.endpoints[n].element,this.jpc.suspendedElementId=this.jpc.endpoints[n].elementId,this.jpc.suspendedElementType=n===0?jo:Dl,this.instance.setHover(this.jpc.suspendedEndpoint,!1),this.floatingEndpoint.referenceEndpoint=this.jpc.suspendedEndpoint,this.floatingEndpoint.mergeParameters(this.jpc.suspendedEndpoint.parameters),this.jpc.endpoints[n]=this.floatingEndpoint,this.jpc.addClass(this.instance.draggingClass),this.floatingId=this.placeholderInfo.id,this.floatingIndex=n,this.instance._refreshEndpoint(this.ep)}},{key:"_shouldStartDrag",value:function(){var n=!0;this.ep.enabled||(n=!1),this.jpc==null&&!this.ep.isSource&&!this.ep.isTemporarySource&&(n=!1),this.ep.isSource&&this.ep.isFull()&&!(this.jpc!=null&&this.ep.dragAllowedWhenFull)&&(n=!1),this.jpc!=null&&!this.jpc.isDetachable(this.ep)&&(this.ep.isFull()?n=!1:this.jpc=null);var i={},e=this.instance.checkCondition(this.jpc==null?Ef:bf,{endpoint:this.ep,source:this.ep.element,sourceId:this.ep.elementId,connection:this.jpc});return e===!1?n=!1:zn(e)==="object"?(i=e,W(i,this.payload||{})):i=this.payload||{},[n,i]}},{key:"_createFloatingEndpoint",value:function(n){var i=this.ep.endpoint;if(this.ep.edgeType!=null){var e=this.instance._deriveEndpointAndAnchorSpec(this.ep.edgeType);i=e.endpoints[1]}this.floatingEndpoint=wd(this.ep,i,n,this.placeholderInfo.element,this.placeholderInfo.id,this.instance),this.floatingAnchor=this.floatingEndpoint._anchor,this.floatingEndpoint.deleteOnEmpty=!0,this.floatingElement=this.floatingEndpoint.endpoint.canvas,this.floatingId=this.instance.getId(this.floatingElement)}},{key:"_populateTargets",value:function(n,i){var e=this,t=this.jpc&&this.jpc.endpoints[0]===this.ep,r,s=this.instance.getContainer().querySelectorAll([".",Zn,"[",Il,this.ep.scope,"]:not(.",da,")"].join(""));if(K(s,function(f){if((e.jpc!=null||f!==n)&&f!==e.floatingElement&&(e.jpc!=null||!f.jtk.endpoint.isFull())&&(t&&f.jtk.endpoint.isSource||!t&&f.jtk.endpoint.isTarget)){var h=ci(f,e.instance),v=mr(f,e.instance);r={x:h.x,y:h.y,w:v.w,h:v.h},e.endpointDropTargets.push({el:f,targetEl:f,r,endpoint:f.jtk.endpoint,def:null}),e.instance.addClass(f,en)}}),t){var l=ua(this.instance.sourceSelectors,function(f){return f.isEnabled()&&(f.def.def.scope==null||f.def.def.scope===e.ep.scope)});if(l!=null){var u=this._findTargetZones(l);K(u,function(f){if(f.getAttribute(hi)!==Wn){var h=f.getAttribute(xo);if(h!=null&&h!==e.ep.scope)return;var v={r:null,el:f};v.targetEl=Rt(f,Ae,e.instance.getContainer(),!0);var p=ci(v.el,e.instance),y=mr(v.el,e.instance);v.r={x:p.x,y:p.y,w:y.w,h:y.h},l.def.def.rank!=null&&(v.rank=l.def.def.rank),v.def=l.def,e.endpointDropTargets.push(v),e.instance.addClass(v.targetEl,en)}})}}else{var c=jc(this.instance.targetSelectors,function(f){return f.isEnabled()});c.forEach(function(f){var h=e._findTargetZones(f);K(h,function(v){if(v.getAttribute(hi)!==Wn){var p=v.getAttribute(xo);if(p!=null&&p!==e.ep.scope)return;var y={r:null,el:v};if(f.def.def.parentSelector!=null&&(y.targetEl=Rt(v,f.def.def.parentSelector,e.instance.getContainer(),!0)),y.targetEl==null&&(y.targetEl=Rt(v,Ae,e.instance.getContainer(),!0)),(f.def.def.allowLoopback===!1||e._activeDefinition&&e._activeDefinition.def.def.allowLoopback===!1)&&y.targetEl===e.ep.element||f.def.def.canAcceptNewConnection!=null&&!f.def.def.canAcceptNewConnection(y.targetEl,i))return;var g=f.def.def.maxConnections;if(g!=null&&g!==-1&&e.instance.select({target:y.targetEl}).length>=g)return;var E=ci(v,e.instance),b=mr(v,e.instance);y.r={x:E.x,y:E.y,w:b.w,h:b.h},y.def=f.def,f.def.def.rank!=null&&(y.rank=f.def.def.rank),e.endpointDropTargets.push(y),e.instance.addClass(y.targetEl,en)}})})}this.endpointDropTargets.sort(function(f,h){if(f.targetEl._isJsPlumbGroup&&!h.targetEl._isJsPlumbGroup)return 1;if(!f.targetEl._isJsPlumbGroup&&h.targetEl._isJsPlumbGroup)return-1;if(f.targetEl._isJsPlumbGroup&&h.targetEl._isJsPlumbGroup){if(e.instance.groupManager.isAncestor(f.targetEl._jsPlumbGroup,h.targetEl._jsPlumbGroup))return-1;if(e.instance.groupManager.isAncestor(h.targetEl._jsPlumbGroup,f.targetEl._jsPlumbGroup))return 1}else if(f.rank!=null&&h.rank!=null){if(f.rank>h.rank)return-1;if(f.rank<h.rank)return 1}else return 0})}},{key:"_findTargetZones",value:function(n){var i;if(n.redrop===Dd){var e=this.instance.targetSelectors.map(function(r){return r.selector});e.push.apply(e,qn(this.instance.sourceSelectors.map(function(r){return r.selector}))),e.push(Ae),i=e.join(",")}else if(n.redrop===au)i=n.selector;else if(n.redrop===_d)i=this.instance.sourceSelectors.map(function(r){return r.selector}).join(",");else if(n.redrop===Id)i=this.instance.targetSelectors.map(function(r){return r.selector}).join(",");else if(n.redrop===Md){var t=this.instance.targetSelectors.map(function(r){return r.selector});t.push.apply(t,qn(this.instance.sourceSelectors.map(function(r){return r.selector}))),i=t.join(",")}return this.instance.getContainer().querySelectorAll(i)}},{key:"onStart",value:function(n){this.endpointDropTargets.length=0,this.currentDropTarget=null,this._stopped=!1;var i=n.drag.getDragElement();if(this.ep=i.jtk.endpoint,!this.ep)return!1;this.endpointRepresentation=this.ep.endpoint,this.canvasElement=this.endpointRepresentation.canvas,this.jpc=this.ep.connectorSelector();var e=this._shouldStartDrag(),t=Ti(e,2),r=t[0],s=t[1];if(r===!1)return this._stopped=!0,!1;this.instance.setHover(this.ep,!1),this.instance.isConnectionBeingDragged=!0,this.jpc&&!this.ep.isFull()&&this.ep.isSource&&(this.jpc=null),this._createFloatingEndpoint(this.canvasElement),this._populateTargets(this.canvasElement,n.e),this.jpc==null?this.startNewConnectionDrag(this.ep.scope,s):this.startExistingConnectionDrag(),this._registerFloatingConnection(this.placeholderInfo,this.jpc),this.instance.currentlyDragging=!0}},{key:"onBeforeStart",value:function(n){this.payload=n.e.payload||{}}},{key:"onDrag",value:function(n){if(this._stopped)return!0;if(this.placeholderInfo.element){var i=mr(this.floatingElement,this.instance);this.instance.setElementPosition(this.placeholderInfo.element,n.pos.x,n.pos.y);for(var e={x:n.pos.x,y:n.pos.y,w:i.w,h:i.h},t,r,s,l=0;l<this.endpointDropTargets.length;l++)if(zl(e,this.endpointDropTargets[l].r)){t=this.endpointDropTargets[l];break}if(t!==this.currentDropTarget&&this.currentDropTarget!=null&&(r=this._getFloatingAnchorIndex(),this.instance.removeClass(this.currentDropTarget.el,tn),this.currentDropTarget.endpoint&&(this.currentDropTarget.endpoint.endpoint.removeClass(this.instance.endpointDropAllowedClass),this.currentDropTarget.endpoint.endpoint.removeClass(this.instance.endpointDropForbiddenClass)),this.floatingAnchor.out()),t!=null&&(this.instance.addClass(t.el,tn),r=this._getFloatingAnchorIndex(),t.endpoint!=null))if(s=t.endpoint.isSource&&r===0||t.endpoint.isTarget&&r!==0||this.jpc.suspendedEndpoint&&t.endpoint.referenceEndpoint&&t.endpoint.referenceEndpoint.id===this.jpc.suspendedEndpoint.id,s){var u=this.instance.checkCondition(qc,{sourceEndpoint:this.jpc.endpoints[r],targetEndpoint:t.endpoint.endpoint,connection:this.jpc});u?(t.endpoint.endpoint.addClass(this.instance.endpointDropAllowedClass),t.endpoint.endpoint.removeClass(this.instance.endpointDropForbiddenClass)):(t.endpoint.endpoint.removeClass(this.instance.endpointDropAllowedClass),t.endpoint.endpoint.addClass(this.instance.endpointDropForbiddenClass)),this.floatingAnchor.over(t.endpoint),this.instance._paintConnection(this.jpc)}else t=null;this.currentDropTarget=t}}},{key:"_maybeCleanup",value:function(n){n._mtNew&&n.connections.length===0?this.instance.deleteEndpoint(n):delete n._mtNew}},{key:"_reattachOrDiscard",value:function(n){var i=this.jpc.suspendedEndpoint!=null,e=this._getFloatingAnchorIndex();return i&&this._shouldReattach()?(e===0?(this.jpc.source=this.jpc.suspendedElement,this.jpc.sourceId=this.jpc.suspendedElementId):(this.jpc.target=this.jpc.suspendedElement,this.jpc.targetId=this.jpc.suspendedElementId),this._doForceReattach(e),!0):(this._discard(e,n),!1)}},{key:"onStop",value:function(n){var i=this,e=n.e;this.instance.isConnectionBeingDragged=!1,this.instance.currentlyDragging=!1;var t=Zc(tn,en),r=this.instance.getContainer().querySelectorAll(Ld);if(K(r,function(h){i.instance.removeClass(h,t)}),this.jpc&&this.jpc.endpoints!=null){var s=this.jpc.suspendedEndpoint!=null,l=this._getFloatingAnchorIndex(),u=this.jpc.suspendedEndpoint,c;if(this.currentDropTarget!=null)if(c=this._getDropEndpoint(n,this.jpc),c==null)this._reattachOrDiscard(n.e);else if(u&&u.id===c.id)this._doForceReattach(l);else if(!c.enabled)this._reattachOrDiscard(n.e);else if(c.isFull())c.fire(Rl,{endpoint:this,connection:this.jpc,maxConnections:this.instance.defaults.maxConnections},e),this._reattachOrDiscard(n.e);else{l===0?(this.jpc.source=c.element,this.jpc.sourceId=c.elementId):(this.jpc.target=c.element,this.jpc.targetId=c.elementId);var f=!0;s&&this.jpc.suspendedEndpoint.id!==c.id&&(!this.jpc.isDetachAllowed(this.jpc)||!this.jpc.endpoints[l].isDetachAllowed(this.jpc)||!this.jpc.suspendedEndpoint.isDetachAllowed(this.jpc)||!this.instance.checkCondition("beforeDetach",this.jpc))&&(f=!1),f=f&&c.isDropAllowed(this.jpc.sourceId,this.jpc.targetId,this.jpc.scope,this.jpc,c),f?this._drop(c,l,e,f):this._reattachOrDiscard(n.e)}else this._reattachOrDiscard(n.e);this.instance._refreshEndpoint(this.ep),this.ep.removeClass(this.instance.draggingClass),this._cleanupDraggablePlaceholder(),this.jpc.removeClass(this.instance.draggingClass),delete this.jpc.suspendedEndpoint,delete this.jpc.suspendedElement,delete this.jpc.suspendedElementType,delete this.jpc.suspendedElementId,delete this.jpc.suspendedIndex,delete this.floatingId,delete this.floatingIndex,delete this.floatingElement,delete this.floatingEndpoint,delete this.floatingAnchor,delete this.jpc.pending,c!=null&&this._maybeCleanup(c)}}},{key:"_getSourceDefinition",value:function(n){for(var i,e=this.instance.getContainer(),t=0;t<this.instance.sourceSelectors.length;t++)if(i=this.instance.sourceSelectors[t],i.isEnabled()){var r=kd(n,e,i.selector,this.instance,i.exclude);if(r!==!1)return i}}},{key:"_getDropEndpoint",value:function(n,i){var e;if(this.currentDropTarget.endpoint==null){var t=this.currentDropTarget.def,r=n.e.target||n.e.srcElement;if(t==null)return null;var s=this.currentDropTarget.targetEl,l=Fs(n.e,s,this.instance.currentZoom),u=this.instance._deriveEndpointAndAnchorSpec(i.getType().join(" "),!0),c=u.endpoints?W(n,{endpoint:t.def.endpoint||u.endpoints[1],cssClass:t.def.cssClass||"",source:t.def.source===!0,target:t.def.target===!0}):n,f=this.instance.validAnchorsSpec(u.anchors)?u.anchors:this.instance.areDefaultAnchorsSet()?this.instance.defaults.anchors:null,h=t.def.anchor,v=t.def.anchorPositionFinder?t.def.anchorPositionFinder(s,l,t.def,n.e):null,p=v??h??(f!=null&&f[1]!=null?f[1]:null);p!=null&&(c=W(c,{anchor:p})),t.def.portId!=null&&(c.portId=t.def.portId);var y=t.def.parameterExtractor?t.def.parameterExtractor(this.currentDropTarget.el,r,n.e):{};if(c=Gi(c,y),c.element=s,e=this.instance._internal_newEndpoint(c),e._mtNew=!0,e.deleteOnEmpty=!0,t.def.parameters&&e.mergeParameters(t.def.parameters),t.def.extract){var g={};for(var E in t.def.extract){var b=this.currentDropTarget.el.getAttribute(E);b&&(g[t.def.extract[E]]=b)}e.mergeParameters(g)}}else e=this.currentDropTarget.endpoint;return e&&(e.removeClass(this.instance.endpointDropAllowedClass),e.removeClass(this.instance.endpointDropForbiddenClass)),e}},{key:"_doForceReattach",value:function(n){this.floatingEndpoint.detachFromConnection(this.jpc,null,!0),this.jpc.endpoints[n]=this.jpc.suspendedEndpoint,this.instance.setHover(this.jpc,!1),this.jpc._forceDetach=!0,this.jpc.suspendedEndpoint.addConnection(this.jpc),this.instance.sourceOrTargetChanged(this.floatingId,this.jpc.suspendedEndpoint.elementId,this.jpc,this.jpc.suspendedEndpoint.element,n),this.instance.deleteEndpoint(this.floatingEndpoint),this.instance.repaint(this.jpc.source),delete this.jpc._forceDetach}},{key:"_shouldReattach",value:function(){if(this.jpc.isReattach()||this.jpc._forceReattach)return!0;var n=this.jpc.suspendedEndpoint,i=this.jpc.suspendedElementType==jo?1:0,e=this.jpc.endpoints[i];return!bl(!0,!1,[[n,Jn,[this.jpc]],[e,Jn,[this.jpc]],[this.jpc,Jn,[this.jpc]],[this.instance,Ml,[Bl,this.jpc]]])}},{key:"_discard",value:function(n,i){this.jpc.pending?this.instance.fire(jf,this.jpc,i):(n===0?(this.jpc.source=this.jpc.suspendedEndpoint.element,this.jpc.sourceId=this.jpc.suspendedEndpoint.elementId):(this.jpc.target=this.jpc.suspendedEndpoint.element,this.jpc.targetId=this.jpc.suspendedEndpoint.elementId),this.jpc.endpoints[n]=this.jpc.suspendedEndpoint),this.floatingEndpoint&&this.floatingEndpoint.detachFromConnection(this.jpc),this.instance.deleteConnection(this.jpc,{originalEvent:i,force:!0})}},{key:"_drop",value:function(n,i,e,t){if(this.jpc.endpoints[i].detachFromConnection(this.jpc),this.jpc.suspendedEndpoint&&this.jpc.suspendedEndpoint.detachFromConnection(this.jpc),this.jpc.endpoints[i]=n,n.addConnection(this.jpc),this.jpc.suspendedEndpoint){var r=this.jpc.suspendedEndpoint.elementId;this.instance.fireMoveEvent({index:i,originalSourceId:i===0?r:this.jpc.sourceId,newSourceId:i===0?n.elementId:this.jpc.sourceId,originalTargetId:i===1?r:this.jpc.targetId,newTargetId:i===1?n.elementId:this.jpc.targetId,originalEndpoint:this.jpc.suspendedEndpoint,connection:this.jpc,newEndpoint:n},e)}if(i===1?this.instance.sourceOrTargetChanged(this.floatingId,this.jpc.targetId,this.jpc,this.jpc.target,1):this.instance.sourceOrTargetChanged(this.floatingId,this.jpc.sourceId,this.jpc,this.jpc.source,0),this.jpc.endpoints[0].finalEndpoint){var s=this.jpc.endpoints[0];s.detachFromConnection(this.jpc),this.jpc.endpoints[0]=this.jpc.endpoints[0].finalEndpoint,this.jpc.endpoints[0].addConnection(this.jpc)}er(t)&&this.jpc.mergeData(t),this._originalAnchorSpec&&(this.jpc.endpoints[0].setAnchor(this._originalAnchorSpec),this._originalAnchorSpec=null),this.instance._finaliseConnection(this.jpc,null,e),this.instance.setHover(this.jpc,!1),this.instance.revalidate(this.jpc.endpoints[0].element)}},{key:"_registerFloatingConnection",value:function(n,i){this.floatingConnections[n.id]=i}},{key:"_getFloatingAnchorIndex",value:function(){return this.floatingIndex==null?1:this.floatingIndex}}]),a}(),Ps=function(a){be(n,a);var o=xe(n);function n(i,e){var t;return X(this,n),t=o.call(this,i,e),t.instance=i,t.dragSelection=e,d(m(t),"selector",[">",sh,Ae].join(" ")),d(m(t),"doRevalidate",void 0),t.doRevalidate=t._revalidate.bind(m(t)),t}return J(n,[{key:"reset",value:function(){this.drag.off(Bi,this.doRevalidate)}},{key:"_revalidate",value:function(e){this.instance.revalidate(e)}},{key:"init",value:function(e){this.drag=e,e.on(Bi,this.doRevalidate)}},{key:"useGhostProxy",value:function(e,t){var r=t._jsPlumbParentGroup;return r==null?!1:r.ghost===!0}},{key:"makeGhostProxy",value:function(e){var t=e,r=t.cloneNode(!0);return r._jsPlumbParentGroup=t._jsPlumbParentGroup,r}}]),n}(Yo),Da=function(){function a(o,n){X(this,a),this.instance=o,this.overlay=n,d(this,"htmlElementOverlay",void 0),this.htmlElementOverlay=n}return J(a,null,[{key:"getElement",value:function(n,i,e){if(n.canvas==null){if(e&&i){n.canvas=e(i);var t=n.instance.overlayClass+" "+(n.cssClass?n.cssClass:"");n.instance.addClass(n.canvas,t)}else n.canvas=Ol(Vl,{},n.instance.overlayClass+" "+(n.cssClass?n.cssClass:""));n.instance.setAttribute(n.canvas,"jtk-overlay-id",n.id);for(var r in n.attributes)n.instance.setAttribute(n.canvas,r,n.attributes[r]);n.canvas.style.position=Vr,n.instance._appendElement(n.canvas,n.instance.getContainer()),n.instance.getId(n.canvas);var s="translate(-50%, -50%)";n.canvas.style.webkitTransform=s,n.canvas.style.mozTransform=s,n.canvas.style.msTransform=s,n.canvas.style.oTransform=s,n.canvas.style.transform=s,n.isVisible()||(n.canvas.style.display=tr),n.canvas.jtk={overlay:n}}return n.canvas}},{key:"destroy",value:function(n){n.canvas&&n.canvas.parentNode&&n.canvas.parentNode.removeChild(n.canvas),delete n.canvas,delete n.cachedDimensions}},{key:"_getDimensions",value:function(n,i){return(n.cachedDimensions==null||i)&&(n.cachedDimensions={w:1,h:1}),n.cachedDimensions}}]),a}(),Jr=function(){function a(){X(this,a),d(this,"_listeners",{}),d(this,"eventsSuspended",!1),d(this,"tick",!1),d(this,"eventsToDieOn",{ready:!0}),d(this,"queue",[])}return J(a,[{key:"fire",value:function(n,i,e){var t=null;if(this.tick)this.queue.unshift(arguments);else{if(this.tick=!0,!this.eventsSuspended&&this._listeners[n]){var r=this._listeners[n].length,s=0,l=!1;if(!this.shouldFireEvent||this.shouldFireEvent(n,i,e))for(;!l&&s<r&&t!==!1;){if(this.eventsToDieOn[n])this._listeners[n][s](i,e);else try{t=this._listeners[n][s](i,e)}catch(u){Ue("jsPlumb: fire failed for event "+n+" : "+(u.message||u))}s++,(this._listeners==null||this._listeners[n]==null)&&(l=!0)}}this.tick=!1,this._drain()}return t}},{key:"_drain",value:function(){var n=this.queue.pop();n&&this.fire.apply(this,n)}},{key:"unbind",value:function(n,i){if(arguments.length===0)this._listeners={};else if(arguments.length===1){if(typeof n=="string")delete this._listeners[n];else if(n.__jsPlumb){var e;for(var t in n.__jsPlumb)e=n.__jsPlumb[t],Za(this._listeners[e]||[],n)}}else arguments.length===2&&Za(this._listeners[n]||[],i);return this}},{key:"getListener",value:function(n){return this._listeners[n]||[]}},{key:"isSuspendEvents",value:function(){return this.eventsSuspended}},{key:"setSuspendEvents",value:function(n){this.eventsSuspended=n}},{key:"bind",value:function(n,i,e){var t=this,r=function(u){Sl(t._listeners,u,i,e),i.__jsPlumb=i.__jsPlumb||{},i.__jsPlumb[He()]=u};if(typeof n=="string")r(n);else if(n.length!=null)for(var s=0;s<n.length;s++)r(n[s]);return this}},{key:"silently",value:function(n){this.setSuspendEvents(!0);try{n()}catch(i){Ue("Cannot execute silent function "+i)}this.setSuspendEvents(!1)}}]),a}();(function(a){be(n,a);var o=xe(n);function n(){return X(this,n),o.apply(this,arguments)}return J(n,[{key:"shouldFireEvent",value:function(e,t,r){return!0}}]),n})(Jr);function Xo(a){var o=null;return Ne(a)?o={type:a,options:{}}:o=a,o.options.id=o.options.id||He(),o}var io=function(a){be(n,a);var o=xe(n);function n(i,e,t){var r;X(this,n),r=o.call(this),r.instance=i,r.component=e,d(m(r),"id",void 0),d(m(r),"type",void 0),d(m(r),"cssClass",void 0),d(m(r),"visible",!0),d(m(r),"location",void 0),d(m(r),"events",void 0),d(m(r),"attributes",void 0),t=t||{},r.id=t.id||He(),r.cssClass=t.cssClass||"",r.setLocation(t.location),r.events=t.events||{},r.attributes=t.attributes||{};for(var s in r.events)r.bind(s,r.events[s]);return r}return J(n,[{key:"setLocation",value:function(e){var t=this.location==null?.5:this.location;if(e!=null)try{var r=typeof e=="string"?parseFloat(e):e;isNaN(r)||(t=r)}catch{}this.location=t}},{key:"shouldFireEvent",value:function(e,t,r){return!0}},{key:"setVisible",value:function(e){this.visible=e,this.instance.setOverlayVisible(this,e)}},{key:"isVisible",value:function(){return this.visible}}]),n}(Jr),Ts={},On={get:function(o,n,i,e){var t=Ts[n];if(t)return new t(o,i,e);throw{message:"jsPlumb: unknown overlay type '"+n+"'"}},register:function(o,n){Ts[o]=n}},An=function(a){be(n,a);var o=xe(n);function n(i,e,t){var r;return X(this,n),r=o.call(this,i,e,t),r.instance=i,r.component=e,d(m(r),"label",void 0),d(m(r),"labelText",void 0),d(m(r),"type",n.type),d(m(r),"cachedDimensions",void 0),t=t||{label:""},r.setLabel(t.label),r}return J(n,[{key:"getLabel",value:function(){return Sn(this.label)?this.label(this):this.labelText}},{key:"setLabel",value:function(e){this.label=e,this.labelText=null,this.instance.updateLabel(this)}},{key:"getDimensions",value:function(){return{w:1,h:1}}},{key:"updateFrom",value:function(e){e.label!=null&&this.setLabel(e.label),e.location!=null&&(this.setLocation(e.location),this.instance.updateLabel(this))}}]),n}(io);d(An,"type","Label");function Xt(a){return a.type===An.type}On.register(An.type,An);function di(a){return a==null?null:a.split(" ").filter(function(o){return o!=null&&o.length>0})}function Os(a,o,n){for(var i in o)a[i]=n}var Nd="connector",Rd="override",Gd="cssClass",As="__default",jd="anchor",Fd="anchors",Mr="__label",Bd="jtk-default-label",su="overlay",Ud="labelLocation",Ds="add",_s="remove";function Fn(a,o){if(a.getDefaultType){var n=a.getTypeDescriptor(),i={},e=a.getDefaultType(),t=W({},e);Os(i,e,As),a._types.forEach(function(r){if(r!==As){var s=a.instance.getType(r,n);if(s!=null){var l=new Set([Nd,jd,Fd]);if(s.mergeStrategy===Rd)for(var u in s)l.add(u);t=Gi(t,s,[Gd],Fc(l)),Os(i,s,r)}}}),o&&(t=Rc(t,o,"_")),a.applyType(t,i)}}function To(a,o){var n=a.instance.getType(o,a.getTypeDescriptor());n!=null&&n.cssClass&&a.removeClass(n.cssClass)}function Is(a){if(a.paintStyle&&a.hoverPaintStyle){var o={};W(o,a.paintStyle),W(o,a.hoverPaintStyle),a.hoverPaintStyle=o}}function Hd(a,o){var n={cssClass:o.cssClass,id:Mr,component:a},i=W(n,o);return new An(a.instance,a,i)}function Vd(a,o){var n=null;if(Ne(o))n=On.get(a.instance,o,a,{});else if(o.type!=null&&o.options!=null){var i=o,e=W({},i.options);n=On.get(a.instance,i.type,a,e)}else n=o;return n.id=n.id||He(),a.cacheTypeItem(su,n,n.id),a.overlays[n.id]=n,n}var lu=function(a){be(n,a);var o=xe(n);function n(i,e){var t;if(X(this,n),t=o.call(this),t.instance=i,d(m(t),"defaultLabelLocation",.5),d(m(t),"overlays",{}),d(m(t),"overlayPositions",{}),d(m(t),"overlayPlacements",{}),d(m(t),"clone",void 0),d(m(t),"deleted",void 0),d(m(t),"segment",void 0),d(m(t),"x",void 0),d(m(t),"y",void 0),d(m(t),"w",void 0),d(m(t),"h",void 0),d(m(t),"id",void 0),d(m(t),"visible",!0),d(m(t),"typeId",void 0),d(m(t),"params",{}),d(m(t),"paintStyle",void 0),d(m(t),"hoverPaintStyle",void 0),d(m(t),"paintStyleInUse",void 0),d(m(t),"_hover",!1),d(m(t),"lastPaintedAt",void 0),d(m(t),"data",void 0),d(m(t),"_defaultType",void 0),d(m(t),"events",void 0),d(m(t),"parameters",void 0),d(m(t),"_types",void 0),d(m(t),"_typeCache",void 0),d(m(t),"cssClass",void 0),d(m(t),"hoverClass",void 0),d(m(t),"beforeDetach",void 0),d(m(t),"beforeDrop",void 0),e=e||{},t.cssClass=e.cssClass||"",t.hoverClass=e.hoverClass||i.defaults.hoverClass,t.beforeDetach=e.beforeDetach,t.beforeDrop=e.beforeDrop,t._types=new Set,t._typeCache={},t.parameters=Ri(e.parameters||{}),t.id=e.id||t.getIdPrefix()+new Date().getTime(),t._defaultType={parameters:t.parameters,scope:e.scope||t.instance.defaultScope,overlays:{}},e.events)for(var r in e.events)t.bind(r,e.events[r]);t.clone=function(){var v=Object.create(t.constructor.prototype);return t.constructor.apply(v,[i,e]),v},t.overlays={},t.overlayPositions={};var s=e.overlays||[],l={},u=t.getDefaultOverlayKey();if(u){var c=t.instance.defaults[u];c&&s.push.apply(s,qn(c));for(var f=0;f<s.length;f++){var h=Xo(s[f]);l[h.options.id]=h}}return t._defaultType.overlays=l,e.label&&(t.getDefaultType().overlays[Mr]={type:An.type,options:{label:e.label,location:e.labelLocation||t.defaultLabelLocation,id:Mr,cssClass:Bd}}),t}return J(n,[{key:"isDetachAllowed",value:function(e){var t=!0;if(this.beforeDetach)try{t=this.beforeDetach(e)}catch(r){Ue("jsPlumb: beforeDetach callback failed",r)}return t}},{key:"isDropAllowed",value:function(e,t,r,s,l){var u,c={sourceId:e,targetId:t,scope:r,connection:s,dropEndpoint:l};if(this.beforeDrop)try{u=this.beforeDrop(c)}catch(f){Ue("jsPlumb: beforeDrop callback failed",f)}else u=this.instance.checkCondition(Fl,c);return u}},{key:"getDefaultType",value:function(){return this._defaultType}},{key:"appendToDefaultType",value:function(e){for(var t in e)this._defaultType[t]=e[t]}},{key:"getId",value:function(){return this.id}},{key:"cacheTypeItem",value:function(e,t,r){this._typeCache[r]=this._typeCache[r]||{},this._typeCache[r][e]=t}},{key:"getCachedTypeItem",value:function(e,t){return this._typeCache[t]?this._typeCache[t][e]:null}},{key:"setType",value:function(e,t){this.clearTypes(),(di(e)||[]).forEach(this._types.add,this._types),Fn(this,t)}},{key:"getType",value:function(){return Array.from(this._types.keys())}},{key:"reapplyTypes",value:function(e){Fn(this,e)}},{key:"hasType",value:function(e){return this._types.has(e)}},{key:"addType",value:function(e,t){var r=di(e),s=!1;if(r!=null){for(var l=0,u=r.length;l<u;l++)this._types.has(r[l])||(this._types.add(r[l]),s=!0);s&&Fn(this,t)}}},{key:"removeType",value:function(e,t){var r=this,s=di(e),l=!1,u=function(v){return r._types.has(v)?(To(r,v),r._types.delete(v),!0):!1};if(s!=null){for(var c=0,f=s.length;c<f;c++)l=u(s[c])||l;l&&Fn(this,t)}}},{key:"clearTypes",value:function(e){var t=this;this._types.forEach(function(r){To(t,r)}),this._types.clear(),Fn(this,e)}},{key:"toggleType",value:function(e,t){var r=di(e);if(r!=null){for(var s=0,l=r.length;s<l;s++)this._types.has(r[s])?(To(this,r[s]),this._types.delete(r[s])):this._types.add(r[s]);Fn(this,t)}}},{key:"applyType",value:function(e,t){if(this.setPaintStyle(e.paintStyle),this.setHoverPaintStyle(e.hoverPaintStyle),this.mergeParameters(e.parameters),this.paintStyleInUse=this.getPaintStyle(),e.overlays){var r={},s;for(s in e.overlays){var l=this.overlays[e.overlays[s].options.id];if(l)l.updateFrom(e.overlays[s].options),r[e.overlays[s].options.id]=!0,this.instance.reattachOverlay(l,this);else{var u=this.getCachedTypeItem(su,e.overlays[s].options.id);u!=null?(this.instance.reattachOverlay(u,this),u.setVisible(!0),u.updateFrom(e.overlays[s].options),this.overlays[u.id]=u):u=this.addOverlay(e.overlays[s]),r[u.id]=!0}}for(s in this.overlays)r[this.overlays[s].id]==null&&this.removeOverlay(this.overlays[s].id,!0)}}},{key:"setPaintStyle",value:function(e){this.paintStyle=e,this.paintStyleInUse=this.paintStyle,Is(this)}},{key:"getPaintStyle",value:function(){return this.paintStyle}},{key:"setHoverPaintStyle",value:function(e){this.hoverPaintStyle=e,Is(this)}},{key:"getHoverPaintStyle",value:function(){return this.hoverPaintStyle}},{key:"destroy",value:function(){for(var e in this.overlays)this.instance.destroyOverlay(this.overlays[e]);this.overlays={},this.overlayPositions={},this.unbind(),this.clone=null}},{key:"isHover",value:function(){return this._hover}},{key:"mergeParameters",value:function(e){e!=null&&W(this.parameters,e)}},{key:"setVisible",value:function(e){this.visible=e,e?this.showOverlays():this.hideOverlays()}},{key:"isVisible",value:function(){return this.visible}},{key:"setAbsoluteOverlayPosition",value:function(e,t){this.overlayPositions[e.id]=t}},{key:"getAbsoluteOverlayPosition",value:function(e){return this.overlayPositions?this.overlayPositions[e.id]:null}},{key:"_clazzManip",value:function(e,t){for(var r in this.overlays)e===Ds?this.instance.addOverlayClass(this.overlays[r],t):e===_s&&this.instance.removeOverlayClass(this.overlays[r],t)}},{key:"addClass",value:function(e,t){var r=(this.cssClass||"").split(" ");r.push(e),this.cssClass=r.join(" "),this._clazzManip(Ds,e)}},{key:"removeClass",value:function(e,t){var r=(this.cssClass||"").split(" ");this.cssClass=r.filter(function(s){return s!==e}).join(" "),this._clazzManip(_s,e)}},{key:"getClass",value:function(){return this.cssClass}},{key:"shouldFireEvent",value:function(e,t,r){return!0}},{key:"getData",value:function(){return this.data}},{key:"setData",value:function(e){this.data=e||{}}},{key:"mergeData",value:function(e){this.data=W(this.data,e)}},{key:"addOverlay",value:function(e){var t=Vd(this,e);if(this.getData&&t.type===An.type&&!Ne(e)){var r=this.getData(),s=e.options;if(r){var l=s.labelLocationAttribute||Ud,u=r[l];u&&(t.location=u)}}return t}},{key:"getOverlay",value:function(e){return this.overlays[e]}},{key:"getOverlays",value:function(){return this.overlays}},{key:"hideOverlay",value:function(e){var t=this.getOverlay(e);t&&t.setVisible(!1)}},{key:"hideOverlays",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t=t||[];for(var s in this.overlays)(t.length===0||t.indexOf(s)!==-1)&&this.overlays[s].setVisible(!1)}},{key:"showOverlay",value:function(e){var t=this.getOverlay(e);t&&t.setVisible(!0)}},{key:"showOverlays",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t=t||[];for(var s in this.overlays)(t.length===0||t.indexOf(s)!==-1)&&this.overlays[s].setVisible(!0)}},{key:"removeAllOverlays",value:function(){for(var e in this.overlays)this.instance.destroyOverlay(this.overlays[e]);this.overlays={},this.overlayPositions=null,this.overlayPlacements={}}},{key:"removeOverlay",value:function(e,t){var r=this.overlays[e];r&&(r.setVisible(!1),t||this.instance.destroyOverlay(r),delete this.overlays[e],this.overlayPositions&&delete this.overlayPositions[e],this.overlayPlacements&&delete this.overlayPlacements[e])}},{key:"removeOverlays",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var s=0,l=t.length;s<l;s++)this.removeOverlay(arguments[s])}},{key:"getLabel",value:function(){var e=this.getLabelOverlay();return e!=null?e.getLabel():null}},{key:"getLabelOverlay",value:function(){return this.getOverlay(Mr)}},{key:"setLabel",value:function(e){var t=this.getLabelOverlay();if(t)if(Ne(e)||Sn(e))t.setLabel(e);else{var s=e;s.label&&t.setLabel(s.label),s.location&&(t.location=s.location)}else{var r=Ne(e)||Sn(e)?{label:e}:e;t=Hd(this,r),this.overlays[Mr]=t}}}]),n}(Jr),Yd=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"],Kn=function(a){be(n,a);var o=xe(n);function n(i,e){var t;X(this,n),t=o.call(this,i,e),t.instance=i,d(m(t),"connections",[]),d(m(t),"endpoint",void 0),d(m(t),"element",void 0),d(m(t),"elementId",void 0),d(m(t),"dragAllowedWhenFull",!0),d(m(t),"timestamp",void 0),d(m(t),"portId",void 0),d(m(t),"maxConnections",void 0),d(m(t),"proxiedBy",void 0),d(m(t),"connectorClass",void 0),d(m(t),"connectorHoverClass",void 0),d(m(t),"finalEndpoint",void 0),d(m(t),"enabled",!0),d(m(t),"isSource",void 0),d(m(t),"isTarget",void 0),d(m(t),"isTemporarySource",void 0),d(m(t),"connectionCost",1),d(m(t),"connectionsDirected",void 0),d(m(t),"connectionsDetachable",void 0),d(m(t),"reattachConnections",void 0),d(m(t),"currentAnchorClass",void 0),d(m(t),"referenceEndpoint",void 0),d(m(t),"edgeType",void 0),d(m(t),"connector",void 0),d(m(t),"connectorOverlays",void 0),d(m(t),"connectorStyle",void 0),d(m(t),"connectorHoverStyle",void 0),d(m(t),"deleteOnEmpty",void 0),d(m(t),"uuid",void 0),d(m(t),"scope",void 0),d(m(t),"_anchor",void 0),d(m(t),"defaultLabelLocation",[.5,.5]),t.appendToDefaultType({edgeType:e.edgeType,maxConnections:e.maxConnections==null?t.instance.defaults.maxConnections:e.maxConnections,paintStyle:e.paintStyle||t.instance.defaults.endpointStyle,hoverPaintStyle:e.hoverPaintStyle||t.instance.defaults.endpointHoverStyle,connectorStyle:e.connectorStyle,connectorHoverStyle:e.connectorHoverStyle,connectorClass:e.connectorClass,connectorHoverClass:e.connectorHoverClass,connectorOverlays:e.connectorOverlays,connector:e.connector}),t.enabled=e.enabled!==!1,t.visible=!0,t.element=e.element,t.uuid=e.uuid,t.portId=e.portId,t.elementId=e.elementId,t.connectionCost=e.connectionCost==null?1:e.connectionCost,t.connectionsDirected=e.connectionsDirected,t.currentAnchorClass="",t.events={},t.connectorOverlays=e.connectorOverlays,t.connectorStyle=e.connectorStyle,t.connectorHoverStyle=e.connectorHoverStyle,t.connector=e.connector,t.edgeType=e.edgeType,t.connectorClass=e.connectorClass,t.connectorHoverClass=e.connectorHoverClass,t.deleteOnEmpty=e.deleteOnEmpty===!0,t.isSource=e.source||!1,t.isTemporarySource=e.isTemporarySource||!1,t.isTarget=e.target||!1,t.connections=e.connections||[],t.scope=e.scope||i.defaultScope,t.timestamp=null,t.reattachConnections=e.reattachConnections||i.defaults.reattachConnections,t.connectionsDetachable=i.defaults.connectionsDetachable,e.connectionsDetachable===!1&&(t.connectionsDetachable=!1),t.dragAllowedWhenFull=e.dragAllowedWhenFull!==!1,e.onMaxConnections&&t.bind(Rl,e.onMaxConnections);var r=e.endpoint||e.existingEndpoint||i.defaults.endpoint;if(t.setEndpoint(r),e.preparedAnchor!=null)t.setPreparedAnchor(e.preparedAnchor);else{var s=e.anchor?e.anchor:e.anchors?e.anchors:i.defaults.anchor||Mt.Top;t.setAnchor(s)}var l=[Hi,e.type||""].join(" ");return t.addType(l,e.data),t}return J(n,[{key:"getIdPrefix",value:function(){return"_jsplumb_e"}},{key:"getTypeDescriptor",value:function(){return"endpoint"}},{key:"getXY",value:function(){return{x:this.endpoint.x,y:this.endpoint.y}}},{key:"getDefaultOverlayKey",value:function(){return"endpointOverlays"}},{key:"_updateAnchorClass",value:function(){var e=this._anchor&&this._anchor.cssClass;if(e!=null&&e.length>0){var t=this.instance.endpointAnchorClassPrefix+"-"+this.currentAnchorClass;this.currentAnchorClass=e;var r=this.instance.endpointAnchorClassPrefix+(this.currentAnchorClass?"-"+this.currentAnchorClass:"");t!==r&&(this.removeClass(t),this.addClass(r),this.instance.removeClass(this.element,t),this.instance.addClass(this.element,r))}}},{key:"setPreparedAnchor",value:function(e){return this.instance.router.setAnchor(this,e),this._updateAnchorClass(),this}},{key:"_anchorLocationChanged",value:function(e){this.fire(lf,{endpoint:this,anchor:e}),this._updateAnchorClass()}},{key:"setAnchor",value:function(e){var t=this.instance.router.prepareAnchor(e);return this.setPreparedAnchor(t),this}},{key:"addConnection",value:function(e){this.connections.push(e),this.instance._refreshEndpoint(this)}},{key:"detachFromConnection",value:function(e,t,r){t=t??this.connections.indexOf(e),t>=0&&(this.connections.splice(t,1),this.instance._refreshEndpoint(this)),!r&&this.deleteOnEmpty&&this.connections.length===0&&this.instance.deleteEndpoint(this)}},{key:"deleteEveryConnection",value:function(e){for(var t=this.connections.length,r=0;r<t;r++)this.instance.deleteConnection(this.connections[0],e)}},{key:"detachFrom",value:function(e){for(var t=[],r=0;r<this.connections.length;r++)(this.connections[r].endpoints[1]===e||this.connections[r].endpoints[0]===e)&&t.push(this.connections[r]);for(var s=0,l=t.length;s<l;s++)this.instance.deleteConnection(t[0]);return this}},{key:"setVisible",value:function(e,t,r){if(Le(De(n.prototype),"setVisible",this).call(this,e),this.endpoint.setVisible(e),e?this.showOverlays():this.hideOverlays(),!t){for(var s=0;s<this.connections.length;s++)if(this.connections[s].setVisible(e),!r){var l=this===this.connections[s].endpoints[0]?1:0;this.connections[s].endpoints[l].connections.length===1&&this.connections[s].endpoints[l].setVisible(e,!0,!0)}}}},{key:"applyType",value:function(e,t){Le(De(n.prototype),"applyType",this).call(this,e,t),this.setPaintStyle(e.endpointStyle||e.paintStyle),this.setHoverPaintStyle(e.endpointHoverStyle||e.hoverPaintStyle),this.connectorStyle=e.connectorStyle,this.connectorHoverStyle=e.connectorHoverStyle,this.connector=e.connector,this.connectorOverlays=e.connectorOverlays,this.edgeType=e.edgeType,e.maxConnections!=null&&(this.maxConnections=e.maxConnections),e.scope&&(this.scope=e.scope),W(e,Yd),this.instance.applyEndpointType(this,e)}},{key:"destroy",value:function(){Le(De(n.prototype),"destroy",this).call(this),this.deleted=!0,this.endpoint!=null&&this.instance.destroyEndpoint(this)}},{key:"isFull",value:function(){return this.maxConnections===0?!0:!(this.isFloating()||this.maxConnections<0||this.connections.length<this.maxConnections)}},{key:"isFloating",value:function(){return this.instance.router.isFloating(this)}},{key:"isConnectedTo",value:function(e){var t=!1;if(e){for(var r=0;r<this.connections.length;r++)if(this.connections[r].endpoints[1]===e||this.connections[r].endpoints[0]===e){t=!0;break}}return t}},{key:"setDragAllowedWhenFull",value:function(e){this.dragAllowedWhenFull=e}},{key:"getUuid",value:function(){return this.uuid}},{key:"connectorSelector",value:function(){return this.connections[0]}},{key:"prepareEndpoint",value:function(e,t){var r={cssClass:this.cssClass,endpoint:this},s;if(Pl(e,ar)){var l=e;s=nn.clone(l),s.classes=r.cssClass.split(" ")}else if(Ne(e))s=nn.get(this,e,r);else{var u=e;W(r,u.options||{}),s=nn.get(this,u.type,r)}return s.typeId=t,s}},{key:"setEndpoint",value:function(e){var t=this.prepareEndpoint(e);this.setPreparedEndpoint(t)}},{key:"setPreparedEndpoint",value:function(e){this.endpoint!=null&&this.instance.destroyEndpoint(this),this.endpoint=e}},{key:"addClass",value:function(e,t){Le(De(n.prototype),"addClass",this).call(this,e,t),this.endpoint!=null&&this.endpoint.addClass(e)}},{key:"removeClass",value:function(e,t){Le(De(n.prototype),"removeClass",this).call(this,e,t),this.endpoint!=null&&this.endpoint.removeClass(e)}}]),n}(lu),vi="anchors",Oo="connector";function Ms(a,o,n,i,e,t,r){var s;if(o)a.endpoints[n]=o,o.addConnection(a);else{var l=r||a.endpointSpec||a.endpointsSpec[n]||a.instance.defaults.endpoints[n]||a.instance.defaults.endpoint,u=a.endpointStyles[n]||a.endpointStyle||a.instance.defaults.endpointStyles[n]||a.instance.defaults.endpointStyle;u.fill==null&&a.paintStyle!=null&&(u.fill=a.paintStyle.stroke),u.outlineStroke==null&&a.paintStyle!=null&&(u.outlineStroke=a.paintStyle.outlineStroke),u.outlineWidth==null&&a.paintStyle!=null&&(u.outlineWidth=a.paintStyle.outlineWidth);var c=a.endpointHoverStyles[n]||a.endpointHoverStyle||a.endpointHoverStyle||a.instance.defaults.endpointHoverStyles[n]||a.instance.defaults.endpointHoverStyle;a.hoverPaintStyle!=null&&(c==null&&(c={}),c.fill==null&&(c.fill=a.hoverPaintStyle.stroke));var f=a.uuids?a.uuids[n]:null;i=i??(a.instance.defaults.anchors!=null?a.instance.defaults.anchors[n]:a.instance.defaults.anchor),s=a.instance._internal_newEndpoint({paintStyle:u,hoverPaintStyle:c,endpoint:l,connections:[a],uuid:f,element:e,scope:a.scope,anchor:i,reattachConnections:a.reattach||a.instance.defaults.reattachConnections,connectionsDetachable:a.detachable||a.instance.defaults.connectionsDetachable}),a.instance._refreshEndpoint(s),o==null&&(s.deleteOnEmpty=!0),a.endpoints[n]=s}return s}var $r=function(a){be(n,a);var o=xe(n);function n(i,e){var t;X(this,n),t=o.call(this,i,e),t.instance=i,d(m(t),"connector",void 0),d(m(t),"defaultLabelLocation",.5),d(m(t),"scope",void 0),d(m(t),"typeId","_jsplumb_connection"),d(m(t),"previousConnection",void 0),d(m(t),"sourceId",void 0),d(m(t),"targetId",void 0),d(m(t),"source",void 0),d(m(t),"target",void 0),d(m(t),"detachable",!0),d(m(t),"reattach",!1),d(m(t),"uuids",void 0),d(m(t),"cost",1),d(m(t),"directed",void 0),d(m(t),"endpoints",[null,null]),d(m(t),"endpointStyles",void 0),d(m(t),"endpointSpec",void 0),d(m(t),"endpointsSpec",void 0),d(m(t),"endpointStyle",{}),d(m(t),"endpointHoverStyle",{}),d(m(t),"endpointHoverStyles",void 0),d(m(t),"suspendedEndpoint",void 0),d(m(t),"suspendedIndex",void 0),d(m(t),"suspendedElement",void 0),d(m(t),"suspendedElementId",void 0),d(m(t),"suspendedElementType",void 0),d(m(t),"_forceReattach",void 0),d(m(t),"_forceDetach",void 0),d(m(t),"proxies",[]),d(m(t),"pending",!1),t.id=e.id,t.previousConnection=e.previousConnection,t.source=e.source,t.target=e.target,e.sourceEndpoint?(t.source=e.sourceEndpoint.element,t.sourceId=e.sourceEndpoint.elementId):t.sourceId=i.getId(t.source),e.targetEndpoint?(t.target=e.targetEndpoint.element,t.targetId=e.targetEndpoint.elementId):t.targetId=i.getId(t.target),t.scope=e.scope;var r=e.anchors?e.anchors[0]:e.anchor,s=e.anchors?e.anchors[1]:e.anchor;i.manage(t.source),i.manage(t.target),t.visible=!0,t.params={cssClass:e.cssClass,hoverClass:e.hoverClass,"pointer-events":e["pointer-events"],overlays:e.overlays},t.lastPaintedAt=null,e.type&&(e.endpoints=e.endpoints||t.instance._deriveEndpointAndAnchorSpec(e.type).endpoints),t.endpointSpec=e.endpoint,t.endpointsSpec=e.endpoints||[null,null],t.endpointStyle=e.endpointStyle,t.endpointHoverStyle=e.endpointHoverStyle,t.endpointStyles=e.endpointStyles||[null,null],t.endpointHoverStyles=e.endpointHoverStyles||[null,null],t.paintStyle=e.paintStyle,t.hoverPaintStyle=e.hoverPaintStyle,t.uuids=e.uuids,t.makeEndpoint(!0,t.source,t.sourceId,r,e.sourceEndpoint),t.makeEndpoint(!1,t.target,t.targetId,s,e.targetEndpoint),t.scope||(t.scope=t.endpoints[0].scope),e.deleteEndpointsOnEmpty!=null&&(t.endpoints[0].deleteOnEmpty=e.deleteEndpointsOnEmpty,t.endpoints[1].deleteOnEmpty=e.deleteEndpointsOnEmpty);var l=t.instance.defaults.connectionsDetachable;e.detachable===!1&&(l=!1),t.endpoints[0].connectionsDetachable===!1&&(l=!1),t.endpoints[1].connectionsDetachable===!1&&(l=!1),t.endpointsSpec=e.endpoints||[null,null],t.endpointSpec=e.endpoint||null;var u=e.reattach||t.endpoints[0].reattachConnections||t.endpoints[1].reattachConnections||t.instance.defaults.reattachConnections,c=W({},t.endpoints[0].connectorStyle||t.endpoints[1].connectorStyle||e.paintStyle||t.instance.defaults.paintStyle);if(t.appendToDefaultType({detachable:l,reattach:u,paintStyle:c,hoverPaintStyle:W({},t.endpoints[0].connectorHoverStyle||t.endpoints[1].connectorHoverStyle||e.hoverPaintStyle||t.instance.defaults.hoverPaintStyle)}),e.outlineWidth&&(c.outlineWidth=e.outlineWidth),e.outlineColor&&(c.outlineStroke=e.outlineColor),e.lineWidth&&(c.strokeWidth=e.lineWidth),e.color&&(c.stroke=e.color),!t.instance._suspendDrawing){var f=t.instance._suspendedAt||He();t.instance._paintEndpoint(t.endpoints[0],{timestamp:f}),t.instance._paintEndpoint(t.endpoints[1],{timestamp:f})}t.cost=e.cost||t.endpoints[0].connectionCost,t.directed=e.directed,e.directed==null&&(t.directed=t.endpoints[0].connectionsDirected);var h=W({},t.endpoints[1].parameters);W(h,t.endpoints[0].parameters),W(h,t.parameters),t.parameters=h,t.paintStyleInUse=t.getPaintStyle()||{},t._setConnector(t.endpoints[0].connector||t.endpoints[1].connector||e.connector||t.instance.defaults.connector,!0);var v=e.data==null||!er(e.data)?{}:e.data;t.setData(v);var p=[Hi,t.endpoints[0].edgeType,t.endpoints[1].edgeType,e.type].join(" ");return/[^\s]/.test(p)&&t.addType(p,e.data),t}return J(n,[{key:"getIdPrefix",value:function(){return"_jsPlumb_c"}},{key:"getDefaultOverlayKey",value:function(){return Tf}},{key:"getXY",value:function(){return{x:this.connector.x,y:this.connector.y}}},{key:"makeEndpoint",value:function(e,t,r,s,l){return r=r||this.instance.getId(t),Ms(this,l,e?0:1,s,t)}},{key:"getTypeDescriptor",value:function(){return n.type}},{key:"isDetachable",value:function(e){return this.detachable===!1?!1:e!=null?e.connectionsDetachable===!0:this.detachable===!0}},{key:"setDetachable",value:function(e){this.detachable=e===!0}},{key:"isReattach",value:function(){return this.reattach===!0||this.endpoints[0].reattachConnections===!0||this.endpoints[1].reattachConnections===!0}},{key:"setReattach",value:function(e){this.reattach=e===!0}},{key:"applyType",value:function(e,t){var r=null;e.connector!=null&&(r=this.getCachedTypeItem(Oo,t.connector),r==null&&(r=this.prepareConnector(e.connector,t.connector),this.cacheTypeItem(Oo,r,t.connector)),this.setPreparedConnector(r)),Le(De(n.prototype),"applyType",this).call(this,e,t),e.detachable!=null&&this.setDetachable(e.detachable),e.reattach!=null&&this.setReattach(e.reattach),e.scope&&(this.scope=e.scope);var s=null;e.anchor?(s=this.getCachedTypeItem(vi,t.anchor),s==null&&(s=[Ir(e.anchor),Ir(e.anchor)],this.cacheTypeItem(vi,s,t.anchor))):e.anchors&&(s=this.getCachedTypeItem(vi,t.anchors),s==null&&(s=[Ir(e.anchors[0]),Ir(e.anchors[1])],this.cacheTypeItem(vi,s,t.anchors))),s!=null&&(this.instance.router.setConnectionAnchors(this,s),this.instance.router.isDynamicAnchor(this.endpoints[1])&&this.instance.repaint(this.endpoints[1].element)),this.instance.applyConnectorType(this.connector,e)}},{key:"addClass",value:function(e,t){Le(De(n.prototype),"addClass",this).call(this,e),t&&(this.endpoints[0].addClass(e),this.endpoints[1].addClass(e),this.suspendedEndpoint&&this.suspendedEndpoint.addClass(e)),this.connector&&this.instance.addConnectorClass(this.connector,e)}},{key:"removeClass",value:function(e,t){Le(De(n.prototype),"removeClass",this).call(this,e),t&&(this.endpoints[0].removeClass(e),this.endpoints[1].removeClass(e),this.suspendedEndpoint&&this.suspendedEndpoint.removeClass(e)),this.connector&&this.instance.removeConnectorClass(this.connector,e)}},{key:"setVisible",value:function(e){Le(De(n.prototype),"setVisible",this).call(this,e),this.connector&&this.instance.setConnectorVisible(this.connector,e),this.instance._paintConnection(this)}},{key:"destroy",value:function(){Le(De(n.prototype),"destroy",this).call(this),this.endpoints=null,this.endpointStyles=null,this.source=null,this.target=null,this.instance.destroyConnector(this),this.connector=null,this.deleted=!0}},{key:"getUuids",value:function(){return[this.endpoints[0].getUuid(),this.endpoints[1].getUuid()]}},{key:"prepareConnector",value:function(e,t){var r={cssClass:this.params.cssClass,hoverClass:this.params.hoverClass,"pointer-events":this.params["pointer-events"]},s;if(Ne(e))s=this.instance._makeConnector(this,e,r);else{var l=e;s=this.instance._makeConnector(this,l.type,Gi(l.options||{},r))}return t!=null&&(s.typeId=t),s}},{key:"setPreparedConnector",value:function(e,t,r,s){if(this.connector!==e){var l,u="";if(this.connector!=null&&(l=this.connector,u=this.instance.getConnectorClass(this.connector),this.instance.destroyConnector(this)),this.connector=e,s&&this.cacheTypeItem(Oo,e,s),this.addClass(u),l!=null){var c=this.getOverlays();for(var f in c)this.instance.reattachOverlay(c[f],this)}t||this.instance._paintConnection(this)}}},{key:"_setConnector",value:function(e,t,r,s){var l=this.prepareConnector(e,s);this.setPreparedConnector(l,t,r,s)}},{key:"replaceEndpoint",value:function(e,t){var r=this.endpoints[e],s=r.elementId,l=this.instance.getEndpoints(r.element),u=l.indexOf(r),c=Ms(this,null,e,null,r.element,s,t);this.endpoints[e]=c,l.splice(u,1,c),r.detachFromConnection(this),this.instance.deleteEndpoint(r),this.instance.fire(cf,{previous:r,current:c})}}]),n}(lu);d($r,"type","connection");function wr(a){if(a.path==null){var o=W({"jtk-overlay-id":a.id},a.attributes);a.path=Ut(Bo,o);var n=a.instance.overlayClass+" "+(a.cssClass?a.cssClass:"");a.instance.addClass(a.path,n),a.path.jtk={overlay:a}}var i=a.path.parentNode;if(i==null){if(a.component instanceof $r){var e=a.component.connector;i=e!=null?e.canvas:null}else if(a.component instanceof Kn){var t=a.component.endpoint;i=t!=null?t.canvas:t}i!=null&&Ai(i,a.path,1)}return a.path}function Xd(a,o,n,i){wr(a);var e=[0,0];i.xmin<0&&(e[0]=-i.xmin),i.ymin<0&&(e[1]=-i.ymin);var t={d:o,stroke:n.stroke?n.stroke:null,fill:n.fill?n.fill:null,transform:"translate("+e[0]+","+e[1]+")","pointer-events":"visibleStroke"};Bt(a.path,t)}function $d(a,o){var n=a;n.path!=null&&n.path.parentNode!=null&&n.path.parentNode.removeChild(n.path),n.bgPath!=null&&n.bgPath.parentNode!=null&&n.bgPath.parentNode.removeChild(n.bgPath),delete n.path,delete n.bgPath}(function(a){be(n,a);var o=xe(n);function n(){var i;X(this,n);for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return i=o.call.apply(o,[this].concat(t)),d(m(i),"path",void 0),i}return n})(io);var uu=function(){function a(){X(this,a)}return J(a,null,[{key:"paint",value:function(n,i,e,t){if(e!=null){var r=[n.x,n.y],s=[n.w,n.h];if(t!=null&&(t.xmin<0&&(r[0]+=t.xmin),t.ymin<0&&(r[1]+=t.ymin),s[0]=t.xmax+(t.xmin<0?-t.xmin:0),s[1]=t.ymax+(t.ymin<0?-t.ymin:0)),isFinite(s[0])&&isFinite(s[1])){var l={width:""+(s[0]||0),height:""+(s[1]||0)};i.containerType===Pn.HTML?Bt(n.canvas,W(l,{style:Hl([r[0],r[1]])})):Bt(n.canvas,W(l,{x:r[0],y:r[1]}))}}}}]),a}();function Wd(a,o,n,i){Kd(a,o),uu.paint(o,a,n,i);var e="",t=[0,0];if(i.xmin<0&&(t[0]=-i.xmin),i.ymin<0&&(t[1]=-i.ymin),o.segments.length>0){e=a.getPathData(o);var r={d:e,transform:"translate("+t[0]+","+t[1]+")","pointer-events":"visibleStroke"},s=null;if(n.outlineStroke){var l=n.outlineWidth||1,u=n.strokeWidth+2*l;s=W({},n),s.stroke=n.outlineStroke,s.strokeWidth=u,o.bgPath==null?(o.bgPath=Ut(Bo,r),a.addClass(o.bgPath,a.connectorOutlineClass),Ai(o.canvas,o.bgPath,0)):Bt(o.bgPath,r),Uo(o.canvas,o.bgPath,s)}var c=o;c.path==null?(c.path=Ut(Bo,r),Ai(c.canvas,c.path,n.outlineStroke?1:0)):(c.path.parentNode!==c.canvas&&Ai(c.canvas,c.path,n.outlineStroke?1:0),Bt(o.path,r)),Uo(o.canvas,o.path,n)}}function Kd(a,o){if(o.canvas!=null)return o.canvas;var n=Ut(Ul,{style:"",width:"0",height:"0","pointer-events":tr,position:Vr});return o.canvas=n,a._appendElement(o.canvas,a.getContainer()),o.cssClass!=null&&a.addClass(n,o.cssClass),a.addClass(n,a.connectorClass),n.jtk=n.jtk||{},n.jtk.connector=o,n}var zd=function(){function a(){X(this,a)}return J(a,null,[{key:"getEndpointElement",value:function(n){if(n.canvas!=null)return n.canvas;var i=Ut(Ul,{style:"",width:"0",height:"0","pointer-events":"all",position:Vr});n.canvas=i;var e=n.classes.join(" ");n.instance.addClass(i,e);for(var t=n.endpoint.scope.split(/\s/),r=0;r<t.length;r++)n.instance.setAttribute(i,Il+t[r],Xl);return n.instance._appendElementToContainer(i),n.cssClass!=null&&n.instance.addClass(i,n.cssClass),n.instance.addClass(i,n.instance.endpointClass),i.jtk=i.jtk||{},i.jtk.endpoint=n.endpoint,i.style.display=n.endpoint.visible!==!1?Fo:tr,i}},{key:"paint",value:function(n,i,e){if(n.endpoint.deleted!==!0){this.getEndpointElement(n),uu.paint(n,n.instance,e);var t=W({},e);t.outlineStroke&&(t.stroke=t.outlineStroke),n.node==null?(n.node=i.makeNode(n,t),n.canvas.appendChild(n.node)):i.updateNode!=null&&i.updateNode(n,n.node),Uo(n.canvas,n.node,t)}}}]),a}(),oo=function(){function a(o,n){X(this,a),this.connection=o,d(this,"type",void 0),d(this,"edited",!1),d(this,"stub",void 0),d(this,"sourceStub",void 0),d(this,"targetStub",void 0),d(this,"maxStub",void 0),d(this,"typeId",void 0),d(this,"gap",void 0),d(this,"sourceGap",void 0),d(this,"targetGap",void 0),d(this,"segments",[]),d(this,"totalLength",0),d(this,"segmentProportions",[]),d(this,"segmentProportionalLengths",[]),d(this,"paintInfo",null),d(this,"strokeWidth",void 0),d(this,"x",void 0),d(this,"y",void 0),d(this,"w",void 0),d(this,"h",void 0),d(this,"segment",void 0),d(this,"bounds",Ui()),d(this,"cssClass",void 0),d(this,"hoverClass",void 0),d(this,"geometry",void 0),this.stub=n.stub||this.getDefaultStubs(),this.sourceStub=Array.isArray(this.stub)?this.stub[0]:this.stub,this.targetStub=Array.isArray(this.stub)?this.stub[1]:this.stub,this.gap=n.gap||0,this.sourceGap=Array.isArray(this.gap)?this.gap[0]:this.gap,this.targetGap=Array.isArray(this.gap)?this.gap[1]:this.gap,this.maxStub=Math.max(this.sourceStub,this.targetStub),this.cssClass=n.cssClass||"",this.hoverClass=n.hoverClass||""}return J(a,[{key:"getTypeDescriptor",value:function(){return"connector"}},{key:"getIdPrefix",value:function(){return"_jsplumb_connector"}},{key:"setGeometry",value:function(n,i){this.geometry=n,this.edited=n!=null&&!i}},{key:"exportGeometry",value:function(){return this.geometry}},{key:"importGeometry",value:function(n){return this.geometry=n,!0}},{key:"resetGeometry",value:function(){this.geometry=null,this.edited=!1}},{key:"transformAnchorPlacement",value:function(n,i,e){return{x:n.x,y:n.y,ox:n.ox,oy:n.oy,curX:n.curX+i,curY:n.curY+e}}},{key:"resetBounds",value:function(){this.bounds=Ui()}},{key:"findSegmentForPoint",value:function(n,i){for(var e={d:1/0,s:null,x:null,y:null,l:null,x1:null,y1:null,x2:null,y2:null,index:null,connectorLocation:null},t=0;t<this.segments.length;t++){var r=this.segments[t].findClosestPointOnPath(n,i);r.d<e.d&&(e.d=r.d,e.l=r.l,e.x=r.x,e.y=r.y,e.s=this.segments[t],e.x1=r.x1,e.x2=r.x2,e.y1=r.y1,e.y2=r.y2,e.index=t,e.connectorLocation=this.segmentProportions[t][0]+r.l*(this.segmentProportions[t][1]-this.segmentProportions[t][0]))}return e}},{key:"lineIntersection",value:function(n,i,e,t){for(var r=[],s=0;s<this.segments.length;s++)r.push.apply(r,this.segments[s].lineIntersection(n,i,e,t));return r}},{key:"boxIntersection",value:function(n,i,e,t){for(var r=[],s=0;s<this.segments.length;s++)r.push.apply(r,this.segments[s].boxIntersection(n,i,e,t));return r}},{key:"boundingBoxIntersection",value:function(n){for(var i=[],e=0;e<this.segments.length;e++)i.push.apply(i,this.segments[e].boundingBoxIntersection(n));return i}},{key:"_updateSegmentProportions",value:function(){for(var n=0,i=0;i<this.segments.length;i++){var e=this.segments[i].getLength();this.segmentProportionalLengths[i]=e/this.totalLength,this.segmentProportions[i]=[n,n+=e/this.totalLength]}}},{key:"_findSegmentForLocation",value:function(n,i){var e,t,r;if(i&&(n=n>0?n/this.totalLength:(this.totalLength+n)/this.totalLength),n===1)e=this.segments.length-1,r=1;else if(n===0)r=0,e=0;else if(n>=.5){for(e=0,r=0,t=this.segmentProportions.length-1;t>-1;t--)if(this.segmentProportions[t][1]>=n&&this.segmentProportions[t][0]<=n){e=t,r=(n-this.segmentProportions[t][0])/this.segmentProportionalLengths[t];break}}else for(e=this.segmentProportions.length-1,r=1,t=0;t<this.segmentProportions.length;t++)if(this.segmentProportions[t][1]>=n){e=t,r=(n-this.segmentProportions[t][0])/this.segmentProportionalLengths[t];break}return{segment:this.segments[e],proportion:r,index:e}}},{key:"_addSegment",value:function(n,i){if(!(i.x1===i.x2&&i.y1===i.y2)){var e=new n(i);this.segments.push(e),this.totalLength+=e.getLength(),this.updateBounds(e)}}},{key:"_clearSegments",value:function(){this.totalLength=0,this.segments.length=0,this.segmentProportions.length=0,this.segmentProportionalLengths.length=0}},{key:"getLength",value:function(){return this.totalLength}},{key:"_prepareCompute",value:function(n){this.strokeWidth=n.strokeWidth;var i=n.sourcePos.curX,e=n.targetPos.curX,t=n.sourcePos.curY,r=n.targetPos.curY,s=Sa({x:i,y:t},{x:e,y:r}),l=e<i,u=r<t,c=[n.sourcePos.ox,n.sourcePos.oy],f=[n.targetPos.ox,n.targetPos.oy],h=l?e:i,v=u?r:t,p=Math.abs(e-i),y=Math.abs(r-t),g=c[0]===0&&c[1]===0,E=f[0]===0&&f[1]===0;if(g||E){var b=p>y?0:1,x=[1,0][b],S=b===0?i:t,C=b===0?e:r;g&&(c[b]=S>C?-1:1,c[x]=0),E&&(f[b]=S>C?1:-1,f[x]=0)}var T=l?p+this.sourceGap*c[0]:this.sourceGap*c[0],O=u?y+this.sourceGap*c[1]:this.sourceGap*c[1],P=l?this.targetGap*f[0]:p+this.targetGap*f[0],D=u?this.targetGap*f[1]:y+this.targetGap*f[1],I=c[0]*f[0]+c[1]*f[1],G={sx:T,sy:O,tx:P,ty:D,xSpan:Math.abs(P-T),ySpan:Math.abs(D-O),mx:(T+P)/2,my:(O+D)/2,so:c,to:f,x:h,y:v,w:p,h:y,segment:s,startStubX:T+c[0]*this.sourceStub,startStubY:O+c[1]*this.sourceStub,endStubX:P+f[0]*this.targetStub,endStubY:D+f[1]*this.targetStub,isXGreaterThanStubTimes2:Math.abs(T-P)>this.sourceStub+this.targetStub,isYGreaterThanStubTimes2:Math.abs(O-D)>this.sourceStub+this.targetStub,opposite:I===-1,perpendicular:I===0,orthogonal:I===1,sourceAxis:c[0]===0?"y":"x",points:[h,v,p,y,T,O,P,D],stubs:[this.sourceStub,this.targetStub]};return G.anchorOrientation=G.opposite?"opposite":G.orthogonal?"orthogonal":"perpendicular",G}},{key:"updateBounds",value:function(n){var i=n.extents;this.bounds.xmin=Math.min(this.bounds.xmin,i.xmin),this.bounds.xmax=Math.max(this.bounds.xmax,i.xmax),this.bounds.ymin=Math.min(this.bounds.ymin,i.ymin),this.bounds.ymax=Math.max(this.bounds.ymax,i.ymax)}},{key:"dumpSegmentsToConsole",value:function(){Ue("SEGMENTS:");for(var n=0;n<this.segments.length;n++)Ue(this.segments[n].type,""+this.segments[n].getLength(),""+this.segmentProportions[n])}},{key:"pointOnPath",value:function(n,i){var e=this._findSegmentForLocation(n,i);return e.segment&&e.segment.pointOnPath(e.proportion,!1)||{x:0,y:0}}},{key:"gradientAtPoint",value:function(n,i){var e=this._findSegmentForLocation(n,i);return e.segment&&e.segment.gradientAtPoint(e.proportion,!1)||0}},{key:"pointAlongPathFrom",value:function(n,i,e){var t=this._findSegmentForLocation(n,e);return t.segment&&t.segment.pointAlongPathFrom(t.proportion,i,!1)||{x:0,y:0}}},{key:"compute",value:function(n){this.paintInfo=this._prepareCompute(n),this._clearSegments(),this._compute(this.paintInfo,n),this.x=this.paintInfo.points[0],this.y=this.paintInfo.points[1],this.w=this.paintInfo.points[2],this.h=this.paintInfo.points[3],this.segment=this.paintInfo.segment,this._updateSegmentProportions()}},{key:"setAnchorOrientation",value:function(n,i){}}]),a}(),Zd=20,Jd=20,or=function(a){be(n,a);var o=xe(n);function n(i,e,t){var r;return X(this,n),r=o.call(this,i,e,t),r.instance=i,r.component=e,d(m(r),"width",void 0),d(m(r),"length",void 0),d(m(r),"foldback",void 0),d(m(r),"direction",void 0),d(m(r),"location",.5),d(m(r),"paintStyle",void 0),d(m(r),"type",n.type),d(m(r),"cachedDimensions",void 0),t=t||{},r.width=t.width||Zd,r.length=t.length||Jd,r.direction=(t.direction||1)<0?-1:1,r.foldback=t.foldback||.623,r.paintStyle=t.paintStyle||{strokeWidth:1},r.location=t.location==null?r.location:Array.isArray(t.location)?t.location[0]:t.location,r}return J(n,[{key:"draw",value:function(e,t,r){if(e instanceof oo){var s=e,l,u,c,f,h;if(this.location>1||this.location<0){var v=this.location<0?1:0;l=s.pointAlongPathFrom(v,this.location,!1),u=s.pointAlongPathFrom(v,this.location-this.direction*this.length/2,!1),c=yn(l,u,this.length)}else if(this.location===1){if(l=s.pointOnPath(this.location),u=s.pointAlongPathFrom(this.location,-this.length),c=yn(l,u,this.length),this.direction===-1){var p=c;c=l,l=p}}else if(this.location===0){if(c=s.pointOnPath(this.location),u=s.pointAlongPathFrom(this.location,this.length),l=yn(c,u,this.length),this.direction===-1){var y=c;c=l,l=y}}else l=s.pointAlongPathFrom(this.location,this.direction*this.length/2),u=s.pointOnPath(this.location),c=yn(l,u,this.length);f=Mh(l,c,this.width),h=yn(l,c,this.foldback*this.length);var g={hxy:l,tail:f,cxy:h},E=this.paintStyle.stroke||t.stroke,b=this.paintStyle.fill||t.stroke,x=this.paintStyle.strokeWidth||t.strokeWidth;return{component:e,d:g,"stroke-width":x,stroke:E,fill:b,xmin:Math.min(l.x,f[0].x,f[1].x),xmax:Math.max(l.x,f[0].x,f[1].x),ymin:Math.min(l.y,f[0].y,f[1].y),ymax:Math.max(l.y,f[0].y,f[1].y)}}}},{key:"updateFrom",value:function(e){}}]),n}(io);d(or,"type","Arrow");function $o(a){return a.type===or.type}On.register(or.type,or);var Wi=function(a){be(n,a);var o=xe(n);function n(i,e,t){var r;return X(this,n),r=o.call(this,i,e,t),r.instance=i,d(m(r),"type",n.type),r.length=r.length/2,r.foldback=2,r}return n}(or);d(Wi,"type","Diamond");function Wo(a){return a.type===Wi.type}On.register(Wi.type,Wi);var _a=function(a){be(n,a);var o=xe(n);function n(i,e,t){var r;return X(this,n),r=o.call(this,i,e,t),r.instance=i,d(m(r),"type",n.type),r.foldback=1,r}return n}(or);d(_a,"type","PlainArrow");function Ko(a){return a.type===_a.type}On.register("PlainArrow",_a);var Ki=function(a){be(n,a);var o=xe(n);function n(i,e,t){var r;return X(this,n),r=o.call(this,i,e,t),r.instance=i,r.component=e,d(m(r),"create",void 0),d(m(r),"type",n.type),r.create=t.create,r}return J(n,[{key:"updateFrom",value:function(e){}}]),n}(io);d(Ki,"type","Custom");function $t(a){return a.type===Ki.type}On.register(Ki.type,Ki);var Qd="allowNestedGroups",Bn="paintStyle",qd="scope",Dn=function(a){be(n,a);var o=xe(n);function n(i,e){var t;return X(this,n),t=o.call(this,i,e),d(m(t),"radius",void 0),d(m(t),"defaultOffset",void 0),d(m(t),"defaultInnerRadius",void 0),d(m(t),"type",n.type),e=e||{},t.radius=e.radius||5,t.defaultOffset=.5*t.radius,t.defaultInnerRadius=t.radius/3,t}return n}(ar);d(Dn,"type","Dot");var ev={type:Dn.type,cls:Dn,compute:function(o,n,i,e){var t=n.curX-o.radius,r=n.curY-o.radius,s=o.radius*2,l=o.radius*2;if(e&&e.stroke){var u=e.strokeWidth||1;t-=u,r-=u,s+=u*2,l+=u*2}return o.x=t,o.y=r,o.w=s,o.h=l,[t,r,s,l,o.radius]},getParams:function(o){return{radius:o.radius}}},Ao=function a(o,n){X(this,a),this.instance=o,this.el=n,d(this,"group",void 0)},tv=function(a){be(n,a);var o=xe(n);function n(i,e,t){var r;X(this,n),r=o.call(this,i,e),r.instance=i,d(m(r),"children",[]),d(m(r),"collapsed",!1),d(m(r),"droppable",void 0),d(m(r),"enabled",void 0),d(m(r),"orphan",void 0),d(m(r),"constrain",void 0),d(m(r),"proxied",void 0),d(m(r),"ghost",void 0),d(m(r),"revert",void 0),d(m(r),"prune",void 0),d(m(r),"dropOverride",void 0),d(m(r),"anchor",void 0),d(m(r),"endpoint",void 0),d(m(r),"connections",{source:[],target:[],internal:[]}),d(m(r),"manager",void 0),d(m(r),"id",void 0),d(m(r),"elId",void 0);var s=r.el;return s._isJsPlumbGroup=!0,s._jsPlumbGroup=m(r),r.elId=i.getId(e),r.orphan=t.orphan===!0,r.revert=r.orphan===!0?!1:t.revert!==!1,r.droppable=t.droppable!==!1,r.ghost=t.ghost===!0,r.enabled=t.enabled!==!1,r.prune=r.orphan!==!0&&t.prune===!0,r.constrain=r.ghost||t.constrain===!0,r.proxied=t.proxied!==!1,r.id=t.id||He(),r.dropOverride=t.dropOverride===!0,r.anchor=t.anchor,r.endpoint=t.endpoint,r.anchor=t.anchor,i.setAttribute(e,_l,""),r}return J(n,[{key:"contentArea",get:function(){return this.instance.getGroupContentArea(this)}},{key:"overrideDrop",value:function(e,t){return this.dropOverride&&(this.revert||this.prune||this.orphan)}},{key:"getAnchor",value:function(e,t){return this.anchor||"Continuous"}},{key:"getEndpoint",value:function(e,t){return this.endpoint||{type:Dn.type,options:{radius:10}}}},{key:"add",value:function(e,t){var r=this.instance.getGroupContentArea(this),s=e;if(s._jsPlumbParentGroup!=null){if(s._jsPlumbParentGroup===this)return;s._jsPlumbParentGroup.remove(e,!0,t,!1)}s._jsPlumbParentGroup=this,this.children.push(new Ao(this.instance,e)),this.instance._appendElement(s,r),this.manager._updateConnectionsForGroup(this)}},{key:"resolveNode",value:function(e){return e==null?null:ua(this.children,function(t){return t.el===e})}},{key:"remove",value:function(e,t,r,s,l){var u=this.resolveNode(e);u!=null&&this._doRemove(u,t,r,s,l)}},{key:"_doRemove",value:function(e,t,r,s,l){var u=e.el;if(delete u._jsPlumbParentGroup,Ye(this.children,function(f){return f===e}),t)try{this.instance.getGroupContentArea(this).removeChild(u)}catch(f){Ue("Could not remove element from Group "+f)}if(!r){var c={group:this,el:u};l&&(c.targetGroup=l),this.instance.fire(pf,c)}s||this.manager._updateConnectionsForGroup(this)}},{key:"removeAll",value:function(e,t){for(var r=0,s=this.children.length;r<s;r++){var l=this.children[0];this._doRemove(l,e,t,!0),this.instance.unmanage(l.el,!0)}this.children.length=0,this.manager._updateConnectionsForGroup(this)}},{key:"orphanAll",value:function(){for(var e={},t=0;t<this.children.length;t++){var r=this.manager.orphan(this.children[t].el,!1);e[r.id]=r.pos}return this.children.length=0,e}},{key:"addGroup",value:function(e){if(this.instance.allowNestedGroups&&e!==this){if(this.instance.groupManager.isAncestor(this,e))return!1;e.group!=null&&e.group.removeGroup(e);var t=this.instance.getId(e.el),r=this.instance.getManagedElements()[t];r.group=this.elId;var s=this.instance.getOffsetRelativeToRoot(e.el),l=this.collapsed?this.instance.getOffsetRelativeToRoot(this.el):this.instance.getOffsetRelativeToRoot(this.instance.getGroupContentArea(this));e.el._jsPlumbParentGroup=this,this.children.push(e),this.instance._appendElementToGroup(this,e.el),e.group=this;var u={x:s.x-l.x,y:s.y-l.y};return this.instance.setPosition(e.el,u),this.instance.fire(yf,{parent:this,child:e}),!0}else return!1}},{key:"removeGroup",value:function(e){if(e.group===this){var t=e.el,r=this.instance.getGroupContentArea(this);r===t.parentNode&&r.removeChild(e.el);var s=this.instance.getId(e.el),l=this.instance.getManagedElements()[s];l&&delete l.group,this.children=this.children.filter(function(u){return u.id!==e.id}),delete e.group,delete t._jsPlumbParentGroup,this.instance.fire(mf,{parent:this,child:e})}}},{key:"getGroups",value:function(){return this.children.filter(function(e){return e.constructor===n})}},{key:"getNodes",value:function(){return this.children.filter(function(e){return e.constructor===Ao})}},{key:"collapseParent",get:function(){var e=null;if(this.group==null)return null;for(var t=this.group;t!=null;)t.collapsed&&(e=t),t=t.group;return e}}]),n}(Ao),nv=function(){function a(o){var n=this;X(this,a),this.instance=o,d(this,"groupMap",{}),d(this,"_connectionSourceMap",{}),d(this,"_connectionTargetMap",{}),o.bind(wl,function(i){var e=n.getGroupFor(i.source),t=n.getGroupFor(i.target);e!=null&&t!=null&&e===t?(n._connectionSourceMap[i.connection.id]=e,n._connectionTargetMap[i.connection.id]=e,gr(e.connections.internal,i.connection)):(e!=null&&(i.target._jsPlumbGroup===e?gr(e.connections.internal,i.connection):gr(e.connections.source,i.connection),n._connectionSourceMap[i.connection.id]=e),t!=null&&(i.source._jsPlumbGroup===t?gr(t.connections.internal,i.connection):gr(t.connections.target,i.connection),n._connectionTargetMap[i.connection.id]=t))}),o.bind(ga,function(i){n._cleanupDetachedConnection(i.connection)}),o.bind(pa,function(i){var e=i.originalEndpoint.element,t=n.getGroupFor(e),r=i.connection.endpoints[i.index],s=r.element,l=n.getGroupFor(s),u=i.index===0?n._connectionSourceMap:n._connectionTargetMap,c=i.index===0?n._connectionTargetMap:n._connectionSourceMap;l!=null?(u[i.connection.id]=l,i.connection.source===i.connection.target&&(c[i.connection.id]=l)):(delete u[i.connection.id],i.connection.source===i.connection.target&&delete c[i.connection.id]),t!=null&&n._updateConnectionsForGroup(t),l!=null&&n._updateConnectionsForGroup(l)})}return J(a,[{key:"_cleanupDetachedConnection",value:function(n){n.proxies.length=0;var i=this._connectionSourceMap[n.id],e;i!=null&&(e=function(r){return r.id===n.id},Ye(i.connections.source,e),Ye(i.connections.target,e),Ye(i.connections.internal,e),delete this._connectionSourceMap[n.id]),i=this._connectionTargetMap[n.id],i!=null&&(e=function(r){return r.id===n.id},Ye(i.connections.source,e),Ye(i.connections.target,e),Ye(i.connections.internal,e),delete this._connectionTargetMap[n.id])}},{key:"addGroup",value:function(n){var i=n.el;if(this.groupMap[n.id]!=null)throw new Error("cannot create Group ["+n.id+"]; a Group with that ID exists");if(i._isJsPlumbGroup!=null)throw new Error("cannot create Group ["+n.id+"]; the given element is already a Group");var e=new tv(this.instance,n.el,n);return this.groupMap[e.id]=e,n.collapsed&&this.collapseGroup(e),this.instance.manage(e.el),this.instance.addClass(e.el,Er),e.manager=this,this._updateConnectionsForGroup(e),this.instance.fire(ff,{group:e}),e}},{key:"getGroup",value:function(n){var i=n;if(Ne(n)&&(i=this.groupMap[n],i==null))throw new Error("No such group ["+n+"]");return i}},{key:"getGroupFor",value:function(n){for(var i=n,e=this.instance.getContainer(),t=!1,r=null;!t;)i==null||i===e?t=!0:i._jsPlumbParentGroup?(r=i._jsPlumbParentGroup,t=!0):i=i.parentNode;return r}},{key:"getGroups",value:function(){var n=[];for(var i in this.groupMap)n.push(this.groupMap[i]);return n}},{key:"removeGroup",value:function(n,i,e,t){var r=this,s=this.getGroup(n);this.expandGroup(s,!0);var l={};return K(s.children,function(u){var c=r.instance.getManagedElements()[r.instance.getId(u.el)];c&&delete c.group}),i?(K(s.getGroups(),function(u){return r.removeGroup(u,i,e)}),s.removeAll(e,t)):(s.group&&K(s.children,function(u){return s.group.add(u.el)}),l=s.orphanAll()),s.group&&s.group.removeGroup(s),this.instance.unmanage(s.el,!0),delete this.groupMap[s.id],this.instance.fire(gf,{group:s}),l}},{key:"removeAllGroups",value:function(n,i,e){for(var t in this.groupMap)this.removeGroup(this.groupMap[t],n,i,e)}},{key:"forEach",value:function(n){for(var i in this.groupMap)n(this.groupMap[i])}},{key:"orphan",value:function(n,i){var e=n;if(e._jsPlumbParentGroup){var t=e._jsPlumbParentGroup,r=this.instance.getId(e),s=this.instance.getOffset(n);return i!==!0&&t.group?this.instance._appendElementToGroup(t.group,n):this.instance._appendElementToContainer(n),this.instance.setPosition(n,s),delete e._jsPlumbParentGroup,{id:r,pos:s}}}},{key:"_updateConnectionsForGroup",value:function(n){var i=this;n.connections.source.length=0,n.connections.target.length=0,n.connections.internal.length=0;var e=n.children.slice().map(function(h){return h.el}),t=[];if(K(e,function(h){Array.prototype.push.apply(t,i.instance.getSelector(h,Ae))}),Array.prototype.push.apply(e,t),e.length>0){var r=this.instance.getConnections({source:e,scope:mn},!0),s=this.instance.getConnections({target:e,scope:mn},!0),l={},u,c,f=function(v){for(var p=0;p<v.length;p++)l[v[p].id]||(l[v[p].id]=!0,u=i.getGroupFor(v[p].source),c=i.getGroupFor(v[p].target),v[p].source===n.el&&c===n||v[p].target===n.el&&u===n?n.connections.internal.push(v[p]):u===n?(c!==n?n.connections.source.push(v[p]):n.connections.internal.push(v[p]),i._connectionSourceMap[v[p].id]=n):c===n&&(n.connections.target.push(v[p]),i._connectionTargetMap[v[p].id]=n))};f(r),f(s)}}},{key:"_collapseConnection",value:function(n,i,e){var t=n.endpoints[i===0?1:0].element;if(t._jsPlumbParentGroup&&!t._jsPlumbParentGroup.proxied&&t._jsPlumbParentGroup.collapsed)return!1;var r=n.endpoints[0].element,s=r._jsPlumbParentGroup,l=s!=null?s.collapseParent||s:null,u=n.endpoints[1].element,c=u._jsPlumbParentGroup,f=c!=null?c.collapseParent||c:null;if(l==null||f==null||l.id!==f.id){var h=e.el;return this.instance.getId(h),this.instance.proxyConnection(n,i,h,function(v,p){return e.getEndpoint(v,p)},function(v,p){return e.getAnchor(v,p)}),!0}else return!1}},{key:"_expandConnection",value:function(n,i,e){this.instance.unproxyConnection(n,i)}},{key:"isElementDescendant",value:function(n,i){for(var e=this.instance.getContainer(),t=!1;!t;){if(n==null||n===e)return!1;if(n===i)return!0;n=n.parentNode}}},{key:"collapseGroup",value:function(n){var i=this,e=this.getGroup(n);if(!(e==null||e.collapsed)){var t=e.el;if(e.collapseParent==null){if(this.instance.setGroupVisible(e,!1),e.collapsed=!0,this.instance.removeClass(t,Er),this.instance.addClass(t,fi),e.proxied){var r=new Set,s=function(u,c){for(var f=0;f<u.length;f++){var h=u[f];i._collapseConnection(h,c,e)===!0&&r.add(h.id)}};s(e.connections.source,0),s(e.connections.target,1),K(e.getGroups(),function(l){i.cascadeCollapse(e,l,r)})}this.instance.revalidate(t),this.repaintGroup(e),this.instance.fire(hf,{group:e})}else e.collapsed=!0,this.instance.removeClass(t,Er),this.instance.addClass(t,fi)}}},{key:"cascadeCollapse",value:function(n,i,e){var t=this;if(n.proxied){var r=function(l,u){for(var c=0;c<l.length;c++){var f=l[c];e.has(f.id)||t._collapseConnection(f,u,n)===!0&&e.add(f.id)}};r(i.connections.source,0),r(i.connections.target,1)}K(i.getGroups(),function(s){t.cascadeCollapse(n,s,e)})}},{key:"expandGroup",value:function(n,i){var e=this,t=this.getGroup(n);if(t!=null){var r=t.el;if(t.collapseParent==null){if(this.instance.setGroupVisible(t,!0),t.collapsed=!1,this.instance.addClass(r,Er),this.instance.removeClass(r,fi),t.proxied){var s=function(c,f){for(var h=0;h<c.length;h++){var v=c[h];e._expandConnection(v,f,t)}};s(t.connections.source,0),s(t.connections.target,1);var l=function u(c,f){if(f||c.collapsed){var h=function(p,y){for(var g=0;g<p.length;g++){var E=p[g];e._collapseConnection(E,y,c.collapseParent||c)}};h(c.connections.source,0),h(c.connections.target,1),K(c.connections.internal,function(v){return v.setVisible(!1)}),K(c.getGroups(),function(v){return u(v,!0)})}else e.expandGroup(c,!0)};K(t.getGroups(),l)}this.instance.revalidate(r),this.repaintGroup(t),i||this.instance.fire(df,{group:t})}else t.collapsed=!1,this.instance.addClass(r,Er),this.instance.removeClass(r,fi)}}},{key:"toggleGroup",value:function(n){n=this.getGroup(n),n!=null&&(n.collapsed?this.expandGroup(n):this.collapseGroup(n))}},{key:"repaintGroup",value:function(n){for(var i=this.getGroup(n),e=i.children,t=0;t<e.length;t++)this.instance.revalidate(e[t].el)}},{key:"addToGroup",value:function(n,i){var e=this,t=this.getGroup(n);if(t){for(var r=t.el,s=function(h){var v=h,p=v._isJsPlumbGroup!=null,y=v._jsPlumbGroup,g=v._jsPlumbParentGroup;if(g!==t){var E=e.instance.manage(h),b=e.instance.getOffset(h),x=t.collapsed?e.instance.getOffsetRelativeToRoot(r):e.instance.getOffset(e.instance.getGroupContentArea(t));E.group=t.elId,g!=null&&(g.remove(h,!1,i,!1,t),e._updateConnectionsForGroup(g)),p?t.addGroup(y):t.add(h,i);var S=function(P,D){var I=D===0?1:0;P.each(function(G){G.setVisible(!1),G.endpoints[I].element._jsPlumbGroup===t?(G.endpoints[I].setVisible(!1),e._expandConnection(G,I,t)):(G.endpoints[D].setVisible(!1),e._collapseConnection(G,D,t))})};t.collapsed&&(S(e.instance.select({source:h}),0),S(e.instance.select({target:h}),1)),e.instance.getId(h);var C={x:b.x-x.x,y:b.y-x.y};if(e.instance.setPosition(h,C),e._updateConnectionsForGroup(t),e.instance.revalidate(h),!i){var T={group:t,el:h,pos:C};g&&(T.sourceGroup=g),e.instance.fire(vf,T)}}},l=arguments.length,u=new Array(l>2?l-2:0),c=2;c<l;c++)u[c-2]=arguments[c];K(u,s)}}},{key:"removeFromGroup",value:function(n,i){var e=this,t=this.getGroup(n);if(t){for(var r=function(f){if(t.collapsed){var h=function(y,g){for(var E=0;E<y.length;E++){var b=y[E];if(b.proxies){for(var x=0;x<b.proxies.length;x++)if(b.proxies[x]!=null){var S=b.proxies[x].originalEp.element;(S===f||e.isElementDescendant(S,f))&&e._expandConnection(b,g,t)}}}};h(t.connections.source.slice(),0),h(t.connections.target.slice(),1)}t.remove(f,null,i);var v=e.instance.getManagedElements()[e.instance.getId(f)];v&&delete v.group},s=arguments.length,l=new Array(s>2?s-2:0),u=2;u<s;u++)l[u-2]=arguments[u];K(l,r)}}},{key:"getAncestors",value:function(n){for(var i=[],e=n.group;e!=null;)i.push(e),e=e.group;return i}},{key:"isAncestor",value:function(n,i){return n==null||i==null?!1:this.getAncestors(n).indexOf(i)!==-1}},{key:"getDescendants",value:function(n){var i=[],e=function t(r){var s=r.getGroups();i.push.apply(i,qn(s)),K(s,t)};return e(n),i}},{key:"isDescendant",value:function(n,i){return n==null||i==null?!1:this.getDescendants(i).indexOf(n)!==-1}},{key:"reset",value:function(){this._connectionSourceMap={},this._connectionTargetMap={},this.groupMap={}}}]),a}(),cu=function(){function a(o,n){X(this,a),this.instance=o,this.entries=n}return J(a,[{key:"length",get:function(){return this.entries.length}},{key:"each",value:function(n){return K(this.entries,function(i){return n(i)}),this}},{key:"get",value:function(n){return this.entries[n]}},{key:"addClass",value:function(n,i){return this.each(function(e){return e.addClass(n,i)}),this}},{key:"removeClass",value:function(n,i){return this.each(function(e){return e.removeClass(n,i)}),this}},{key:"removeAllOverlays",value:function(){return this.each(function(n){return n.removeAllOverlays()}),this}},{key:"setLabel",value:function(n){return this.each(function(i){return i.setLabel(n)}),this}},{key:"clear",value:function(){return this.entries.length=0,this}},{key:"map",value:function(n){var i=[];return this.each(function(e){return i.push(n(e))}),i}},{key:"addOverlay",value:function(n){return this.each(function(i){return i.addOverlay(n)}),this}},{key:"removeOverlay",value:function(n){return this.each(function(i){return i.removeOverlay(n)}),this}},{key:"removeOverlays",value:function(){return this.each(function(n){return n.removeOverlays()}),this}},{key:"showOverlay",value:function(n){return this.each(function(i){return i.showOverlay(n)}),this}},{key:"hideOverlay",value:function(n){return this.each(function(i){return i.hideOverlay(n)}),this}},{key:"setPaintStyle",value:function(n){return this.each(function(i){return i.setPaintStyle(n)}),this}},{key:"setHoverPaintStyle",value:function(n){return this.each(function(i){return i.setHoverPaintStyle(n)}),this}},{key:"setSuspendEvents",value:function(n){return this.each(function(i){return i.setSuspendEvents(n)}),this}},{key:"setParameter",value:function(n,i){return this.each(function(e){return e.parameters[n]=i}),this}},{key:"setParameters",value:function(n){return this.each(function(i){return i.parameters=n}),this}},{key:"setVisible",value:function(n){return this.each(function(i){return i.setVisible(n)}),this}},{key:"addType",value:function(n){return this.each(function(i){return i.addType(n)}),this}},{key:"toggleType",value:function(n){return this.each(function(i){return i.toggleType(n)}),this}},{key:"removeType",value:function(n){return this.each(function(i){return i.removeType(n)}),this}},{key:"bind",value:function(n,i){return this.each(function(e){return e.bind(n,i)}),this}},{key:"unbind",value:function(n,i){return this.each(function(e){return e.unbind(n,i)}),this}},{key:"setHover",value:function(n){var i=this;return this.each(function(e){return i.instance.setHover(e,n)}),this}}]),a}(),rv=function(a){be(n,a);var o=xe(n);function n(){return X(this,n),o.apply(this,arguments)}return J(n,[{key:"setEnabled",value:function(e){return this.each(function(t){return t.enabled=e}),this}},{key:"setAnchor",value:function(e){return this.each(function(t){return t.setAnchor(e)}),this}},{key:"deleteEveryConnection",value:function(){return this.each(function(e){return e.deleteEveryConnection()}),this}},{key:"deleteAll",value:function(){var e=this;return this.each(function(t){return e.instance.deleteEndpoint(t)}),this.clear(),this}}]),n}(cu),iv=function(a){be(n,a);var o=xe(n);function n(){return X(this,n),o.apply(this,arguments)}return J(n,[{key:"setDetachable",value:function(e){return this.each(function(t){return t.setDetachable(e)}),this}},{key:"setReattach",value:function(e){return this.each(function(t){return t.setReattach(e)}),this}},{key:"setConnector",value:function(e){return this.each(function(t){return t._setConnector(e)}),this}},{key:"deleteAll",value:function(){var e=this;this.each(function(t){return e.instance.deleteConnection(t)}),this.clear()}},{key:"repaint",value:function(){var e=this;return this.each(function(t){return e.instance._paintConnection(t)}),this}}]),n}(cu),ov=function a(){X(this,a),d(this,"affectedElements",new Set)};function ws(){return{x:0,y:0,w:0,h:0,r:0,c:{x:0,y:0},x2:0,y2:0,t:{x:0,y:0,c:{x:0,y:0},w:0,h:0,r:0,x2:0,y2:0,cr:0,sr:0},dirty:!0}}function av(a,o,n,i,e){var t={x:a+n/2,y:o+i/2},r=Math.cos(e/360*Math.PI*2),s=Math.sin(e/360*Math.PI*2),l=function(x,S){return{x:t.x+Math.round((x-t.x)*r-(S-t.y)*s),y:t.y+Math.round((S-t.y)*r-(x-t.x)*s)}},u=l(a,o),c=l(a+n,o),f=l(a+n,o+i),h=l(a,o+i),v=l(a+n/2,o+i/2),p=Math.min(u.x,c.x,f.x,h.x),y=Math.max(u.x,c.x,f.x,h.x),g=Math.min(u.y,c.y,f.y,h.y),E=Math.max(u.y,c.y,f.y,h.y);return{x:p,y:g,w:y-p,h:E-g,c:v,r:e,x2:y,y2:E,cr:r,sr:s}}var zi=function(o,n){var i=0;return n[1]>o[1]?i=-1:n[1]<o[1]&&(i=1),i},ks=function(o,n){return zi(o,n)*-1};function pi(a,o,n,i){Uc([a,o],n,zi,i)}function Wt(a,o){var n=rn(o,function(i){return i[0]===a});n>-1&&o.splice(n,1)}var sv=function(a){be(n,a);var o=xe(n);function n(i){var e;return X(this,n),e=o.call(this),e.instance=i,d(m(e),"_currentTransaction",null),d(m(e),"_sortedElements",{xmin:[],xmax:[],ymin:[],ymax:[]}),d(m(e),"_elementMap",new Map),d(m(e),"_transformedElementMap",new Map),d(m(e),"_bounds",{minx:0,maxx:0,miny:0,maxy:0}),e}return J(n,[{key:"_updateBounds",value:function(e,t,r){t!=null&&(Wt(e,this._sortedElements.xmin),Wt(e,this._sortedElements.xmax),Wt(e,this._sortedElements.ymin),Wt(e,this._sortedElements.ymax),pi(e,t.t.x,this._sortedElements.xmin,!1),pi(e,t.t.x+t.t.w,this._sortedElements.xmax,!0),pi(e,t.t.y,this._sortedElements.ymin,!1),pi(e,t.t.y+t.t.h,this._sortedElements.ymax,!0),r!==!0&&this._recalculateBounds())}},{key:"_recalculateBounds",value:function(){this._bounds.minx=this._sortedElements.xmin.length>0?this._sortedElements.xmin[0][1]:0,this._bounds.maxx=this._sortedElements.xmax.length>0?this._sortedElements.xmax[0][1]:0,this._bounds.miny=this._sortedElements.ymin.length>0?this._sortedElements.ymin[0][1]:0,this._bounds.maxy=this._sortedElements.ymax.length>0?this._sortedElements.ymax[0][1]:0}},{key:"recomputeBounds",value:function(){var e=this;this._sortedElements.xmin.length=0,this._sortedElements.xmax.length=0,this._sortedElements.ymin.length=0,this._sortedElements.ymax.length=0,this._elementMap.forEach(function(t,r){e._sortedElements.xmin.push([r,t.t.x]),e._sortedElements.xmax.push([r,t.t.x+t.t.w]),e._sortedElements.ymin.push([r,t.t.y]),e._sortedElements.ymax.push([r,t.t.y+t.t.h])}),this._sortedElements.xmin.sort(zi),this._sortedElements.ymin.sort(zi),this._sortedElements.xmax.sort(ks),this._sortedElements.ymax.sort(ks),this._recalculateBounds()}},{key:"_finaliseUpdate",value:function(e,t,r){t.t=av(t.x,t.y,t.w,t.h,t.r),this._transformedElementMap.set(e,t.t),r!==!0&&this._updateBounds(e,t,r)}},{key:"shouldFireEvent",value:function(e,t,r){return!0}},{key:"startTransaction",value:function(){if(this._currentTransaction!=null)throw new Error("Viewport: cannot start transaction; a transaction is currently active.");this._currentTransaction=new ov}},{key:"endTransaction",value:function(){var e=this;this._currentTransaction!=null&&(this._currentTransaction.affectedElements.forEach(function(t){var r=e.getPosition(t);e._finaliseUpdate(t,r,!0)}),this.recomputeBounds(),this._currentTransaction=null)}},{key:"updateElements",value:function(e){var t=this;K(e,function(r){return t.updateElement(r.id,r.x,r.y,r.width,r.height,r.rotation)})}},{key:"updateElement",value:function(e,t,r,s,l,u,c){var f=Ja(this._elementMap,e,ws);return f.dirty=t==null&&f.x==null||r==null&&f.y==null||s==null&&f.w==null||l==null&&f.h==null,t!=null&&(f.x=t),r!=null&&(f.y=r),s!=null&&(f.w=s),l!=null&&(f.h=l),u!=null&&(f.r=u||0),f.c.x=f.x+f.w/2,f.c.y=f.y+f.h/2,f.x2=f.x+f.w,f.y2=f.y+f.h,this._currentTransaction==null?this._finaliseUpdate(e,f,c):this._currentTransaction.affectedElements.add(e),f}},{key:"refreshElement",value:function(e,t){var r=this.instance.getManagedElements(),s=r[e]?r[e].el:null;if(s!=null){var l=this.getSize(s),u=this.getOffset(s);return this.updateElement(e,u.x,u.y,l.w,l.h,null,t)}else return null}},{key:"getSize",value:function(e){return this.instance.getSize(e)}},{key:"getOffset",value:function(e){return this.instance.getOffset(e)}},{key:"registerElement",value:function(e,t){return this.updateElement(e,0,0,0,0,0,t)}},{key:"addElement",value:function(e,t,r,s,l,u){return this.updateElement(e,t,r,s,l,u)}},{key:"rotateElement",value:function(e,t){var r=Ja(this._elementMap,e,ws);return r.r=t||0,this._finaliseUpdate(e,r),r}},{key:"getBoundsWidth",value:function(){return this._bounds.maxx-this._bounds.minx}},{key:"getBoundsHeight",value:function(){return this._bounds.maxy-this._bounds.miny}},{key:"getX",value:function(){return this._bounds.minx}},{key:"getY",value:function(){return this._bounds.miny}},{key:"setSize",value:function(e,t,r){if(this._elementMap.has(e))return this.updateElement(e,null,null,t,r,null)}},{key:"setPosition",value:function(e,t,r){if(this._elementMap.has(e))return this.updateElement(e,t,r,null,null,null)}},{key:"reset",value:function(){this._sortedElements.xmin.length=0,this._sortedElements.xmax.length=0,this._sortedElements.ymin.length=0,this._sortedElements.ymax.length=0,this._elementMap.clear(),this._transformedElementMap.clear(),this._recalculateBounds()}},{key:"remove",value:function(e){Wt(e,this._sortedElements.xmin),Wt(e,this._sortedElements.xmax),Wt(e,this._sortedElements.ymin),Wt(e,this._sortedElements.ymax),this._elementMap.delete(e),this._transformedElementMap.delete(e),this._recalculateBounds()}},{key:"getPosition",value:function(e){return this._elementMap.get(e)}},{key:"getElements",value:function(){return this._elementMap}},{key:"isEmpty",value:function(){return this._elementMap.size===0}}]),n}(Jr),Un;function lv(a,o,n,i,e){for(var t=n?a.w:a.h,r=n?a.h:a.w,s=[],l=t/(o.length+1),u=0;u<o.length;u++){var c=(u+1)*l,f=i*r;e&&(c=t-c);var h=n?c:f,v=a.x+h,p=h/a.w,y=n?f:c,g=a.y+y,E=y/a.h;if(a.r!==0&&a.r!=null){var b=ji({x:v,y:g},a.c,a.r);v=b.x,g=b.y}s.push({x:v,y:g,xLoc:p,yLoc:E,c:o[u].c})}return s}function Ls(a,o){return o.theta-a.theta}function Ns(a,o){var n=a.theta<0?-Math.PI-a.theta:Math.PI-a.theta,i=o.theta<0?-Math.PI-o.theta:Math.PI-o.theta;return n-i}var uv=(Un={},d(Un,je,Ns),d(Un,ze,Ls),d(Un,tt,Ls),d(Un,Qe,Ns),Un);function Kt(a){return a.isContinuous===!0}function Rs(a){return a.isContinuous===!0}function cv(a){return a.locations.length>1}function Gs(a){return[a.currentLocation,a.locations[a.currentLocation]]}var fv=function(){function a(o){var n=this;X(this,a),this.instance=o,d(this,"anchorLists",new Map),d(this,"anchorLocations",new Map),o.bind(ga,function(i){i.sourceEndpoint._anchor.isContinuous&&n._removeEndpointFromAnchorLists(i.sourceEndpoint),i.targetEndpoint._anchor.isContinuous&&n._removeEndpointFromAnchorLists(i.targetEndpoint)}),o.bind(Ll,function(i){n._removeEndpointFromAnchorLists(i)})}return J(a,[{key:"getAnchorOrientation",value:function(n){var i=this.anchorLocations.get(n.id);return i?[i.ox,i.oy]:[0,0]}},{key:"_distance",value:function(n,i,e,t,r,s,l){var u=t.x+n.x*r.w,c=t.y+n.y*r.h,f=t.x+r.w/2,h=t.y+r.h/2;if(s!=null&&s.length>0){var v=this.instance._applyRotations([u,c,0,0],s);u=v.x,c=v.y}return Math.sqrt(Math.pow(i-u,2)+Math.pow(e-c,2))+Math.sqrt(Math.pow(f-u,2)+Math.pow(h-c,2))}},{key:"_anchorSelector",value:function(n,i,e,t,r,s,l){for(var u=e.x+t.w/2,c=e.y+t.h/2,f=-1,h=1/0,v=0;v<l.length;v++){var p=this._distance(l[v],u,c,n,i,r,s);p<h&&(f=v+0,h=p)}return[f,l[f]]}},{key:"_floatingAnchorCompute",value:function(n,i){var e=i.xy,t={curX:e.x+n.size.w/2,curY:e.y+n.size.h/2,x:0,y:0,ox:0,oy:0};return this._setComputedPosition(n,t)}},{key:"_setComputedPosition",value:function(n,i,e){return this.anchorLocations.set(n.id,i),n.computedPosition=i,e&&(n.timestamp=e),i}},{key:"_computeSingleLocation",value:function(n,i,e,t){var r,s=t.rotation,l={curX:i.x+n.x*e.w+n.offx,curY:i.y+n.y*e.h+n.offy,x:n.x,y:n.y,ox:0,oy:0};if(s!=null&&s.length>0){var u=[n.iox,n.ioy],c={x:l.curX,y:l.curY,cr:0,sr:0};K(s,function(f){c=ji(c,f.c,f.r);var h=[Math.round(u[0]*c.cr-u[1]*c.sr),Math.round(u[1]*c.cr+u[0]*c.sr)];u=h.slice()}),n.ox=u[0],n.oy=u[1],r={curX:c.x,curY:c.y,x:n.x,y:n.y,ox:u[0],oy:u[1]}}else n.ox=n.iox,n.oy=n.ioy,r=W({ox:n.iox,oy:n.ioy},l);return r}},{key:"_singleAnchorCompute",value:function(n,i){var e=i.xy,t=i.wh,r=i.timestamp,s=this.anchorLocations.get(n.id);if(s!=null&&r&&r===n.timestamp)return s;var l=Gs(n),u=Ti(l,2);u[0];var c=u[1];return s=this._computeSingleLocation(c,e,t,i),this._setComputedPosition(n,s,r)}},{key:"_defaultAnchorCompute",value:function(n,i){var e;if(n.locations.length===1)return this._singleAnchorCompute(n,i);var t=i.xy,r=i.wh,s=i.txy,l=i.twh,u=Gs(n),c=Ti(u,2),f=c[0],h=c[1];if(n.locked||s==null||l==null)e=this._computeSingleLocation(h,t,r,i);else{var v=this._anchorSelector(t,r,s,l,i.rotation,i.tRotation,n.locations),p=Ti(v,2),y=p[0],g=p[1];n.currentLocation=y,y!==f&&(n.cssClass=g.cls||n.cssClass,i.element._anchorLocationChanged(n)),e=this._computeSingleLocation(g,t,r,i)}return this._setComputedPosition(n,e,i.timestamp)}},{key:"_placeAnchors",value:function(n,i){var e=this,t=this.instance.viewport.getPosition(n),r=function(l,u,c,f,h,v){if(c.length>0)for(var p=c.sort(uv[l]),y=l===ze||l===je,g=lv(t,p,f,h,y),E=0;E<g.length;E++){var b=g[E].c,x=b.endpoints[0].elementId===n,S=x?b.endpoints[0]:b.endpoints[1];e._setComputedPosition(S._anchor,{curX:g[E].x,curY:g[E].y,x:g[E].xLoc,y:g[E].yLoc,ox:v[0],oy:v[1]})}};r(tt,t,i.bottom,!0,1,[0,1]),r(je,t,i.top,!0,0,[0,-1]),r(Qe,t,i.left,!1,0,[-1,0]),r(ze,t,i.right,!1,1,[1,0])}},{key:"_updateAnchorList",value:function(n,i,e,t,r,s,l,u,c,f,h){var v=t.endpoints[l],p=v.id,y=[1,0][l],g={theta:i,order:e,c:t,b:r,elId:s,epId:p},E=n[c],b=v._continuousAnchorEdge?n[v._continuousAnchorEdge]:null,x;if(b){var S=rn(b,function(P){return P.epId===p});if(S!==-1){b.splice(S,1);for(var C=0;C<b.length;C++)x=b[C].c,x.placeholder!==!0&&f.add(x),h.add(b[C].c.endpoints[l]),h.add(b[C].c.endpoints[y])}}for(var T=0;T<E.length;T++)x=E[T].c,x.placeholder!==!0&&f.add(x),h.add(E[T].c.endpoints[l]),h.add(E[T].c.endpoints[y]);{var O=u?0:E.length;E.splice(O,0,g)}v._continuousAnchorEdge=c}},{key:"_removeEndpointFromAnchorLists",value:function(n){var i=this.anchorLists.get(n.elementId),e=0;(function(t,r){if(t){var s=function(u){return u.epId===r};Ye(t.top,s),Ye(t.left,s),Ye(t.bottom,s),Ye(t.right,s),e+=t.top.length,e+=t.left.length,e+=t.bottom.length,e+=t.right.length}})(i,n.id),e===0&&this.anchorLists.delete(n.elementId),this.anchorLocations.delete(n._anchor.id)}},{key:"computeAnchorLocation",value:function(n,i){var e;return Kt(n)?e=this.anchorLocations.get(n.id)||{curX:0,curY:0,x:0,y:0,ox:0,oy:0}:Rs(n)?e=this._floatingAnchorCompute(n,i):e=this._defaultAnchorCompute(n,i),n.timestamp=i.timestamp,e}},{key:"computePath",value:function(n,i){var e=this.instance.viewport.getPosition(n.sourceId),t=this.instance.viewport.getPosition(n.targetId),r=n.endpoints[0],s=n.endpoints[1],l=this.getEndpointLocation(r,{xy:e,wh:e,element:r,timestamp:i,rotation:this.instance._getRotations(n.sourceId)}),u=this.getEndpointLocation(s,{xy:t,wh:t,element:s,timestamp:i,rotation:this.instance._getRotations(n.targetId)});n.connector.resetBounds(),n.connector.compute({sourcePos:l,targetPos:u,sourceEndpoint:n.endpoints[0],targetEndpoint:n.endpoints[1],strokeWidth:n.paintStyleInUse.strokeWidth,sourceInfo:e,targetInfo:t})}},{key:"getEndpointLocation",value:function(n,i){i=i||{};var e=n._anchor,t=this.anchorLocations.get(e.id);return(t==null||i.timestamp!=null&&e.timestamp!==i.timestamp)&&(t=this.computeAnchorLocation(e,i),this._setComputedPosition(e,t,i.timestamp)),t}},{key:"getEndpointOrientation",value:function(n){return n._anchor?this.getAnchorOrientation(n._anchor):[0,0]}},{key:"setAnchorOrientation",value:function(n,i){var e=this.anchorLocations.get(n.id);e!=null&&(e.ox=i[0],e.oy=i[1])}},{key:"isDynamicAnchor",value:function(n){return n._anchor?!Kt(n._anchor)&&n._anchor.locations.length>1:!1}},{key:"isFloating",value:function(n){return n._anchor?Rs(n._anchor):!1}},{key:"prepareAnchor",value:function(n){return Ir(n)}},{key:"redraw",value:function(n,i,e){var t=this,r=new Set,s=new Set,l=new Set;if(!this.instance._suspendDrawing){var u=this.instance.endpointsByElement[n]||[];i=i||He();for(var c={},f,h,v=0;v<u.length;v++)if(h=u[v],h.visible!==!1)if(s.add(h),f=h._anchor,h.connections.length===0)Kt(f)&&(this.anchorLists.has(n)||this.anchorLists.set(n,{top:[],right:[],bottom:[],left:[]}),this._updateAnchorList(this.anchorLists.get(n),-Math.PI/2,0,{endpoints:[h,h],placeholder:!0},!1,n,0,!1,cd(f),r,s),l.add(n));else for(var p=0;p<h.connections.length;p++){var y=h.connections[p],g=y.sourceId,E=y.targetId,b=Kt(y.endpoints[0]._anchor),x=Kt(y.endpoints[1]._anchor);if(b||x){var S=(y.endpoints[0]._anchor.faces||[]).join("-"),C=(y.endpoints[1]._anchor.faces||[]).join("-"),T=[g,S,E,C].join("-"),O=c[T],P=y.sourceId===n?1:0;b&&!this.anchorLists.has(g)&&this.anchorLists.set(g,{top:[],right:[],bottom:[],left:[]}),x&&!this.anchorLists.has(E)&&this.anchorLists.set(E,{top:[],right:[],bottom:[],left:[]});var D=this.instance.viewport.getPosition(E),I=this.instance.viewport.getPosition(g);if(E===g&&(b||x))this._updateAnchorList(this.anchorLists.get(g),-Math.PI/2,0,y,!1,E,0,!1,je,r,s),this._updateAnchorList(this.anchorLists.get(E),-Math.PI/2,0,y,!1,g,1,!1,je,r,s);else{var G=this.instance._getRotations(g),w=this.instance._getRotations(E);O||(O=this._calculateOrientation(g,E,I,D,y.endpoints[0]._anchor,y.endpoints[1]._anchor,G,w),c[T]=O),b&&this._updateAnchorList(this.anchorLists.get(g),O.theta,0,y,!1,E,0,!1,O.a[0],r,s),x&&this._updateAnchorList(this.anchorLists.get(E),O.theta2,-1,y,!0,g,1,!0,O.a[1],r,s)}b&&l.add(g),x&&l.add(E),r.add(y),(b&&P===0||x&&P===1)&&s.add(y.endpoints[P])}else{var R=h.connections[p].endpoints[y.sourceId===n?1:0],L=R._anchor;if(cv(L)){this.instance._paintEndpoint(R,{elementWithPrecedence:n,timestamp:i}),r.add(h.connections[p]);for(var k=0;k<R.connections.length;k++)R.connections[k]!==h.connections[p]&&r.add(R.connections[k])}else r.add(h.connections[p])}}l.forEach(function(N){t._placeAnchors(N,t.anchorLists.get(N))}),s.forEach(function(N){var H=t.instance.viewport.getPosition(N.elementId);t.instance._paintEndpoint(N,{timestamp:i,offset:H})}),r.forEach(function(N){t.instance._paintConnection(N,{timestamp:i})})}return{c:r,e:s}}},{key:"reset",value:function(){this.anchorLocations.clear(),this.anchorLists.clear()}},{key:"setAnchor",value:function(n,i){i!=null&&(n._anchor=i)}},{key:"setConnectionAnchors",value:function(n,i){n.endpoints[0]._anchor=i[0],n.endpoints[1]._anchor=i[1]}},{key:"_calculateOrientation",value:function(n,i,e,t,r,s,l,u){var c=this,f={HORIZONTAL:"horizontal",VERTICAL:"vertical",DIAGONAL:"diagonal",IDENTITY:"identity"};if(n===i)return{orientation:f.IDENTITY,a:[je,je]};var h=Math.atan2(t.c.y-e.c.y,t.c.x-e.c.x),v=Math.atan2(e.c.y-t.c.y,e.c.x-t.c.x),p=[],y={};(function(T,O){for(var P=0;P<T.length;P++){var D;if(y[T[P]]=(D={},d(D,Qe,{x:O[P][0].x,y:O[P][0].c.y}),d(D,ze,{x:O[P][0].x+O[P][0].w,y:O[P][0].c.y}),d(D,je,{x:O[P][0].c.x,y:O[P][0].y}),d(D,tt,{x:O[P][0].c.x,y:O[P][0].y+O[P][0].h}),D),O[P][1]!=null&&O[P][1].length>0)for(var I in y[T[P]])y[T[P]][I]=c.instance._applyRotationsXY(y[T[P]][I],O[P][1])}})([jo,Dl],[[e,l],[t,u]]);for(var g=[je,Qe,ze,tt],E=0;E<g.length;E++)for(var b=0;b<g.length;b++)p.push({source:g[E],target:g[b],dist:Vo(y.source[g[E]],y.target[g[b]])});p.sort(function(T,O){if(T.dist<O.dist)return-1;if(O.dist<T.dist)return 1;var P,D=(P={},d(P,Qe,0),d(P,je,1),d(P,ze,2),d(P,tt,3),P),I=D[T.source],G=D[O.source],w=D[T.target],R=D[O.target];return I<G?-1:G<I?1:w<R?-1:R<w?1:0});for(var x=p[0].source,S=p[0].target,C=0;C<p.length&&(Kt(r)&&r.locked?x=r.currentFace:!r.isContinuous||vs(r,p[C].source)?x=p[C].source:x=null,s.isContinuous&&s.locked?S=s.currentFace:!s.isContinuous||vs(s,p[C].target)?S=p[C].target:S=null,!(x!=null&&S!=null));C++);return r.isContinuous&&this.setCurrentFace(r,x),s.isContinuous&&this.setCurrentFace(s,S),{a:[x,S],theta:h,theta2:v}}},{key:"setCurrentFace",value:function(n,i,e){n.currentFace=i,e&&n.lockedFace!=null&&(n.lockedFace=n.currentFace)}},{key:"lock",value:function(n){n.locked=!0,Kt(n)&&(n.lockedFace=n.currentFace)}},{key:"unlock",value:function(n){n.locked=!1,Kt(n)&&(n.lockedFace=null)}},{key:"selectAnchorLocation",value:function(n,i){var e=rn(n.locations,function(t){return t.x===i.x&&t.y===i.y});return e!==-1?(n.currentLocation=e,!0):!1}},{key:"lockCurrentAxis",value:function(n){n.currentFace!=null&&(n.lockedAxis=n.currentFace===Qe||n.currentFace===ze?sd:ld)}},{key:"unlockCurrentAxis",value:function(n){n.lockedAxis=null}},{key:"anchorsEqual",value:function(n,i){if(!n||!i)return!1;var e=n.locations[n.currentLocation],t=i.locations[i.currentLocation];return e.x===t.x&&e.y===t.y&&e.offx===t.offx&&e.offy===t.offy&&e.ox===t.ox&&e.oy===t.oy}}]),a}(),js={},Qr={get:function(o,n,i){var e=js[n];if(e)return new e(o,i);throw{message:"jsPlumb: unknown connector type '"+n+"'"}},register:function(o,n){js[o]=n}},xn=function(a){be(n,a);var o=xe(n);function n(i){var e;return X(this,n),e=o.call(this,i),d(m(e),"length",void 0),d(m(e),"m",void 0),d(m(e),"m2",void 0),d(m(e),"type",n.segmentType),e._setCoordinates({x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2}),e}return J(n,[{key:"getPath",value:function(e){return(e?"M "+this.x1+" "+this.y1+" ":"")+"L "+this.x2+" "+this.y2}},{key:"_recalc",value:function(){this.length=Math.sqrt(Math.pow(this.x2-this.x1,2)+Math.pow(this.y2-this.y1,2)),this.m=rr({x:this.x1,y:this.y1},{x:this.x2,y:this.y2}),this.m2=-1/this.m,this.extents={xmin:Math.min(this.x1,this.x2),ymin:Math.min(this.y1,this.y2),xmax:Math.max(this.x1,this.x2),ymax:Math.max(this.y1,this.y2)}}},{key:"getLength",value:function(){return this.length}},{key:"getGradient",value:function(){return this.m}},{key:"_setCoordinates",value:function(e){this.x1=e.x1,this.y1=e.y1,this.x2=e.x2,this.y2=e.y2,this._recalc()}},{key:"pointOnPath",value:function(e,t){if(e===0&&!t)return{x:this.x1,y:this.y1};if(e===1&&!t)return{x:this.x2,y:this.y2};var r=t?e>0?e:this.length+e:e*this.length;return yn({x:this.x1,y:this.y1},{x:this.x2,y:this.y2},r)}},{key:"gradientAtPoint",value:function(e,t){return this.m}},{key:"pointAlongPathFrom",value:function(e,t,r){var s=this.pointOnPath(e,r),l=t<=0?{x:this.x1,y:this.y1}:{x:this.x2,y:this.y2};return t<=0&&Math.abs(t)>1&&(t*=-1),yn(s,l,t)}},{key:"within",value:function(e,t,r){return r>=Math.min(e,t)&&r<=Math.max(e,t)}},{key:"closest",value:function(e,t,r){return Math.abs(r-e)<Math.abs(r-t)?e:t}},{key:"findClosestPointOnPath",value:function(e,t){var r={d:1/0,x:null,y:null,l:null,x1:this.x1,x2:this.x2,y1:this.y1,y2:this.y2};if(this.m===0)r.y=this.y1,r.x=this.within(this.x1,this.x2,e)?e:this.closest(this.x1,this.x2,e);else if(this.m===1/0||this.m===-1/0)r.x=this.x1,r.y=this.within(this.y1,this.y2,t)?t:this.closest(this.y1,this.y2,t);else{var s=this.y1-this.m*this.x1,l=t-this.m2*e,u=(l-s)/(this.m-this.m2),c=this.m*u+s;r.x=this.within(this.x1,this.x2,u)?u:this.closest(this.x1,this.x2,u),r.y=this.within(this.y1,this.y2,c)?c:this.closest(this.y1,this.y2,c)}var f=Vo({x:r.x,y:r.y},{x:this.x1,y:this.y1});return r.d=Vo({x:e,y:t},r),r.l=f/length,r}},{key:"_pointLiesBetween",value:function(e,t,r){return r>t?t<=e&&e<=r:t>=e&&e>=r}},{key:"lineIntersection",value:function(e,t,r,s){var l=Math.abs(rr({x:e,y:t},{x:r,y:s})),u=Math.abs(this.m),c=u===1/0?this.x1:this.y1-u*this.x1,f=[],h=l===1/0?e:t-l*e;if(l!==u)if(l===1/0&&u===0)this._pointLiesBetween(e,this.x1,this.x2)&&this._pointLiesBetween(this.y1,t,s)&&f.push({x:e,y:this.y1});else if(l===0&&u===1/0)this._pointLiesBetween(t,this.y1,this.y2)&&this._pointLiesBetween(this.x1,e,r)&&f.push({x:this.x1,y:t});else{var v,p;l===1/0?(v=e,this._pointLiesBetween(v,this.x1,this.x2)&&(p=u*e+c,this._pointLiesBetween(p,t,s)&&f.push({x:v,y:p}))):l===0?(p=t,this._pointLiesBetween(p,this.y1,this.y2)&&(v=(t-c)/u,this._pointLiesBetween(v,e,r)&&f.push({x:v,y:p}))):(v=(h-c)/(u-l),p=u*v+c,this._pointLiesBetween(v,this.x1,this.x2)&&this._pointLiesBetween(p,this.y1,this.y2)&&f.push({x:v,y:p}))}return f}},{key:"boxIntersection",value:function(e,t,r,s){var l=[];return l.push.apply(l,this.lineIntersection(e,t,e+r,t)),l.push.apply(l,this.lineIntersection(e+r,t,e+r,t+s)),l.push.apply(l,this.lineIntersection(e+r,t+s,e,t+s)),l.push.apply(l,this.lineIntersection(e,t+s,e,t)),l}}]),n}(Ea);d(xn,"segmentType","Straight");var Zi=function(a){be(n,a);var o=xe(n);function n(){var i;X(this,n);for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return i=o.call.apply(o,[this].concat(t)),d(m(i),"type",n.type),i}return J(n,[{key:"getDefaultStubs",value:function(){return[0,0]}},{key:"_compute",value:function(e,t){this._addSegment(xn,{x1:e.sx,y1:e.sy,x2:e.startStubX,y2:e.startStubY}),this._addSegment(xn,{x1:e.startStubX,y1:e.startStubY,x2:e.endStubX,y2:e.endStubY}),this._addSegment(xn,{x1:e.endStubX,y1:e.endStubY,x2:e.tx,y2:e.ty}),this.geometry={source:t.sourcePos,target:t.targetPos}}},{key:"transformGeometry",value:function(e,t,r){return{source:this.transformAnchorPlacement(e.source,t,r),target:this.transformAnchorPlacement(e.target,t,r)}}}]),n}(oo);d(Zi,"type","Straight");function hv(a,o){for(var n=a.scope.split(/\s/),i=o.scope.split(/\s/),e=0;e<n.length;e++)for(var t=0;t<i.length;t++)if(i[t]===n[e])return!0;return!1}function dn(a,o,n){var i=[],e=function(s){return Ne(s)?s:a.getId(s)};if(o)if(typeof o=="string"){if(o==="*")return o;i.push(o)}else if(n)i=o;else if(o.length!=null){var t;(t=i).push.apply(t,qn(qn(o).map(e)))}else i.push(e(o));return i}function dv(a,o){a!=null&&a.endpoints.push(o)}function vv(a,o){a!=null&&Ye(a.endpoints,function(n){return n===o})}function gi(a,o,n){o!=null&&(o.connections.push(a),o.connections.length===1&&a.instance.addClass(a.source,a.instance.connectedClass)),n!=null&&(o==null||a.sourceId!==a.targetId)&&(n.connections.push(a),n.connections.length===1&&a.instance.addClass(a.target,a.instance.connectedClass))}function yi(a,o,n){if(o!=null){var i=o.connections.length;Ye(o.connections,function(t){return a.id===t.id}),i>0&&o.connections.length===0&&a.instance.removeClass(a.source,a.instance.connectedClass)}if(n!=null){var e=n.connections.length;(o==null||a.sourceId!==a.targetId)&&Ye(n.connections,function(t){return a.id===t.id}),e>0&&n.connections.length===0&&a.instance.removeClass(a.target,a.instance.connectedClass)}}var pv=function(a){be(n,a);var o=xe(n);function n(i,e){var t;return X(this,n),t=o.call(this),t._instanceIndex=i,d(m(t),"defaults",void 0),d(m(t),"_initialDefaults",{}),d(m(t),"isConnectionBeingDragged",!1),d(m(t),"currentlyDragging",!1),d(m(t),"hoverSuspended",!1),d(m(t),"_suspendDrawing",!1),d(m(t),"_suspendedAt",null),d(m(t),"connectorClass",ha),d(m(t),"connectorOutlineClass",ef),d(m(t),"connectedClass",tf),d(m(t),"endpointClass",Zn),d(m(t),"endpointConnectedClass",nf),d(m(t),"endpointFullClass",rf),d(m(t),"endpointFloatingClass",da),d(m(t),"endpointDropAllowedClass",of),d(m(t),"endpointDropForbiddenClass",af),d(m(t),"endpointAnchorClassPrefix",sf),d(m(t),"overlayClass",ro),d(m(t),"connections",[]),d(m(t),"endpointsByElement",{}),d(m(t),"endpointsByUUID",new Map),d(m(t),"sourceSelectors",[]),d(m(t),"targetSelectors",[]),d(m(t),"allowNestedGroups",void 0),d(m(t),"_curIdStamp",1),d(m(t),"viewport",new sv(m(t))),d(m(t),"router",void 0),d(m(t),"groupManager",void 0),d(m(t),"_connectionTypes",new Map),d(m(t),"_endpointTypes",new Map),d(m(t),"_container",void 0),d(m(t),"_managedElements",{}),d(m(t),"DEFAULT_SCOPE",void 0),d(m(t),"_zoom",1),t.defaults={anchor:Mt.Bottom,anchors:[null,null],connectionsDetachable:!0,connectionOverlays:[],connector:Zi.type,container:null,endpoint:Dn.type,endpointOverlays:[],endpoints:[null,null],endpointStyle:{fill:"#456"},endpointStyles:[null,null],endpointHoverStyle:null,endpointHoverStyles:[null,null],hoverPaintStyle:null,listStyle:{},maxConnections:1,paintStyle:{strokeWidth:2,stroke:"#456"},reattachConnections:!1,scope:"jsplumb_defaultscope",allowNestedGroups:!0},e&&W(t.defaults,e),W(t._initialDefaults,t.defaults),t._initialDefaults[Bn]!=null&&(t._initialDefaults[Bn].strokeWidth=t._initialDefaults[Bn].strokeWidth||2),t.DEFAULT_SCOPE=t.defaults[qd],t.allowNestedGroups=t._initialDefaults[Qd]!==!1,t.router=new fv(m(t)),t.groupManager=new nv(m(t)),t.setContainer(t._initialDefaults.container),t}return J(n,[{key:"defaultScope",get:function(){return this.DEFAULT_SCOPE}},{key:"currentZoom",get:function(){return this._zoom}},{key:"areDefaultAnchorsSet",value:function(){return this.validAnchorsSpec(this.defaults.anchors)}},{key:"validAnchorsSpec",value:function(e){return e!=null&&e[0]!=null&&e[1]!=null}},{key:"getContainer",value:function(){return this._container}},{key:"setZoom",value:function(e,t){return this._zoom=e,this.fire(jl,this._zoom),t&&this.repaintEverything(),!0}},{key:"_idstamp",value:function(){return""+this._curIdStamp++}},{key:"checkCondition",value:function(e,t){var r=this.getListener(e),s=!0;if(r&&r.length>0){var l=Array.prototype.slice.call(arguments,1);try{for(var u=0,c=r.length;u<c;u++)s=s&&r[u].apply(r[u],l)}catch(f){Ue("cannot check condition ["+e+"]"+f)}}return s}},{key:"getId",value:function(e,t){if(e==null)return null;var r=this.getAttribute(e,Jt);return(!r||r==="undefined")&&(arguments.length===2&&arguments[1]!==void 0?r=t:(arguments.length===1||arguments.length===3&&!arguments[2])&&(r="jsplumb-"+this._instanceIndex+"-"+this._idstamp()),this.setAttribute(e,Jt,r)),r}},{key:"getConnections",value:function(e,t){e?e.constructor===String&&(e={scope:e}):e={};for(var r=e.scope||this.defaultScope,s=dn(this,r,!0),l=dn(this,e.source),u=dn(this,e.target),c=!t&&s.length>1?{}:[],f=function(b,x){if(!t&&s.length>1){var S=c[b];S==null&&(S=c[b]=[]),S.push(x)}else c.push(x)},h=0,v=this.connections.length;h<v;h++){var p=this.connections[h],y=p.proxies&&p.proxies[0]?p.proxies[0].originalEp.elementId:p.sourceId,g=p.proxies&&p.proxies[1]?p.proxies[1].originalEp.elementId:p.targetId;cn(s,p.scope)&&cn(l,y)&&cn(u,g)&&f(p.scope,p)}return c}},{key:"select",value:function(e){return e=e||{},e.scope=e.scope||"*",new iv(this,e.connections||this.getConnections(e,!0))}},{key:"selectEndpoints",value:function(e){e=e||{},e.scope=e.scope||mn;var t=!e.element&&!e.source&&!e.target,r=t?mn:dn(this,e.element),s=t?mn:dn(this,e.source),l=t?mn:dn(this,e.target),u=dn(this,e.scope,!0),c=[];for(var f in this.endpointsByElement){var h=cn(r,f,!0),v=cn(s,f,!0),p=s!=="*",y=cn(l,f,!0),g=l!=="*";if(h||v||y)e:for(var E=0,b=this.endpointsByElement[f].length;E<b;E++){var x=this.endpointsByElement[f][E];if(cn(u,x.scope,!0)){var S=p&&s.length>0&&!x.isSource,C=g&&l.length>0&&!x.isTarget;if(S||C)continue e;c.push(x)}}}return new rv(this,c)}},{key:"setContainer",value:function(e){this._container=e,this.fire(uf,this._container)}},{key:"_set",value:function(e,t,r){var s=[{el:"source",elId:"sourceId"},{el:"target",elId:"targetId"}],l,u=s[r],c=e[u.elId],f,h=e.endpoints[r],v={index:r,originalEndpoint:h,originalSourceId:r===0?c:e.sourceId,newSourceId:e.sourceId,originalTargetId:r===1?c:e.targetId,newTargetId:e.targetId,connection:e,newEndpoint:h};return t instanceof Kn?(l=t,l.addConnection(e)):(f=this.getId(t),f===e[u.elId]?l=null:l=e.makeEndpoint(r===0,t,f)),l!=null&&(v.newEndpoint=l,h.detachFromConnection(e),e.endpoints[r]=l,e[u.el]=l.element,e[u.elId]=l.elementId,v[r===0?"newSourceId":"newTargetId"]=l.elementId,this.fireMoveEvent(v),this._paintConnection(e)),v}},{key:"setSource",value:function(e,t){yi(e,this._managedElements[e.sourceId]);var r=this._set(e,t,0);gi(e,this._managedElements[r.newSourceId])}},{key:"setTarget",value:function(e,t){yi(e,this._managedElements[e.targetId]);var r=this._set(e,t,1);gi(e,this._managedElements[r.newTargetId])}},{key:"setConnectionType",value:function(e,t,r){e.setType(t,r),this._paintConnection(e)}},{key:"isHoverSuspended",value:function(){return this.hoverSuspended}},{key:"setSuspendDrawing",value:function(e,t){var r=this._suspendDrawing;return this._suspendDrawing=e,e?this._suspendedAt=""+new Date().getTime():(this._suspendedAt=null,this.viewport.recomputeBounds()),t&&this.repaintEverything(),r}},{key:"getSuspendedAt",value:function(){return this._suspendedAt}},{key:"batch",value:function(e,t){var r=this._suspendDrawing===!0;r||this.setSuspendDrawing(!0),e(),r||this.setSuspendDrawing(!1,!t)}},{key:"each",value:function(e,t){if(e!=null){if(e.length!=null)for(var r=0;r<e.length;r++)t(e[r]);else t(e);return this}}},{key:"updateOffset",value:function(e){var t=e.elId;return e.recalc?this.viewport.refreshElement(t):this.viewport.getPosition(t)}},{key:"deleteConnection",value:function(e,t){if(e!=null&&e.deleted!==!0&&(t=t||{},t.force||bl(!0,!1,[[e.endpoints[0],Jn,[e]],[e.endpoints[1],Jn,[e]],[e,Jn,[e]],[this,Ml,[Bl,e]]]))){yi(e,this._managedElements[e.sourceId],this._managedElements[e.targetId]),this.fireDetachEvent(e,!e.pending&&t.fireEvent!==!1,t.originalEvent);var r=e.endpoints[0],s=e.endpoints[1];return r!==t.endpointToIgnore&&r.detachFromConnection(e,null,!0),s!==t.endpointToIgnore&&s.detachFromConnection(e,null,!0),Ye(this.connections,function(l){return e.id===l.id}),e.destroy(),r!==t.endpointToIgnore&&r.deleteOnEmpty&&r.connections.length===0&&this.deleteEndpoint(r),s!==t.endpointToIgnore&&s.deleteOnEmpty&&s.connections.length===0&&this.deleteEndpoint(s),!0}return!1}},{key:"deleteEveryConnection",value:function(e){var t=this;e=e||{};var r=this.connections.length,s=0;return this.batch(function(){for(var l=0;l<r;l++)s+=t.deleteConnection(t.connections[0],e)?1:0}),s}},{key:"deleteConnectionsForElement",value:function(e,t){var r=this.getId(e),s=this._managedElements[r];if(s)for(var l=s.connections.length,u=0;u<l;u++)this.deleteConnection(s.connections[0],t);return this}},{key:"fireDetachEvent",value:function(e,t,r){var s=e.id!=null,l=s?{connection:e,source:e.source,target:e.target,sourceId:e.sourceId,targetId:e.targetId,sourceEndpoint:e.endpoints[0],targetEndpoint:e.endpoints[1]}:e;t&&this.fire(kl,l,r),this.fire(ga,l,r)}},{key:"fireMoveEvent",value:function(e,t){this.fire(pa,e,t)}},{key:"manageAll",value:function(e,t){for(var r=Ne(e)?this.getSelector(this.getContainer(),e):e,s=0;s<r.length;s++)this.manage(r[s],null,t)}},{key:"manage",value:function(e,t,r){this.getAttribute(e,Jt)==null&&(t=t||this.getAttribute(e,"id")||He(),this.setAttribute(e,Jt,t));var s=this.getId(e);if(this._managedElements[s])r&&(this._managedElements[s].viewportElement=this.updateOffset({elId:s,timestamp:null,recalc:!0}));else{var l={el:e,endpoints:[],connections:[],rotation:0,data:{}};this._managedElements[s]=l,this._suspendDrawing?l.viewportElement=this.viewport.registerElement(s,!0):l.viewportElement=this.updateOffset({elId:s,recalc:!0}),this.fire(Nl,{el:e})}return this._managedElements[s]}},{key:"getManagedData",value:function(e,t,r){if(this._managedElements[e]){var s=this._managedElements[e].data[t];return s!=null?s[r]:null}}},{key:"setManagedData",value:function(e,t,r,s){this._managedElements[e]&&(this._managedElements[e].data[t]=this._managedElements[e].data[t]||{},this._managedElements[e].data[t][r]=s)}},{key:"getManagedElement",value:function(e){return this._managedElements[e]?this._managedElements[e].el:null}},{key:"unmanage",value:function(e,t){var r=this;this.removeAllEndpoints(e,!0);var s=function(u){var c=r.getId(u);r.removeAttribute(u,Jt),delete r._managedElements[c],r.viewport.remove(c),r.fire(Gl,{el:u,id:c}),u&&t&&r._removeElement(u)};this._getAssociatedElements(e).map(s),s(e)}},{key:"rotate",value:function(e,t,r){var s=this.getId(e);return this._managedElements[s]&&(this._managedElements[s].rotation=t,this.viewport.rotateElement(s,t),r!==!0)?this.revalidate(e):{c:new Set,e:new Set}}},{key:"_getRotation",value:function(e){var t=this._managedElements[e];return t!=null&&t.rotation||0}},{key:"_getRotations",value:function(e){var t=this,r=[],s=this._managedElements[e],l=function u(c){if(c.group!=null){var f=t._managedElements[c.group];f!=null&&(r.push({r:f.viewportElement.r,c:f.viewportElement.c}),u(f))}};return s!=null&&(r.push({r:s.viewportElement.r||0,c:s.viewportElement.c}),l(s)),r}},{key:"_applyRotations",value:function(e,t){var r=e.slice(),s={x:r[0],y:r[1],cr:0,sr:0};return K(t,function(l){s=ji(s,l.c,l.r)}),s}},{key:"_applyRotationsXY",value:function(e,t){return K(t,function(r){e=ji(e,r.c,r.r)}),e}},{key:"_internal_newEndpoint",value:function(e){var t=W({},e),r=this.manage(t.element);t.elementId=this.getId(t.element),t.id="ep_"+this._idstamp();var s=new Kn(this,t);return dv(r,s),e.uuid&&this.endpointsByUUID.set(e.uuid,s),Sl(this.endpointsByElement,s.elementId,s),this._suspendDrawing||this._paintEndpoint(s,{timestamp:this._suspendedAt}),s}},{key:"_deriveEndpointAndAnchorSpec",value:function(e,t){for(var r=((t?"":"default ")+e).split(/[\s]/),s=null,l=null,u=null,c=null,f=0;f<r.length;f++){var h=this.getConnectionType(r[f]);h&&(h.endpoints&&(s=h.endpoints),h.endpoint&&(l=h.endpoint),h.anchors&&(c=h.anchors),h.anchor&&(u=h.anchor))}return{endpoints:s||[l,l],anchors:c||[u,u]}}},{key:"revalidate",value:function(e,t){var r=this.getId(e);return this.updateOffset({elId:r,recalc:!0,timestamp:t}),this.repaint(e)}},{key:"repaintEverything",value:function(){var e=He(),t;for(t in this._managedElements)this.viewport.refreshElement(t,!0);this.viewport.recomputeBounds();for(t in this._managedElements)this.repaint(this._managedElements[t].el,e,!0);return this}},{key:"setElementPosition",value:function(e,t,r){var s=this.getId(e);return this.viewport.setPosition(s,t,r),this.repaint(e)}},{key:"repaint",value:function(e,t,r){var s={c:new Set,e:new Set},l=function(p){p.c.forEach(function(y){return s.c.add(y)}),p.e.forEach(function(y){return s.e.add(y)})};if(!this._suspendDrawing){var u=this.getId(e);if(e!=null){var c=this._getAssociatedElements(e);if(t==null&&(t=He()),!r)for(var f=0;f<c.length;f++)this.updateOffset({elId:this.getId(c[f]),recalc:!0,timestamp:t});if(l(this.router.redraw(u,t,null)),c.length>0)for(var h=0;h<c.length;h++)l(this.router.redraw(this.getId(c[h]),t,null))}}return s}},{key:"unregisterEndpoint",value:function(e){var t=e.getUuid();t&&this.endpointsByUUID.delete(t),vv(this._managedElements[e.elementId],e);var r=this.endpointsByElement[e.elementId];r!=null&&(this.endpointsByElement[e.elementId]=r.filter(function(s){return s!==e})),this.fire(Ll,e)}},{key:"_maybePruneEndpoint",value:function(e){return e.deleteOnEmpty&&e.connections.length===0?(this.deleteEndpoint(e),!0):!1}},{key:"deleteEndpoint",value:function(e){var t=this,r=typeof e=="string"?this.endpointsByUUID.get(e):e;if(r){var s=r.proxiedBy,l=r.connections.slice();K(l,function(u){r.detachFromConnection(u,null,!0)}),this.unregisterEndpoint(r),r.destroy(),K(l,function(u){t.deleteConnection(u,{force:!0,endpointToIgnore:r})}),s!=null&&this.deleteEndpoint(s)}return this}},{key:"addEndpoint",value:function(e,t,r){r=r||{};var s=W({},r);W(s,t||{});var l=W({element:e},s);return this._internal_newEndpoint(l)}},{key:"addEndpoints",value:function(e,t,r){for(var s=[],l=0,u=t.length;l<u;l++)s.push(this.addEndpoint(e,t[l],r));return s}},{key:"reset",value:function(){var e=this;this.silently(function(){e.endpointsByElement={},e._managedElements={},e.endpointsByUUID.clear(),e.viewport.reset(),e.router.reset(),e.groupManager.reset(),e.connections.length=0})}},{key:"destroy",value:function(){this.reset(),this.unbind(),this.sourceSelectors.length=0,this.targetSelectors.length=0,this._connectionTypes.clear(),this._endpointTypes.clear()}},{key:"getEndpoints",value:function(e){return this.endpointsByElement[this.getId(e)]||[]}},{key:"getEndpoint",value:function(e){return this.endpointsByUUID.get(e)}},{key:"setEndpointUuid",value:function(e,t){e.uuid&&this.endpointsByUUID.delete(e.uuid),e.uuid=t,this.endpointsByUUID.set(t,e)}},{key:"connect",value:function(e,t){try{var r=this._prepareConnectionParams(e,t),s=this._newConnection(r);return this._finaliseConnection(s,r),s}catch(l){Ue(l);return}}},{key:"_prepareConnectionParams",value:function(e,t){var r=W({},e);t&&W(r,t);var s=r;if(s.source&&s.source.endpoint&&(s.sourceEndpoint=s.source),s.target&&s.target.endpoint&&(s.targetEndpoint=s.target),e.uuids&&(s.sourceEndpoint=this.getEndpoint(e.uuids[0]),s.targetEndpoint=this.getEndpoint(e.uuids[1])),s.sourceEndpoint!=null){if(s.sourceEndpoint.isFull())throw xf;if(s.type||(s.type=s.sourceEndpoint.edgeType),s.sourceEndpoint.connectorOverlays){s.overlays=s.overlays||[];for(var l=0,u=s.sourceEndpoint.connectorOverlays.length;l<u;l++)s.overlays.push(s.sourceEndpoint.connectorOverlays[l])}s.sourceEndpoint.scope&&(s.scope=s.sourceEndpoint.scope)}else if(s.source==null)throw Cf;if(s.targetEndpoint!=null){if(s.targetEndpoint.isFull())throw Sf}else if(s.target==null)throw Pf;if(s.sourceEndpoint&&s.targetEndpoint&&!hv(s.sourceEndpoint,s.targetEndpoint))throw"Cannot establish connection: scopes do not match";return s}},{key:"_newConnection",value:function(e){e.id="con_"+this._idstamp();var t=new $r(this,e);return gi(t,this._managedElements[t.sourceId],this._managedElements[t.targetId]),this._paintConnection(t),t}},{key:"_finaliseConnection",value:function(e,t,r){t=t||{},e.suspendedEndpoint||this.connections.push(e),e.pending=null,e.endpoints[0].isTemporarySource=!1,this.repaint(e.source);var s={connection:e,source:e.source,target:e.target,sourceId:e.sourceId,targetId:e.targetId,sourceEndpoint:e.endpoints[0],targetEndpoint:e.endpoints[1]};this.fire(wl,s,r),!t.doNotFireConnectionEvent&&t.fireEvent!==!1&&this.fire(va,s,r)}},{key:"removeAllEndpoints",value:function(e,t){var r=this,s=function(u){var c=r.getId(u),f=r.endpointsByElement[c],h,v;if(f)for(h=0,v=f.length;h<v;h++)r.deleteEndpoint(f[h]);delete r.endpointsByElement[c]};return t&&this._getAssociatedElements(e).map(s),s(e),this}},{key:"_createSourceDefinition",value:function(e,t){var r=W({},t);W(r,e),r.edgeType=r.edgeType||Hi;var s=this._deriveEndpointAndAnchorSpec(r.edgeType);r.endpoint=r.endpoint||s.endpoints[0],r.anchor=r.anchor||s.anchors[0];var l=r.maxConnections||-1,u={def:W({},r),uniqueEndpoint:r.uniqueEndpoint,maxConnections:l,enabled:!0,endpoint:null};return u}},{key:"addSourceSelector",value:function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this._createSourceDefinition(t),l=new xs(e,s,r);return this.sourceSelectors.push(l),l}},{key:"removeSourceSelector",value:function(e){Ye(this.sourceSelectors,function(t){return t===e})}},{key:"removeTargetSelector",value:function(e){Ye(this.targetSelectors,function(t){return t===e})}},{key:"addTargetSelector",value:function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this._createTargetDefinition(t),l=new xs(e,s,r);return this.targetSelectors.push(l),l}},{key:"_createTargetDefinition",value:function(e,t){var r=W({},t);W(r,e),r.edgeType=r.edgeType||Hi;var s=r.maxConnections||-1,l={def:W({},r),uniqueEndpoint:r.uniqueEndpoint,maxConnections:s,enabled:!0,endpoint:null};return l}},{key:"show",value:function(e,t){return this._setVisible(e,Fo,t)}},{key:"hide",value:function(e,t){return this._setVisible(e,tr,t)}},{key:"_setVisible",value:function(e,t,r){var s=t===Fo,l=null;r&&(l=function(f){f.setVisible(s,!0,!0)});var u=this.getId(e);return this._operation(e,function(c){if(s&&r){var f=c.sourceId===u?1:0;c.endpoints[f].isVisible()&&c.setVisible(!0)}else c.setVisible(s)},l),this}},{key:"toggleVisible",value:function(e,t){var r=null;t&&(r=function(l){var u=l.isVisible();l.setVisible(!u)}),this._operation(e,function(s){var l=s.isVisible();s.setVisible(!l)},r)}},{key:"_operation",value:function(e,t,r){var s=this.getId(e),l=this.endpointsByElement[s];if(l&&l.length)for(var u=0,c=l.length;u<c;u++){for(var f=0,h=l[u].connections.length;f<h;f++){var v=t(l[u].connections[f]);if(v)return}r&&r(l[u])}}},{key:"registerConnectionType",value:function(e,t){if(this._connectionTypes.set(e,W({},t)),t.overlays){for(var r={},s=0;s<t.overlays.length;s++){var l=Xo(t.overlays[s]);r[l.options.id]=l}this._connectionTypes.get(e).overlays=r}}},{key:"registerConnectionTypes",value:function(e){for(var t in e)this.registerConnectionType(t,e[t])}},{key:"registerEndpointType",value:function(e,t){if(this._endpointTypes.set(e,W({},t)),t.overlays){for(var r={},s=0;s<t.overlays.length;s++){var l=Xo(t.overlays[s]);r[l.options.id]=l}this._endpointTypes.get(e).overlays=r}}},{key:"registerEndpointTypes",value:function(e){for(var t in e)this.registerEndpointType(t,e[t])}},{key:"getType",value:function(e,t){return t==="connection"?this.getConnectionType(e):this.getEndpointType(e)}},{key:"getConnectionType",value:function(e){return this._connectionTypes.get(e)}},{key:"getEndpointType",value:function(e){return this._endpointTypes.get(e)}},{key:"importDefaults",value:function(e){for(var t in e)this.defaults[t]=e[t];return this.defaults[Bn]!=null&&(this.defaults[Bn].strokeWidth=this.defaults[Bn].strokeWidth||2),e.container&&this.setContainer(e.container),this}},{key:"restoreDefaults",value:function(){return this.defaults=W({},this._initialDefaults),this}},{key:"getManagedElements",value:function(){return this._managedElements}},{key:"proxyConnection",value:function(e,t,r,s,l){var u=e.proxies[t]!=null,c,f=u?e.proxies[t].originalEp.elementId:e.endpoints[t].elementId,h=u?e.proxies[t].originalEp:e.endpoints[t],v=this.getId(r);e.proxies[t]?e.proxies[t].ep.elementId===v?c=e.proxies[t].ep:(e.proxies[t].ep.detachFromConnection(e,t),c=this._internal_newEndpoint({element:r,endpoint:s(e,t),anchor:l(e,t),parameters:{isProxyEndpoint:!0}})):c=this._internal_newEndpoint({element:r,endpoint:s(e,t),anchor:l(e,t),parameters:{isProxyEndpoint:!0}}),c.deleteOnEmpty=!0,e.proxies[t]={ep:c,originalEp:h},this.sourceOrTargetChanged(f,v,e,r,t),h.detachFromConnection(e,null,!0),c.connections=[e],e.endpoints[t]=c,h.proxiedBy=c,h.setVisible(!1),e.setVisible(!0),this.revalidate(r)}},{key:"unproxyConnection",value:function(e,t){if(!(e.proxies==null||e.proxies[t]==null)){var r=e.proxies[t].originalEp.element,s=e.proxies[t].originalEp.elementId,l=e.proxies[t].ep.elementId;e.endpoints[t]=e.proxies[t].originalEp,delete e.proxies[t].originalEp.proxiedBy,this.sourceOrTargetChanged(l,s,e,r,t),e.proxies[t].ep.detachFromConnection(e,null),e.proxies[t].originalEp.addConnection(e),e.isVisible()&&e.proxies[t].originalEp.setVisible(!0),e.proxies[t]=null,rn(e.proxies,function(u){return u!=null})===-1&&(e.proxies.length=0)}}},{key:"sourceOrTargetChanged",value:function(e,t,r,s,l){e!==t&&(l===0?(r.sourceId=t,r.source=s):l===1&&(r.targetId=t,r.target=s),yi(r,this._managedElements[e]),gi(r,this._managedElements[t]))}},{key:"getGroup",value:function(e){return this.groupManager.getGroup(e)}},{key:"getGroupFor",value:function(e){return this.groupManager.getGroupFor(e)}},{key:"addGroup",value:function(e){return this.groupManager.addGroup(e)}},{key:"addToGroup",value:function(e){for(var t,r=arguments.length,s=new Array(r>1?r-1:0),l=1;l<r;l++)s[l-1]=arguments[l];return(t=this.groupManager).addToGroup.apply(t,[e,!1].concat(s))}},{key:"collapseGroup",value:function(e){this.groupManager.collapseGroup(e)}},{key:"expandGroup",value:function(e){this.groupManager.expandGroup(e)}},{key:"toggleGroup",value:function(e){this.groupManager.toggleGroup(e)}},{key:"removeGroup",value:function(e,t,r,s){return this.groupManager.removeGroup(e,t,r,s)}},{key:"removeAllGroups",value:function(e,t){this.groupManager.removeAllGroups(e,t,!1)}},{key:"removeFromGroup",value:function(e,t,r){this.groupManager.removeFromGroup(e,r,t),this._appendElement(t,this.getContainer()),this.updateOffset({recalc:!0,elId:this.getId(t)})}},{key:"_paintEndpoint",value:function(e,t){function r(x){var S=0;if(t.elementWithPrecedence!=null){for(var C=0;C<x.connections.length;C++)if(x.connections[C].sourceId===t.elementWithPrecedence||x.connections[C].targetId===t.elementWithPrecedence){S=C;break}}return x.connections[S]}t=t||{};var s=t.timestamp,l=t.recalc!==!1;if(!s||e.timestamp!==s){var u=this.viewport.getPosition(e.elementId),c=t.offset?{x:t.offset.x,y:t.offset.y}:{x:u.x,y:u.y};if(c!=null){var f=t.anchorLoc;if(f==null){var h={xy:c,wh:u,element:e,timestamp:s};if(l&&this.router.isDynamicAnchor(e)&&e.connections.length>0){var v=r(e),p=v.endpoints[0]===e?1:0,y=p===0?v.sourceId:v.targetId,g=this.viewport.getPosition(y);h.index=p===0?1:0,h.connection=v,h.txy=g,h.twh=g,h.tElement=v.endpoints[p],h.tRotation=this._getRotations(y)}else e.connections.length>0&&(h.connection=e.connections[0]);h.rotation=this._getRotations(e.elementId),f=this.router.computeAnchorLocation(e._anchor,h)}e.endpoint.compute(f,this.router.getEndpointOrientation(e),e.paintStyleInUse),this.renderEndpoint(e,e.paintStyleInUse),e.timestamp=s;for(var E in e.overlays)if(e.overlays.hasOwnProperty(E)){var b=e.overlays[E];b.isVisible()&&(e.overlayPlacements[E]=this.drawOverlay(b,e.endpoint,e.paintStyleInUse,e.getAbsoluteOverlayPosition(b)),this._paintOverlay(b,e.overlayPlacements[E],{xmin:0,ymin:0}))}}}}},{key:"_paintConnection",value:function(e,t){if(!this._suspendDrawing&&e.visible!==!1){t=t||{};var r=t.timestamp;if(r!=null&&r===e.lastPaintedAt)return;if(r==null||r!==e.lastPaintedAt){this.router.computePath(e,r);var s={xmin:1/0,ymin:1/0,xmax:-1/0,ymax:-1/0};for(var l in e.overlays)if(e.overlays.hasOwnProperty(l)){var u=e.overlays[l];u.isVisible()&&(e.overlayPlacements[l]=this.drawOverlay(u,e.connector,e.paintStyleInUse,e.getAbsoluteOverlayPosition(u)),s.xmin=Math.min(s.xmin,e.overlayPlacements[l].xmin),s.xmax=Math.max(s.xmax,e.overlayPlacements[l].xmax),s.ymin=Math.min(s.ymin,e.overlayPlacements[l].ymin),s.ymax=Math.max(s.ymax,e.overlayPlacements[l].ymax))}var c=parseFloat(""+e.paintStyleInUse.strokeWidth||"1")/2,f=parseFloat(""+e.paintStyleInUse.strokeWidth||"0"),h={xmin:Math.min(e.connector.bounds.xmin-(c+f),s.xmin),ymin:Math.min(e.connector.bounds.ymin-(c+f),s.ymin),xmax:Math.max(e.connector.bounds.xmax+(c+f),s.xmax),ymax:Math.max(e.connector.bounds.ymax+(c+f),s.ymax)};this.paintConnector(e.connector,e.paintStyleInUse,h);for(var v in e.overlays)if(e.overlays.hasOwnProperty(v)){var p=e.overlays[v];p.isVisible()&&this._paintOverlay(p,e.overlayPlacements[v],h)}}e.lastPaintedAt=r}}},{key:"_refreshEndpoint",value:function(e){e._anchor.isFloating||(e.connections.length>0?this.addEndpointClass(e,this.endpointConnectedClass):this.removeEndpointClass(e,this.endpointConnectedClass),e.isFull()?this.addEndpointClass(e,this.endpointFullClass):this.removeEndpointClass(e,this.endpointFullClass))}},{key:"_makeConnector",value:function(e,t,r){return Qr.get(e,t,r)}},{key:"addOverlay",value:function(e,t,r){if(e.addOverlay(t),!r){var s=e instanceof Kn?e.element:e.source;this.revalidate(s)}}},{key:"removeOverlay",value:function(e,t){e.removeOverlay(t);var r=e instanceof Kn?e.element:e.source;this.revalidate(r)}},{key:"setOutlineColor",value:function(e,t){e.paintStyleInUse.outlineStroke=t,this._paintConnection(e)}},{key:"setOutlineWidth",value:function(e,t){e.paintStyleInUse.outlineWidth=t,this._paintConnection(e)}},{key:"setColor",value:function(e,t){e.paintStyleInUse.stroke=t,this._paintConnection(e)}},{key:"setLineWidth",value:function(e,t){e.paintStyleInUse.strokeWidth=t,this._paintConnection(e)}},{key:"setLineStyle",value:function(e,t){t.lineWidth!=null&&(e.paintStyleInUse.strokeWidth=t.lineWidth),t.outlineWidth!=null&&(e.paintStyleInUse.outlineWidth=t.outlineWidth),t.color!=null&&(e.paintStyleInUse.stroke=t.color),t.outlineColor!=null&&(e.paintStyleInUse.outlineStroke=t.outlineColor),this._paintConnection(e)}},{key:"getPathData",value:function(e){for(var t="",r=0;r<e.segments.length;r++)t+=e.segments[r].getPath(r===0),t+=" ";return t}}]),n}(Jr),fu={};function Ia(a,o){fu[a]=o}function Fs(a,o,n){var i=o,e=zn(o.getBoundingClientRect)!==Yl?o.getBoundingClientRect():{left:0,top:0,width:0,height:0},t=document.body,r=document.documentElement,s=window.pageYOffset||r.scrollTop||t.scrollTop,l=window.pageXOffset||r.scrollLeft||t.scrollLeft,u=r.clientTop||t.clientTop||0,c=r.clientLeft||t.clientLeft||0,f=0,h=0,v=e.top+s-u+f*n,p=e.left+l-c+h*n,y=Vi(a),g=e.width||i.offsetWidth*n,E=e.height||i.offsetHeight*n,b=(y.x-p)/g,x=(y.y-v)/E;return{x:b,y:x}}function Hn(a){return $o(a)||Wo(a)||Ko(a)}function Bs(a,o){a.canvas&&(a.canvas.style.display=o?"block":"none")}function Us(a){a.canvas&&a.canvas.parentNode.removeChild(a.canvas),delete a.canvas}function Cr(a){return a.canvas}function Et(a){return Da.getElement(a)}function vn(a){return Da.getElement(a,a.component,function(o){var n=a.create(o);return a.instance.addClass(n,a.instance.overlayClass),n})}function gv(a,o,n,i){var e=a.x,t=a.y;return o._jsPlumbParentGroup&&o._jsPlumbParentGroup.constrain&&(e=Math.max(a.x,0),t=Math.max(a.y,0),e=Math.min(e,n.w-i.w),t=Math.min(t,n.h-i.h)),{x:e,y:t}}var yv=function(a){be(n,a);var o=xe(n);function n(i,e){var t;if(X(this,n),t=o.call(this,i,e),t._instanceIndex=i,d(m(t),"containerType",null),d(m(t),"dragSelection",void 0),d(m(t),"dragManager",void 0),d(m(t),"_connectorClick",void 0),d(m(t),"_connectorDblClick",void 0),d(m(t),"_connectorTap",void 0),d(m(t),"_connectorDblTap",void 0),d(m(t),"_endpointClick",void 0),d(m(t),"_endpointDblClick",void 0),d(m(t),"_overlayClick",void 0),d(m(t),"_overlayDblClick",void 0),d(m(t),"_overlayTap",void 0),d(m(t),"_overlayDblTap",void 0),d(m(t),"_connectorMouseover",void 0),d(m(t),"_connectorMouseout",void 0),d(m(t),"_endpointMouseover",void 0),d(m(t),"_endpointMouseout",void 0),d(m(t),"_connectorContextmenu",void 0),d(m(t),"_connectorMousedown",void 0),d(m(t),"_connectorMouseup",void 0),d(m(t),"_endpointMousedown",void 0),d(m(t),"_endpointMouseup",void 0),d(m(t),"_overlayMouseover",void 0),d(m(t),"_overlayMouseout",void 0),d(m(t),"_elementClick",void 0),d(m(t),"_elementTap",void 0),d(m(t),"_elementDblTap",void 0),d(m(t),"_elementMouseenter",void 0),d(m(t),"_elementMouseexit",void 0),d(m(t),"_elementMousemove",void 0),d(m(t),"_elementMouseup",void 0),d(m(t),"_elementMousedown",void 0),d(m(t),"_elementContextmenu",void 0),d(m(t),"_resizeObserver",void 0),d(m(t),"eventManager",void 0),d(m(t),"draggingClass","jtk-dragging"),d(m(t),"elementDraggingClass","jtk-element-dragging"),d(m(t),"hoverClass","jtk-hover"),d(m(t),"sourceElementDraggingClass","jtk-source-element-dragging"),d(m(t),"targetElementDraggingClass","jtk-target-element-dragging"),d(m(t),"hoverSourceClass","jtk-source-hover"),d(m(t),"hoverTargetClass","jtk-target-hover"),d(m(t),"dragSelectClass","jtk-drag-select"),d(m(t),"managedElementsSelector",void 0),d(m(t),"elementsDraggable",void 0),d(m(t),"elementDragHandler",void 0),d(m(t),"groupDragOptions",void 0),d(m(t),"elementDragOptions",void 0),d(m(t),"svg",{node:function(s,l){return Ut(s,l)},attr:function(s,l){return Bt(s,l)},pos:function(s){return Hl(s)}}),e=e||{},t.containerType=Go(t.getContainer()),t.elementsDraggable=e&&e.elementsDraggable!==!1,t.managedElementsSelector=e&&e.managedElementsSelector||Ae,t.eventManager=new xa,t.dragSelection=new Jh(m(t)),t.dragManager=new rd(m(t),t.dragSelection),t.dragManager.addHandler(new Cs(m(t))),t.groupDragOptions={constrainFunction:gv},t.dragManager.addHandler(new Ps(m(t),t.dragSelection),t.groupDragOptions),t.elementDragHandler=new Yo(m(t),t.dragSelection),t.elementDragOptions=e&&e.dragOptions||{},t.dragManager.addHandler(t.elementDragHandler,t.elementDragOptions),e&&e.dragOptions&&e.dragOptions.filter&&t.dragManager.addFilter(e.dragOptions.filter),t._createEventListeners(),t._attachEventDelegates(),e.resizeObserver!==!1)try{t._resizeObserver=new ResizeObserver(function(r){var s=r.filter(function(l){var u=t.getAttribute(l.target,Jt);if(u!=null){var c=t.viewport._elementMap.get(u);return c?c.w!==l.contentRect.width||c.h!==l.contentRect.height:!1}else return!1});s.forEach(function(l){return t.revalidate(l.target)})})}catch{Ue("WARN: ResizeObserver could not be attached.")}return t}return J(n,[{key:"fireOverlayMethod",value:function(e,t,r){var s=e.component instanceof $r?kt:_n,l=Te(s,t);r._jsPlumbOverlay=e,e.fire(t,{e:r,overlay:e}),this.fire(l,e.component,r)}},{key:"addDragFilter",value:function(e,t){this.dragManager.addFilter(e,t)}},{key:"removeDragFilter",value:function(e){this.dragManager.removeFilter(e)}},{key:"setDragGrid",value:function(e){this.dragManager.setOption(this.elementDragHandler,{grid:e})}},{key:"setDragConstrainFunction",value:function(e){this.dragManager.setOption(this.elementDragHandler,{constrainFunction:e})}},{key:"_removeElement",value:function(e){e.parentNode&&e.parentNode.removeChild(e)}},{key:"_appendElement",value:function(e,t){t&&t.appendChild(e)}},{key:"_appendElementToGroup",value:function(e,t){this.getGroupContentArea(e).appendChild(t)}},{key:"_appendElementToContainer",value:function(e){this._appendElement(e,this.getContainer())}},{key:"_getAssociatedElements",value:function(e){var t=[];if(e.nodeType!==3&&e.nodeType!==8){var r=e.querySelectorAll(Ae);Array.prototype.push.apply(t,r)}return t.filter(function(s){return s.nodeType!==3&&s.nodeType!==8})}},{key:"shouldFireEvent",value:function(e,t,r){return!0}},{key:"getClass",value:function(e){return Vc(e)}},{key:"addClass",value:function(e,t){gn(e,t)}},{key:"hasClass",value:function(e,t){return Yc(e,t)}},{key:"removeClass",value:function(e,t){Ro(e,t)}},{key:"toggleClass",value:function(e,t){Xc(e,t)}},{key:"setAttribute",value:function(e,t,r){e.setAttribute(t,r)}},{key:"getAttribute",value:function(e,t){return e.getAttribute(t)}},{key:"setAttributes",value:function(e,t){for(var r in t)e.setAttribute(r,t[r])}},{key:"removeAttribute",value:function(e,t){e.removeAttribute&&e.removeAttribute(t)}},{key:"on",value:function(e,t,r,s){var l=this,u=function(f){s==null?l.eventManager.on(f,t,r):l.eventManager.on(f,t,r,s)};return Hr(e)?K(e,function(c){return u(c)}):u(e),this}},{key:"off",value:function(e,t,r){var s=this;return Hr(e)?K(e,function(l){return s.eventManager.off(l,t,r)}):this.eventManager.off(e,t,r),this}},{key:"trigger",value:function(e,t,r,s,l){this.eventManager.trigger(e,t,r,s,l)}},{key:"getOffsetRelativeToRoot",value:function(e){return Xn(e)}},{key:"getOffset",value:function(e){for(var t=e,r=this.getContainer(),s=this.getPosition(t),l=e!==r&&t.offsetParent!==r?t.offsetParent:null,u=function(v){v!=null&&v!==document.body&&(v.scrollTop>0||v.scrollLeft>0)&&(s.x-=v.scrollLeft,s.y-=v.scrollTop)};l!=null;)s.x+=l.offsetLeft,s.y+=l.offsetTop,u(l),l=l.offsetParent===r?null:l.offsetParent;if(r!=null&&(r.scrollTop>0||r.scrollLeft>0)){var c=t.offsetParent!=null?this.getStyle(t.offsetParent,ss):Jc,f=this.getStyle(t,ss);f!==Vr&&f!==Qa&&c!==Vr&&c!==Qa&&(s.x-=r.scrollLeft,s.y-=r.scrollTop)}return s}},{key:"getSize",value:function(e){var t=e;if(t.offsetWidth!=null)return $c(e);if(t.width&&t.width.baseVal)return Wc(t)}},{key:"getPosition",value:function(e){var t=e;if(t.offsetLeft!=null)return{x:parseFloat(t.offsetLeft),y:parseFloat(t.offsetTop)};if(t.x&&t.x.baseVal)return Kc(t)}},{key:"getStyle",value:function(e,t){return zn(window.getComputedStyle)!==Yl?getComputedStyle(e,null).getPropertyValue(t):e.currentStyle[t]}},{key:"getGroupContentArea",value:function(e){var t=this.getSelector(e.el,lh);return t&&t.length>0?t[0]:e.el}},{key:"getSelector",value:function(e,t){var r=null;if(arguments.length===1){if(!Ne(e)){var s=document.createDocumentFragment();return s.appendChild(e),li(s.childNodes)}r=li(document.querySelectorAll(e))}else r=li(e.querySelectorAll(t));return r}},{key:"setPosition",value:function(e,t){var r=e;r.style.left=t.x+"px",r.style.top=t.y+"px"}},{key:"setDraggable",value:function(e,t){t?this.removeAttribute(e,Oi):this.setAttribute(e,Oi,Xl)}},{key:"isDraggable",value:function(e){var t=this.getAttribute(e,Oi);return t==null||t===Wn}},{key:"toggleDraggable",value:function(e){var t=this.isDraggable(e);return this.setDraggable(e,!t),!t}},{key:"_createEventListeners",value:function(){var e=function(E,b){if(!b.defaultPrevented&&b._jsPlumbOverlay==null){var x=Rt(ot(b),mt,this.getContainer(),!0);this.fire(E,x.jtk.connector.connection,b)}};this._connectorClick=e.bind(this,Qf),this._connectorDblClick=e.bind(this,qf),this._connectorTap=e.bind(this,ah),this._connectorDblTap=e.bind(this,eh);var t=function(E,b){var x=ot(b).parentNode;if(x.jtk&&x.jtk.connector){var S=x.jtk.connector,C=S.connection;this.setConnectorHover(S,E),E?(this.addClass(C.source,this.hoverSourceClass),this.addClass(C.target,this.hoverTargetClass)):(this.removeClass(C.source,this.hoverSourceClass),this.removeClass(C.target,this.hoverTargetClass)),this.fire(E?nh:th,x.jtk.connector.connection,b)}};this._connectorMouseover=t.bind(this,!0),this._connectorMouseout=t.bind(this,!1);var r=function(E,b){var x=ot(b).parentNode;x.jtk&&x.jtk.connector&&this.fire(E?rh:ih,x.jtk.connector.connection,b)};this._connectorMouseup=r.bind(this,!0),this._connectorMousedown=r.bind(this,!1),this._connectorContextmenu=(function(g){var E=ot(g).parentNode;E.jtk&&E.jtk.connector&&this.fire(oh,E.jtk.connector.connection,g)}).bind(this);var s=function(E,b,x){!b.defaultPrevented&&b._jsPlumbOverlay==null&&this.fire(E,x.jtk.endpoint,b)};this._endpointClick=s.bind(this,$f),this._endpointDblClick=s.bind(this,Wf);var l=function(E,b){var x=ot(b);x.jtk&&x.jtk.endpoint&&(this.setEndpointHover(x.jtk.endpoint,E),this.fire(E?zf:Kf,x.jtk.endpoint,b))};this._endpointMouseover=l.bind(this,!0),this._endpointMouseout=l.bind(this,!1);var u=function(E,b){var x=ot(b);x.jtk&&x.jtk.endpoint&&this.fire(E?Zf:Jf,x.jtk.endpoint,b)};this._endpointMouseup=u.bind(this,!0),this._endpointMousedown=u.bind(this,!1);var c=(function(g,E){var b=Rt(ot(E),Nt,this.getContainer(),!0),x=b.jtk.overlay;x&&this.fireOverlayMethod(x,g,E)}).bind(this);this._overlayClick=c.bind(this,et),this._overlayDblClick=c.bind(this,lt),this._overlayTap=c.bind(this,St),this._overlayDblTap=c.bind(this,xt);var f=function(E,b){var x=Rt(ot(b),Nt,this.getContainer(),!0),S=x.jtk.overlay;S&&this.setOverlayHover(S,E)};this._overlayMouseover=f.bind(this,!0),this._overlayMouseout=f.bind(this,!1);var h=function(E,b,x){b.defaultPrevented||this.fire(b.detail===1?is:Ff,x,b)};this._elementClick=h.bind(this,is);var v=function(E,b,x){b.defaultPrevented||this.fire(as,x,b)};this._elementTap=v.bind(this,as);var p=function(E,b,x){b.defaultPrevented||this.fire(os,x,b)};this._elementDblTap=p.bind(this,os);var y=function(E,b){this.fire(E?Uf:Bf,ot(b),b)};this._elementMouseenter=y.bind(this,!0),this._elementMouseexit=y.bind(this,!1),this._elementMousemove=(function(g){this.fire(Hf,ot(g),g)}).bind(this),this._elementMouseup=(function(g){this.fire(Vf,ot(g),g)}).bind(this),this._elementMousedown=(function(g){this.fire(Yf,ot(g),g)}).bind(this),this._elementContextmenu=(function(g){this.fire(Xf,ot(g),g)}).bind(this)}},{key:"_attachEventDelegates",value:function(){var e=this.getContainer();this.eventManager.on(e,et,Nt,this._overlayClick),this.eventManager.on(e,lt,Nt,this._overlayDblClick),this.eventManager.on(e,St,Nt,this._overlayTap),this.eventManager.on(e,xt,Nt,this._overlayDblTap),this.eventManager.on(e,et,mt,this._connectorClick),this.eventManager.on(e,lt,mt,this._connectorDblClick),this.eventManager.on(e,St,mt,this._connectorTap),this.eventManager.on(e,xt,mt,this._connectorDblTap),this.eventManager.on(e,et,fn,this._endpointClick),this.eventManager.on(e,lt,fn,this._endpointDblClick),this.eventManager.on(e,et,this.managedElementsSelector,this._elementClick),this.eventManager.on(e,St,this.managedElementsSelector,this._elementTap),this.eventManager.on(e,xt,this.managedElementsSelector,this._elementDblTap),this.eventManager.on(e,ht,mt,this._connectorMouseover),this.eventManager.on(e,ft,mt,this._connectorMouseout),this.eventManager.on(e,Gt,mt,this._connectorContextmenu),this.eventManager.on(e,ce,mt,this._connectorMouseup),this.eventManager.on(e,ue,mt,this._connectorMousedown),this.eventManager.on(e,ht,fn,this._endpointMouseover),this.eventManager.on(e,ft,fn,this._endpointMouseout),this.eventManager.on(e,ce,fn,this._endpointMouseup),this.eventManager.on(e,ue,fn,this._endpointMousedown),this.eventManager.on(e,ht,Nt,this._overlayMouseover),this.eventManager.on(e,ft,Nt,this._overlayMouseout),this.eventManager.on(e,ht,Ae,this._elementMouseenter),this.eventManager.on(e,ft,Ae,this._elementMouseexit),this.eventManager.on(e,Ve,Ae,this._elementMousemove),this.eventManager.on(e,ce,Ae,this._elementMouseup),this.eventManager.on(e,ue,Ae,this._elementMousedown),this.eventManager.on(e,Gt,Ae,this._elementContextmenu)}},{key:"_detachEventDelegates",value:function(){var e=this.getContainer();e&&(this.eventManager.off(e,et,this._connectorClick),this.eventManager.off(e,lt,this._connectorDblClick),this.eventManager.off(e,St,this._connectorTap),this.eventManager.off(e,xt,this._connectorDblTap),this.eventManager.off(e,et,this._endpointClick),this.eventManager.off(e,lt,this._endpointDblClick),this.eventManager.off(e,et,this._overlayClick),this.eventManager.off(e,lt,this._overlayDblClick),this.eventManager.off(e,St,this._overlayTap),this.eventManager.off(e,xt,this._overlayDblTap),this.eventManager.off(e,et,this._elementClick),this.eventManager.off(e,St,this._elementTap),this.eventManager.off(e,xt,this._elementDblTap),this.eventManager.off(e,ht,this._connectorMouseover),this.eventManager.off(e,ft,this._connectorMouseout),this.eventManager.off(e,Gt,this._connectorContextmenu),this.eventManager.off(e,ce,this._connectorMouseup),this.eventManager.off(e,ue,this._connectorMousedown),this.eventManager.off(e,ht,this._endpointMouseover),this.eventManager.off(e,ft,this._endpointMouseout),this.eventManager.off(e,ce,this._endpointMouseup),this.eventManager.off(e,ue,this._endpointMousedown),this.eventManager.off(e,ht,this._overlayMouseover),this.eventManager.off(e,ft,this._overlayMouseout),this.eventManager.off(e,ya,this._elementMouseenter),this.eventManager.off(e,ma,this._elementMouseexit),this.eventManager.off(e,Ve,this._elementMousemove),this.eventManager.off(e,ce,this._elementMouseup),this.eventManager.off(e,ue,this._elementMousedown),this.eventManager.off(e,Gt,this._elementContextmenu))}},{key:"setContainer",value:function(e){var t=this;if(e===document||e===document.body)throw new Error("Cannot set document or document.body as container element");this._detachEventDelegates();var r;this.dragManager!=null&&(r=this.dragManager.reset()),this.setAttribute(e,ns,He().replace("-",""));var s=this.getContainer();if(s!=null){s.removeAttribute(ns);var l=li(s.childNodes).filter(function(u){return u!=null&&(t.hasClass(u,ha)||t.hasClass(u,Zn)||t.hasClass(u,ro)||u.getAttribute&&u.getAttribute(Jt)!=null)});K(l,function(u){e.appendChild(u)})}Le(De(n.prototype),"setContainer",this).call(this,e),this.containerType=Go(e),this.eventManager!=null&&this._attachEventDelegates(),this.dragManager!=null&&(this.dragManager.addHandler(new Cs(this)),this.dragManager.addHandler(new Ps(this,this.dragSelection),this.groupDragOptions),this.elementDragHandler=new Yo(this,this.dragSelection),this.dragManager.addHandler(this.elementDragHandler,this.elementDragOptions),r!=null&&this.dragManager.setFilters(r))}},{key:"reset",value:function(){Le(De(n.prototype),"reset",this).call(this),this._resizeObserver&&this._resizeObserver.disconnect();var e=this.getContainer(),t=e.querySelectorAll([Ae,fn,mt,Nt].join(","));K(t,function(r){return r.parentNode&&r.parentNode.removeChild(r)})}},{key:"destroy",value:function(){this._detachEventDelegates(),this.dragManager!=null&&this.dragManager.reset(),this.clearDragSelection(),Le(De(n.prototype),"destroy",this).call(this)}},{key:"unmanage",value:function(e,t){this._resizeObserver!=null&&this._resizeObserver.unobserve(e),this.removeFromDragSelection(e),Le(De(n.prototype),"unmanage",this).call(this,e,t)}},{key:"addToDragSelection",value:function(){for(var e=this,t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];K(r,function(l){return e.dragSelection.add(l)})}},{key:"clearDragSelection",value:function(){this.dragSelection.clear()}},{key:"removeFromDragSelection",value:function(){for(var e=this,t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];K(r,function(l){return e.dragSelection.remove(l)})}},{key:"toggleDragSelection",value:function(){for(var e=this,t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];K(r,function(l){return e.dragSelection.toggle(l)})}},{key:"addToDragGroup",value:function(e){for(var t,r=arguments.length,s=new Array(r>1?r-1:0),l=1;l<r;l++)s[l-1]=arguments[l];(t=this.elementDragHandler).addToDragGroup.apply(t,[e].concat(s))}},{key:"removeFromDragGroup",value:function(){var e;(e=this.elementDragHandler).removeFromDragGroup.apply(e,arguments)}},{key:"setDragGroupState",value:function(e){for(var t,r=arguments.length,s=new Array(r>1?r-1:0),l=1;l<r;l++)s[l-1]=arguments[l];(t=this.elementDragHandler).setDragGroupState.apply(t,[e].concat(s))}},{key:"clearDragGroup",value:function(e){this.elementDragHandler.clearDragGroup(e)}},{key:"consume",value:function(e,t){Ur(e,t)}},{key:"rotate",value:function(e,t,r){var s=this.getId(e);return this._managedElements[s]?(this._managedElements[s].el.style.transform="rotate("+t+"deg)",this._managedElements[s].el.style.transformOrigin="center center",Le(De(n.prototype),"rotate",this).call(this,e,t,r)):{c:new Set,e:new Set}}},{key:"addOverlayClass",value:function(e,t){if(Xt(e))e.instance.addClass(Et(e),t);else if(Hn(e))e.instance.addClass(wr(e),t);else if($t(e))e.instance.addClass(vn(e),t);else throw"Could not add class to overlay of type ["+e.type+"]"}},{key:"removeOverlayClass",value:function(e,t){if(Xt(e))e.instance.removeClass(Et(e),t);else if(Hn(e))e.instance.removeClass(wr(e),t);else if($t(e))e.instance.removeClass(vn(e),t);else throw"Could not remove class from overlay of type ["+e.type+"]"}},{key:"_paintOverlay",value:function(e,t,r){if(Xt(e)){Et(e);var s=e.component.getXY();e.canvas.style.left=s.x+t.d.minx+"px",e.canvas.style.top=s.y+t.d.miny+"px"}else if(Hn(e)){var l=isNaN(t.d.cxy.x)||isNaN(t.d.cxy.y)?"M 0 0":"M"+t.d.hxy.x+","+t.d.hxy.y+" L"+t.d.tail[0].x+","+t.d.tail[0].y+" L"+t.d.cxy.x+","+t.d.cxy.y+" L"+t.d.tail[1].x+","+t.d.tail[1].y+" Z";Xd(e,l,t,r)}else if($t(e)){vn(e);var u=e.component.getXY();e.canvas.style.left=u.x+t.d.minx+"px",e.canvas.style.top=u.y+t.d.miny+"px"}else throw"Could not paint overlay of type ["+e.type+"]"}},{key:"setOverlayVisible",value:function(e,t){var r=t?"block":"none";function s(l){l!=null&&(l.style.display=r)}Xt(e)?s(Et(e)):$t(e)?s(vn(e)):Hn(e)&&s(e.path)}},{key:"reattachOverlay",value:function(e,t){Xt(e)?e.instance._appendElement(Et(e),this.getContainer()):$t(e)?e.instance._appendElement(vn(e),this.getContainer()):Hn(e)&&this._appendElement(wr(e),t.connector.canvas)}},{key:"setOverlayHover",value:function(e,t){var r;Xt(e)?r=Et(e):$t(e)?r=vn(e):Hn(e)&&(r=wr(e)),r!=null&&(this.hoverClass!=null&&(t?this.addClass(r,this.hoverClass):this.removeClass(r,this.hoverClass)),this.setHover(e.component,t))}},{key:"destroyOverlay",value:function(e){if(Xt(e)){var t=Et(e);t.parentNode.removeChild(t),delete e.canvas,delete e.cachedDimensions}else if($o(e)||Wo(e)||Ko(e))$d(e);else if($t(e)){var r=vn(e);r.parentNode.removeChild(r),delete e.canvas,delete e.cachedDimensions}}},{key:"drawOverlay",value:function(e,t,r,s){if(Xt(e)||$t(e)){var l=Da._getDimensions(e);if(l!=null&&l.w!=null&&l.h!=null){var u={x:0,y:0};if(s)u={x:s.x,y:s.y};else if(t instanceof ar){var c=Array.isArray(e.location)?e.location:[e.location,e.location];u={x:c[0]*t.w,y:c[1]*t.h}}else{var f=e.location,h=!1;(Ne(e.location)||e.location<0||e.location>1)&&(f=parseInt(""+e.location,10),h=!0),u=t.pointOnPath(f,h)}var v=u.x-l.w/2,p=u.y-l.h/2;return{component:e,d:{minx:v,miny:p,td:l,cxy:u},xmin:v,xmax:v+l.w,ymin:p,ymax:p+l.h}}else return{xmin:0,xmax:0,ymin:0,ymax:0}}else{if($o(e)||Wo(e)||Ko(e))return e.draw(t,r,s);throw"Could not draw overlay of type ["+e.type+"]"}}},{key:"updateLabel",value:function(e){if(Sn(e.label)){var t=e.label(this);t!=null?Et(e).innerText=t:Et(e).innerText=""}else e.labelText==null&&(e.labelText=e.label,e.labelText!=null?Et(e).innerText=e.labelText:Et(e).innerText="")}},{key:"setHover",value:function(e,t){e._hover=t,e instanceof Kn&&e.endpoint!=null?this.setEndpointHover(e,t,-1):e instanceof $r&&e.connector!=null&&this.setConnectorHover(e.connector,t)}},{key:"paintConnector",value:function(e,t,r){Wd(this,e,t,r)}},{key:"setConnectorHover",value:function(e,t,r){if(t===!1||!this.currentlyDragging&&!this.isHoverSuspended()){var s=e.canvas;s!=null&&(e.hoverClass!=null&&(t?this.addClass(s,e.hoverClass):this.removeClass(s,e.hoverClass)),t?this.addClass(s,this.hoverClass):this.removeClass(s,this.hoverClass)),e.connection.hoverPaintStyle!=null&&(e.connection.paintStyleInUse=t?e.connection.hoverPaintStyle:e.connection.paintStyle,this._suspendDrawing||this._paintConnection(e.connection)),e.connection.endpoints[0]!==r&&this.setEndpointHover(e.connection.endpoints[0],t,0,!0),e.connection.endpoints[1]!==r&&this.setEndpointHover(e.connection.endpoints[1],t,1,!0)}}},{key:"destroyConnector",value:function(e){e.connector!=null&&Us(e.connector)}},{key:"addConnectorClass",value:function(e,t){e.canvas&&this.addClass(e.canvas,t)}},{key:"removeConnectorClass",value:function(e,t){e.canvas&&this.removeClass(e.canvas,t)}},{key:"getConnectorClass",value:function(e){return e.canvas?e.canvas.className.baseVal:""}},{key:"setConnectorVisible",value:function(e,t){Bs(e,t)}},{key:"applyConnectorType",value:function(e,t){if(e.canvas&&t.cssClass){var r=Array.isArray(t.cssClass)?t.cssClass:[t.cssClass];this.addClass(e.canvas,r.join(" "))}}},{key:"addEndpointClass",value:function(e,t){var r=Cr(e.endpoint);r!=null&&this.addClass(r,t)}},{key:"applyEndpointType",value:function(e,t){if(t.cssClass){var r=Cr(e.endpoint);if(r){var s=Array.isArray(t.cssClass)?t.cssClass:[t.cssClass];this.addClass(r,s.join(" "))}}}},{key:"destroyEndpoint",value:function(e){var t=this.endpointAnchorClassPrefix+(e.currentAnchorClass?"-"+e.currentAnchorClass:"");this.removeClass(e.element,t),Us(e.endpoint)}},{key:"renderEndpoint",value:function(e,t){var r=fu[e.endpoint.type];r!=null?zd.paint(e.endpoint,r,t):Ue("jsPlumb: no endpoint renderer found for type ["+e.endpoint.type+"]")}},{key:"removeEndpointClass",value:function(e,t){var r=Cr(e.endpoint);r!=null&&this.removeClass(r,t)}},{key:"getEndpointClass",value:function(e){var t=Cr(e.endpoint);return t!=null?t.className:""}},{key:"setEndpointHover",value:function(e,t,r,s){if(e!=null&&(t===!1||!this.currentlyDragging&&!this.isHoverSuspended())){var l=Cr(e.endpoint);if(l!=null&&(e.hoverClass!=null&&(t?this.addClass(l,e.hoverClass):this.removeClass(l,e.hoverClass)),r===0||r===1)){var u=r===0?this.hoverSourceClass:this.hoverTargetClass;t?this.addClass(l,u):this.removeClass(l,u)}if(e.hoverPaintStyle!=null&&(e.paintStyleInUse=t?e.hoverPaintStyle:e.paintStyle,this._suspendDrawing||this.renderEndpoint(e,e.paintStyleInUse)),!s)for(var c=0;c<e.connections.length;c++)this.setConnectorHover(e.connections[c].connector,t,e)}}},{key:"setEndpointVisible",value:function(e,t){Bs(e.endpoint,t)}},{key:"setGroupVisible",value:function(e,t){for(var r=e.el.querySelectorAll(Ae),s=0;s<r.length;s++)t?this.show(r[s],!0):this.hide(r[s],!0)}},{key:"deleteConnection",value:function(e,t){return e!=null&&e.deleted!==!0?(e.endpoints[0].deleted!==!0&&this.setEndpointHover(e.endpoints[0],!1,0,!0),e.endpoints[1].deleted!==!0&&this.setEndpointHover(e.endpoints[1],!1,1,!0),Le(De(n.prototype),"deleteConnection",this).call(this,e,t)):!1}},{key:"addSourceSelector",value:function(e,t,r){return this.addDragFilter(e),Le(De(n.prototype),"addSourceSelector",this).call(this,e,t,r)}},{key:"removeSourceSelector",value:function(e){this.removeDragFilter(e.selector),Le(De(n.prototype),"removeSourceSelector",this).call(this,e)}},{key:"manage",value:function(e,t,r){if(this.containerType===Pn.SVG&&!zc(e))throw new Error("ERROR: cannot manage non-svg element when container is an SVG element.");var s=Le(De(n.prototype),"manage",this).call(this,e,t,r);return s!=null&&this._resizeObserver!=null&&this._resizeObserver.observe(s.el),s}}]),n}(pv),mv="circle",Ev=function(){Ia(Dn.type,{makeNode:function(n,i){return Ut(mv,{cx:n.w/2,cy:n.h/2,r:n.radius})},updateNode:function(n,i){Bt(i,{cx:""+n.w/2,cy:""+n.h/2,r:""+n.radius})}})},Wr=function(a){be(n,a);var o=xe(n);function n(i,e){var t;return X(this,n),t=o.call(this,i,e),d(m(t),"width",void 0),d(m(t),"height",void 0),d(m(t),"type",n.type),e=e||{},t.width=e.width||10,t.height=e.height||10,t}return J(n,null,[{key:"_getParams",value:function(e){return{width:e.width,height:e.height}}}]),n}(ar);d(Wr,"type","Rectangle");var bv={type:Wr.type,cls:Wr,compute:function(o,n,i,e){var t=e.width||o.width,r=e.height||o.height,s=n.curX-t/2,l=n.curY-r/2;return o.x=s,o.y=l,o.w=t,o.h=r,[s,l,t,r]},getParams:function(o){return{width:o.width,height:o.height}}},xv="rect",Sv=function(){Ia(Wr.type,{makeNode:function(n,i){return Ut(xv,{width:n.w,height:n.h})},updateNode:function(n,i){Bt(i,{width:n.w,height:n.h})}})},Ji=function(a){be(n,a);var o=xe(n);function n(i,e){var t;return X(this,n),t=o.call(this,i,e),d(m(t),"type",n.type),t}return n}(ar);d(Ji,"type","Blank");var Cv={type:Ji.type,cls:Ji,compute:function(o,n,i,e){return o.x=n.curX,o.y=n.curY,o.w=10,o.h=0,[n.curX,n.curY,10,0]},getParams:function(o){return{}}},Hs={width:10,height:0,fill:"transparent",stroke:"transparent"},Pv=function(){Ia(Ji.type,{makeNode:function(n,i){return Ut("rect",Hs)},updateNode:function(n,i){Bt(i,Hs)}})};Ev();Pv();Sv();var At;(function(a){a[a.top=0]="top",a[a.bottom=1]="bottom"})(At||(At={}));var Ma=new Map;Ma.set(At.top,[Mt.TopRight,Mt.TopLeft]);Ma.set(At.bottom,[Mt.BottomRight,Mt.BottomLeft]);var Tv={deriveAnchor:function(o,n,i,e){return Ma.get(o)[n]}},wa="jtk-scrollable-list",Ov=no(wa),Vs="scroll";(function(){function a(o,n){var i=this;X(this,a),this.instance=o,d(this,"options",void 0),d(this,"count",void 0),d(this,"lists",void 0),this.count=0,this.lists={},this.options=n||{},this.instance.bind(Nl,function(e){for(var t=i.instance.getSelector(e.el,Ov),r=0;r<t.length;r++)i.addList(t[r])}),this.instance.bind(Gl,function(e){i.removeList(e.el)}),this.instance.bind(va,function(e,t){if(t==null){var r=i.findParentList(e.target);r!=null&&r.newConnection(e.connection,e.target,1);var s=i.findParentList(e.source);s!=null&&s.newConnection(e.connection,e.source,0)}}),this.instance.bind(Fl,function(e){var t=e.dropEndpoint.element,r=i.findParentList(t);return r==null||t.offsetTop>=r.domElement.scrollTop&&t.offsetTop+t.offsetHeight<=r.domElement.scrollTop+r.domElement.offsetHeight})}return J(a,[{key:"addList",value:function(n,i){var e=W({},Tv);W(e,this.options),i=W(e,i||{});var t=[this.instance._instanceIndex,this.count++].join("_");return this.lists[t]=new Av(this.instance,n,i,t),this.lists[t]}},{key:"getList",value:function(n){var i=this.instance.getAttribute(n,wa);if(i!=null)return this.lists[i]}},{key:"removeList",value:function(n){var i=this.getList(n);i&&(i.destroy(),delete this.lists[i.id])}},{key:"findParentList",value:function(n){for(var i=n.parentNode,e=this.instance.getContainer(),t;i!=null&&i!==e&&i!==document;){if(t=this.getList(i),t!=null)return t;i=i.parentNode}}}]),a})();var Av=function(){function a(o,n,i,e){X(this,a),this.instance=o,this.el=n,this.options=i,this.id=e,d(this,"_scrollHandler",void 0),d(this,"domElement",void 0),d(this,"elId",void 0),this.domElement=n,this.elId=this.instance.getId(n),o.setAttribute(n,wa,e),this._scrollHandler=this.scrollHandler.bind(this),this.domElement._jsPlumbScrollHandler=this._scrollHandler,o.on(n,Vs,this._scrollHandler),this._scrollHandler()}return J(a,[{key:"deriveAnchor",value:function(n,i,e,t){return this.options.anchor?this.options.anchor:this.options.deriveAnchor(n,i,e,t)}},{key:"deriveEndpoint",value:function(n,i,e,t){return this.options.deriveEndpoint?this.options.deriveEndpoint(n,i,e,t):this.options.endpoint?this.options.endpoint:e.endpoint.type}},{key:"newConnection",value:function(n,i,e){i.offsetTop<this.el.scrollTop?this._proxyConnection(i,n,e,At.top):i.offsetTop+i.offsetHeight>this.el.scrollTop+this.domElement.offsetHeight&&this._proxyConnection(i,n,e,At.bottom)}},{key:"scrollHandler",value:function(){for(var n=this,i=this.instance.getSelector(this.el,Ae),e=function(s){if(i[s].offsetTop<n.el.scrollTop)i[s]._jsPlumbProxies=i[s]._jsPlumbProxies||[],n.instance.select({source:i[s]}).each(function(u){n._proxyConnection(i[s],u,0,At.top)}),n.instance.select({target:i[s]}).each(function(u){n._proxyConnection(i[s],u,1,At.top)});else if(i[s].offsetTop+i[s].offsetHeight>n.el.scrollTop+n.domElement.offsetHeight)i[s]._jsPlumbProxies=i[s]._jsPlumbProxies||[],n.instance.select({source:i[s]}).each(function(u){n._proxyConnection(i[s],u,0,At.bottom)}),n.instance.select({target:i[s]}).each(function(u){n._proxyConnection(i[s],u,1,At.bottom)});else if(i[s]._jsPlumbProxies){for(var l=0;l<i[s]._jsPlumbProxies.length;l++)n.instance.unproxyConnection(i[s]._jsPlumbProxies[l][0],i[s]._jsPlumbProxies[l][1]);delete i[s]._jsPlumbProxies}n.instance.revalidate(i[s])},t=0;t<i.length;t++)e(t)}},{key:"_proxyConnection",value:function(n,i,e,t){var r=this;this.instance.proxyConnection(i,e,this.domElement,function(s,l){return r.deriveEndpoint(t,l,i.endpoints[l],i)},function(s,l){return r.deriveAnchor(t,l,i.endpoints[l],i)}),n._jsPlumbProxies=n._jsPlumbProxies||[],n._jsPlumbProxies.push([i,e])}},{key:"destroy",value:function(){this.instance.off(this.el,Vs,this._scrollHandler),delete this.domElement._jsPlumbScrollHandler;for(var n=this.instance.getSelector(this.el,Ae),i=0;i<n.length;i++)if(n[i]._jsPlumbProxies){for(var e=0;e<n[i]._jsPlumbProxies.length;e++)this.instance.unproxyConnection(n[i]._jsPlumbProxies[e][0],n[i]._jsPlumbProxies[e][1]);delete n[i]._jsPlumbProxies}}}]),a}(),Ys=1e-10;function Xs(a){var o=Math.floor(a),n=Math.ceil(a);return a-o<Ys?o:n-a<Ys?n:a}var ka=function(a){be(n,a);var o=xe(n);function n(i){var e;X(this,n),e=o.call(this,i),d(m(e),"type",n.segmentType),d(m(e),"cx",void 0),d(m(e),"cy",void 0),d(m(e),"radius",void 0),d(m(e),"anticlockwise",void 0),d(m(e),"startAngle",void 0),d(m(e),"endAngle",void 0),d(m(e),"sweep",void 0),d(m(e),"length",void 0),d(m(e),"circumference",void 0),d(m(e),"frac",void 0),e.cx=i.cx,e.cy=i.cy,e.radius=i.r,e.anticlockwise=i.ac,i.startAngle&&i.endAngle?(e.startAngle=i.startAngle,e.endAngle=i.endAngle,e.x1=e.cx+e.radius*Math.cos(e.startAngle),e.y1=e.cy+e.radius*Math.sin(e.startAngle),e.x2=e.cx+e.radius*Math.cos(e.endAngle),e.y2=e.cy+e.radius*Math.sin(e.endAngle)):(e.startAngle=e._calcAngle(e.x1,e.y1),e.endAngle=e._calcAngle(e.x2,e.y2)),e.endAngle<0&&(e.endAngle+=hn),e.startAngle<0&&(e.startAngle+=hn);var t=e.endAngle<e.startAngle?e.endAngle+hn:e.endAngle;return e.sweep=Math.abs(t-e.startAngle),e.anticlockwise&&(e.sweep=hn-e.sweep),e.circumference=2*Math.PI*e.radius,e.frac=e.sweep/hn,e.length=e.circumference*e.frac,e.extents={xmin:e.cx-e.radius,xmax:e.cx+e.radius,ymin:e.cy-e.radius,ymax:e.cy+e.radius},e}return J(n,[{key:"_calcAngle",value:function(e,t){return Ih({x:this.cx,y:this.cy},{x:e,y:t})}},{key:"_calcAngleForLocation",value:function(e,t){if(e.anticlockwise){var r=e.startAngle<e.endAngle?e.startAngle+hn:e.startAngle,s=Math.abs(r-e.endAngle);return r-s*t}else{var l=e.endAngle<e.startAngle?e.endAngle+hn:e.endAngle,u=Math.abs(l-e.startAngle);return e.startAngle+u*t}}},{key:"getPath",value:function(e){var t=this.sweep>Math.PI?1:0,r=this.anticlockwise?0:1;return(e?"M"+this.x1+" "+this.y1+" ":"")+"A "+this.radius+" "+this.radius+" 0 "+t+","+r+" "+this.x2+" "+this.y2}},{key:"getLength",value:function(){return this.length}},{key:"pointOnPath",value:function(e,t){if(e===0)return{x:this.x1,y:this.y1,theta:this.startAngle};if(e===1)return{x:this.x2,y:this.y2,theta:this.endAngle};t&&(e=e/length);var r=this._calcAngleForLocation(this,e),s=this.cx+this.radius*Math.cos(r),l=this.cy+this.radius*Math.sin(r);return{x:Xs(s),y:Xs(l),theta:r}}},{key:"gradientAtPoint",value:function(e,t){var r=this.pointOnPath(e,t),s=_h({x:this.cx,y:this.cy},r);return!this.anticlockwise&&(s===1/0||s===-1/0)&&(s*=-1),s}},{key:"pointAlongPathFrom",value:function(e,t,r){var s=this.pointOnPath(e,r),l=t/this.circumference*2*Math.PI,u=this.anticlockwise?-1:1,c=s.theta+u*l,f=this.cx+this.radius*Math.cos(c),h=this.cy+this.radius*Math.sin(c);return{x:f,y:h}}}]),n}(Ea);d(ka,"segmentType","Arc");var hu=function(a){be(n,a);var o=xe(n);function n(i,e){var t;return X(this,n),t=o.call(this,i,e),t.connection=i,d(m(t),"showLoopback",void 0),d(m(t),"curviness",void 0),d(m(t),"margin",void 0),d(m(t),"proximityLimit",void 0),d(m(t),"orientation",void 0),d(m(t),"loopbackRadius",void 0),d(m(t),"clockwise",void 0),d(m(t),"isLoopbackCurrently",void 0),d(m(t),"geometry",null),e=e||{},t.showLoopback=e.showLoopback!==!1,t.curviness=e.curviness||10,t.margin=e.margin||5,t.proximityLimit=e.proximityLimit||80,t.clockwise=e.orientation&&e.orientation==="clockwise",t.loopbackRadius=e.loopbackRadius||25,t.isLoopbackCurrently=!1,t}return J(n,[{key:"getDefaultStubs",value:function(){return[0,0]}},{key:"_compute",value:function(e,t){var r=t.sourcePos,s=t.targetPos,l=Math.abs(r.curX-s.curX),u=Math.abs(r.curY-s.curY);if(!this.showLoopback||t.sourceEndpoint.elementId!==t.targetEndpoint.elementId)this.isLoopbackCurrently=!1,this._computeBezier(e,t,r,s,l,u);else{this.isLoopbackCurrently=!0;var c=t.sourcePos.curX,f=t.sourcePos.curY-this.margin,h=c,v=f-this.loopbackRadius,p=h-this.loopbackRadius,y=v-this.loopbackRadius;l=2*this.loopbackRadius,u=2*this.loopbackRadius,e.points[0]=p,e.points[1]=y,e.points[2]=l,e.points[3]=u,this._addSegment(ka,{loopback:!0,x1:c-p+4,y1:f-y,startAngle:0,endAngle:2*Math.PI,r:this.loopbackRadius,ac:!this.clockwise,x2:c-p-4,y2:f-y,cx:h-p,cy:v-y})}}},{key:"exportGeometry",value:function(){return this.geometry==null?null:{controlPoints:[W({},this.geometry.controlPoints[0]),W({},this.geometry.controlPoints[1])],source:W({},this.geometry.source),target:W({},this.geometry.target)}}},{key:"transformGeometry",value:function(e,t,r){return{controlPoints:[{x:e.controlPoints[0].x+t,y:e.controlPoints[0].y+r},{x:e.controlPoints[1].x+t,y:e.controlPoints[1].y+r}],source:this.transformAnchorPlacement(e.source,t,r),target:this.transformAnchorPlacement(e.target,t,r)}}},{key:"importGeometry",value:function(e){return e!=null?e.controlPoints==null||e.controlPoints.length!=2?(Ue("jsPlumb Bezier: cannot import geometry; controlPoints missing or does not have length 2"),this.setGeometry(null,!0),!1):e.controlPoints[0].x==null||e.controlPoints[0].y==null||e.controlPoints[1].x==null||e.controlPoints[1].y==null?(Ue("jsPlumb Bezier: cannot import geometry; controlPoints malformed"),this.setGeometry(null,!0),!1):e.source==null||e.source.curX==null||e.source.curY==null?(Ue("jsPlumb Bezier: cannot import geometry; source missing or malformed"),this.setGeometry(null,!0),!1):e.target==null||e.target.curX==null||e.target.curY==null?(Ue("jsPlumb Bezier: cannot import geometry; target missing or malformed"),this.setGeometry(null,!0),!1):(this.setGeometry(e,!1),!0):!1}}]),n}(oo),Dt={subtract:function(o,n){return{x:o.x-n.x,y:o.y-n.y}},dotProduct:function(o,n){return o.x*n.x+o.y*n.y},square:function(o){return Math.sqrt(o.x*o.x+o.y*o.y)},scale:function(o,n){return{x:o.x*n,y:o.y*n}}},du=64,Dv=Math.pow(2,-du-1);function _v(a,o){for(var n=[],i=Mv(a,o),e=o.length-1,t=2*e-1,r=zo(i,t,n,0),s=Dt.subtract(a,o[0]),l=Dt.square(s),u=0,c,f=0;f<r;f++)s=Dt.subtract(a,La(o,e,n[f],null,null)),c=Dt.square(s),c<l&&(l=c,u=n[f]);return s=Dt.subtract(a,o[e]),c=Dt.square(s),c<l&&(l=c,u=1),{location:u,distance:l}}function Iv(a,o){var n=_v(a,o);return{point:La(o,o.length-1,n.location,null,null),location:n.location}}function Mv(a,o){for(var n=o.length-1,i=2*n-1,e=[],t=[],r=[],s=[],l=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],u=0;u<=n;u++)e[u]=Dt.subtract(o[u],a);for(var c=0;c<=n-1;c++)t[c]=Dt.subtract(o[c+1],o[c]),t[c]=Dt.scale(t[c],3);for(var f=0;f<=n-1;f++)for(var h=0;h<=n;h++)r[f]||(r[f]=[]),r[f][h]=Dt.dotProduct(t[f],e[h]);for(var v=0;v<=i;v++)s[v]||(s[v]=[]),s[v].y=0,s[v].x=parseFloat(""+v)/i;for(var p=n,y=n-1,g=0;g<=p+y;g++)for(var E=Math.max(0,g-y),b=Math.min(g,p),x=E;x<=b;x++){var S=g-x;s[x+S].y+=r[S][x]*l[S][x]}return s}function zo(a,o,n,i){var e=[],t=[],r,s,l=[],u=[];switch(wv(a,o)){case 0:return 0;case 1:{if(i>=du)return n[0]=(a[0].x+a[o].x)/2,1;if(kv(a,o))return n[0]=Lv(a,o),1;break}}La(a,o,.5,e,t),r=zo(e,o,l,i+1),s=zo(t,o,u,i+1);for(var c=0;c<r;c++)n[c]=l[c];for(var f=0;f<s;f++)n[f+r]=u[f];return r+s}function wv(a,o){var n=0,i,e;i=e=Fi(a[0].y);for(var t=1;t<=o;t++)i=Fi(a[t].y),i!=e&&n++,e=i;return n}function kv(a,o){var n,i,e,t,r,s,l,u,c,f,h,v,p,y,g,E;s=a[0].y-a[o].y,l=a[o].x-a[0].x,u=a[0].x*a[o].y-a[o].x*a[0].y;var b,x;b=x=0;for(var S=1;S<o;S++){var C=s*a[S].x+l*a[S].y+u;C>b?b=C:C<x&&(x=C)}return h=0,v=1,p=0,y=s,g=l,E=u-b,c=h*g-y*v,f=1/c,i=(v*E-g*p)*f,y=s,g=l,E=u-x,c=h*g-y*v,f=1/c,e=(v*E-g*p)*f,t=Math.min(i,e),r=Math.max(i,e),n=r-t,n<Dv?1:0}function Lv(a,o){var n=1,i=0,e=a[o].x-a[0].x,t=a[o].y-a[0].y,r=a[0].x-0,s=a[0].y-0,l=e*i-t*n,u=1/l,c=(e*s-t*r)*u;return 0+n*c}function La(a,o,n,i,e){for(var t=[[]],r=0;r<=o;r++)t[0][r]=a[r];for(var s=1;s<=o;s++)for(var l=0;l<=o-s;l++)t[s]||(t[s]=[]),t[s][l]||(t[s][l]={}),t[s][l].x=(1-n)*t[s-1][l].x+n*t[s-1][l+1].x,t[s][l].y=(1-n)*t[s-1][l].y+n*t[s-1][l+1].y;if(i!=null)for(var u=0;u<=o;u++)i[u]=t[u][0];if(e!=null)for(var c=0;c<=o;c++)e[c]=t[o-c][c];return t[o][0]}function Nv(a,o){var n=[];a--;for(var i=0;i<=a;i++)n.push(Rv(i/a,o));return n}function Rv(a,o){var n={x:0,y:0};if(a===0)return o[0];var i=o.length-1;if(a===1)return o[i];var e=o,t=1-a;if(i===0)return o[0];if(i===1)return{x:t*e[0].x+a*e[1].x,y:t*e[0].y+a*e[1].y};if(4>i){var r=t*t,s=a*a,l=0,u,c,f;return i===2?(e=[e[0],e[1],e[2],n],u=r,c=2*(t*a),f=s):i===3&&(u=r*t,c=3*(r*a),f=3*(t*s),l=a*s),{x:u*e[0].x+c*e[1].x+f*e[2].x+l*e[3].x,y:u*e[0].y+c*e[1].y+f*e[2].y+l*e[3].y}}else return n}function Gv(a){var o=0;if(!pu(a))for(var n=16,i=Nv(n,a),e=0;e<n-1;e++){var t=i[e],r=i[e+1];o+=vu(t,r)}return o}var $s=new Map;function jv(a){var o=$s.get(a);if(!o){o=[];var n=function(){return function(v){return Math.pow(v,a)}},i=function(){return function(v){return Math.pow(1-v,a)}},e=function(v){return function(p){return v}},t=function(){return function(v){return v}},r=function(){return function(v){return 1-v}},s=function(v){return function(p){for(var y=1,g=0;g<v.length;g++)y=y*v[g](p);return y}};o.push(n());for(var l=1;l<a;l++){for(var u=[e(a)],c=0;c<a-l;c++)u.push(t());for(var f=0;f<l;f++)u.push(r());o.push(s(u))}o.push(i()),$s.set(a,o)}return o}function Kr(a,o){for(var n=jv(a.length-1),i=0,e=0,t=0;t<a.length;t++)i=i+a[t].x*n[t](o),e=e+a[t].y*n[t](o);return{x:i,y:e}}function vu(a,o){return Math.sqrt(Math.pow(a.x-o.x,2)+Math.pow(a.y-o.y,2))}function pu(a){return a[0].x===a[1].x&&a[0].y===a[1].y}function gu(a,o,n){if(pu(a))return{point:a[0],location:o};for(var i=Kr(a,o),e=0,t=o,r=n>0?1:-1,s=null;e<Math.abs(n);)t+=.005*r,s=Kr(a,t),e+=vu(s,i),i=s;return{point:s,location:t}}function Fv(a,o,n){return gu(a,o,n).point}function Bv(a,o,n){return gu(a,o,n).location}function Uv(a,o){var n=Kr(a,o),i=Kr(a.slice(0,a.length-1),o),e=i.y-n.y,t=i.x-n.x;return e===0?1/0:Math.atan(e/t)}function Hv(a,o,n,i,e){var t=i-o,r=a-n,s=a*(o-i)+o*(n-a),l=Vv(e),u=[t*l[0][0]+r*l[1][0],t*l[0][1]+r*l[1][1],t*l[0][2]+r*l[1][2],t*l[0][3]+r*l[1][3]+s],c=Yv.apply(null,u),f=[];if(c!=null)for(var h=0;h<3;h++){var v=c[h],p=Math.pow(v,2),y=Math.pow(v,3),g={x:l[0][0]*y+l[0][1]*p+l[0][2]*v+l[0][3],y:l[1][0]*y+l[1][1]*p+l[1][2]*v+l[1][3]},E=void 0;n-a!==0?E=(g[0]-a)/(n-a):E=(g[1]-o)/(i-o),v>=0&&v<=1&&E>=0&&E<=1&&f.push(g)}return f}function Ws(a,o){return[-a[0][o]+3*a[1][o]+-3*a[2][o]+a[3][o],3*a[0][o]-6*a[1][o]+3*a[2][o],-3*a[0][o]+3*a[1][o],a[0][o]]}function Vv(a){return[Ws(a,"x"),Ws(a,"y")]}function Yv(a,o,n,i){var e=o/a,t=n/a,r=i/a,s=(3*t-Math.pow(e,2))/9,l=(9*e*t-27*r-2*Math.pow(e,3))/54,u=Math.pow(s,3)+Math.pow(l,2),c,f,h=[0,0,0];if(u>=0)c=Fi(l+Math.sqrt(u))*Math.pow(Math.abs(l+Math.sqrt(u)),1/3),f=Fi(l-Math.sqrt(u))*Math.pow(Math.abs(l-Math.sqrt(u)),1/3),h[0]=-e/3+(c+f),h[1]=-e/3-(c+f)/2,h[2]=-e/3-(c+f)/2,Math.abs(Math.sqrt(3)*(c-f)/2)!==0&&(h[1]=-1,h[2]=-1);else{var v=Math.acos(l/Math.sqrt(-Math.pow(s,3)));h[0]=2*Math.sqrt(-s)*Math.cos(v/3)-e/3,h[1]=2*Math.sqrt(-s)*Math.cos((v+2*Math.PI)/3)-e/3,h[2]=2*Math.sqrt(-s)*Math.cos((v+4*Math.PI)/3)-e/3}for(var p=0;p<3;p++)(h[p]<0||h[p]>1)&&(h[p]=-1);return h}var Na=function(a){be(n,a);var o=xe(n);function n(i){var e;return X(this,n),e=o.call(this,i),d(m(e),"curve",void 0),d(m(e),"cp1x",void 0),d(m(e),"cp1y",void 0),d(m(e),"cp2x",void 0),d(m(e),"cp2y",void 0),d(m(e),"length",0),d(m(e),"type",n.segmentType),e.cp1x=i.cp1x,e.cp1y=i.cp1y,e.cp2x=i.cp2x,e.cp2y=i.cp2y,e.x1=i.x1,e.x2=i.x2,e.y1=i.y1,e.y2=i.y2,e.curve=[{x:e.x1,y:e.y1},{x:e.cp1x,y:e.cp1y},{x:e.cp2x,y:e.cp2y},{x:e.x2,y:e.y2}],e.extents={xmin:Math.min(e.x1,e.x2,e.cp1x,e.cp2x),ymin:Math.min(e.y1,e.y2,e.cp1y,e.cp2y),xmax:Math.max(e.x1,e.x2,e.cp1x,e.cp2x),ymax:Math.max(e.y1,e.y2,e.cp1y,e.cp2y)},e}return J(n,[{key:"getPath",value:function(e){return(e?"M "+this.x2+" "+this.y2+" ":"")+"C "+this.cp2x+" "+this.cp2y+" "+this.cp1x+" "+this.cp1y+" "+this.x1+" "+this.y1}},{key:"pointOnPath",value:function(e,t){return e=n._translateLocation(this.curve,e,t),Kr(this.curve,e)}},{key:"gradientAtPoint",value:function(e,t){return e=n._translateLocation(this.curve,e,t),Uv(this.curve,e)}},{key:"pointAlongPathFrom",value:function(e,t,r){return e=n._translateLocation(this.curve,e,r),Fv(this.curve,e,t)}},{key:"getLength",value:function(){return(this.length==null||this.length===0)&&(this.length=Gv(this.curve)),this.length}},{key:"findClosestPointOnPath",value:function(e,t){var r=Iv({x:e,y:t},this.curve);return{d:Math.sqrt(Math.pow(r.point.x-e,2)+Math.pow(r.point.y-t,2)),x:r.point.x,y:r.point.y,l:1-r.location,s:this,x1:null,y1:null,x2:null,y2:null}}},{key:"lineIntersection",value:function(e,t,r,s){return Hv(e,t,r,s,this.curve)}}],[{key:"_translateLocation",value:function(e,t,r){return r&&(t=Bv(e,t>0?0:1,t)),t}}]),n}(Ea);d(Na,"segmentType","Bezier");var Zo=function(a){be(n,a);var o=xe(n);function n(i,e){var t;return X(this,n),t=o.call(this,i,e),t.connection=i,d(m(t),"type",n.type),d(m(t),"majorAnchor",void 0),d(m(t),"minorAnchor",void 0),e=e||{},t.majorAnchor=e.curviness||150,t.minorAnchor=10,t}return J(n,[{key:"getCurviness",value:function(){return this.majorAnchor}},{key:"_findControlPoint",value:function(e,t,r,s,l){var u=s[0]!==l[0]||s[1]===l[1],c={x:0,y:0};return u?(l[0]===0?c.x=r.curX<t.curX?e.x+this.minorAnchor:e.x-this.minorAnchor:c.x=e.x+this.majorAnchor*l[0],l[1]===0?c.y=r.curY<t.curY?e.y+this.minorAnchor:e.y-this.minorAnchor:c.y=e.y+this.majorAnchor*s[1]):(s[0]===0?c.x=t.curX<r.curX?e.x+this.minorAnchor:e.x-this.minorAnchor:c.x=e.x-this.majorAnchor*s[0],s[1]===0?c.y=t.curY<r.curY?e.y+this.minorAnchor:e.y-this.minorAnchor:c.y=e.y+this.majorAnchor*l[1]),c}},{key:"_computeBezier",value:function(e,t,r,s,l,u){var c,f,h=r.curX<s.curX?l:0,v=r.curY<s.curY?u:0,p=r.curX<s.curX?0:l,y=r.curY<s.curY?0:u;this.edited!==!0?(c=this._findControlPoint({x:h,y:v},r,s,e.so,e.to),f=this._findControlPoint({x:p,y},s,r,e.to,e.so)):(c=this.geometry.controlPoints[0],f=this.geometry.controlPoints[1]),this.geometry={controlPoints:[c,f],source:t.sourcePos,target:t.targetPos},this._addSegment(Na,{x1:h,y1:v,x2:p,y2:y,cp1x:c.x,cp1y:c.y,cp2x:f.x,cp2y:f.y})}}]),n}(hu);d(Zo,"type","Bezier");function Xv(a,o,n,i){return a<=n&&i<=o?1:a<=n&&o<=i?2:n<=a&&i>=o?3:4}function $v(a,o,n,i,e,t,r,s,l){if(s<=l)return{x:a,y:o};if(n===1)return i.curY<=0&&e.curY>=1?{x:a+(i.x<.5?-1*t:t),y:o}:i.curX>=1&&e.curX<=0?{x:a,y:o+(i.y<.5?-1*r:r)}:{x:a+-1*t,y:o+-1*r};if(n===2)return i.curY>=1&&e.curY<=0?{x:a+(i.x<.5?-1*t:t),y:o}:i.curX>=1&&e.curX<=0?{x:a,y:o+(i.y<.5?-1*r:r)}:{x:a+t,y:o+-1*r};if(n===3)return i.curY>=1&&e.curY<=0?{x:a+(i.x<.5?-1*t:t),y:o}:i.curX<=0&&e.curX>=1?{x:a,y:o+(i.y<.5?-1*r:r)}:{x:a+-1*t,y:o+-1*r};if(n===4)return i.curY<=0&&e.curY>=1?{x:a+(i.x<.5?-1*t:t),y:o}:i.curX<=0&&e.curX>=1?{x:a,y:o+(i.y<.5?-1*r:r)}:{x:a+t,y:o+-1*r}}var Jo=function(a){be(n,a);var o=xe(n);function n(i,e){var t;return X(this,n),t=o.call(this,i,e),t.connection=i,d(m(t),"type",n.type),d(m(t),"_controlPoint",void 0),t.curviness=e.curviness||10,t.margin=e.margin||5,t.proximityLimit=e.proximityLimit||80,t.clockwise=e.orientation&&e.orientation==="clockwise",t}return J(n,[{key:"_computeBezier",value:function(e,t,r,s,l,u){var c=r.curX<s.curX?0:l,f=r.curY<s.curY?0:u,h=r.curX<s.curX?l:0,v=r.curY<s.curY?u:0;if(r.x===0&&(c-=this.margin),r.x===1&&(c+=this.margin),r.y===0&&(f-=this.margin),r.y===1&&(f+=this.margin),s.x===0&&(h-=this.margin),s.x===1&&(h+=this.margin),s.y===0&&(v-=this.margin),s.y===1&&(v+=this.margin),this.edited!==!0){var p=(c+h)/2,y=(f+v)/2,g=Xv(c,f,h,v),E=Math.sqrt(Math.pow(h-c,2)+Math.pow(v-f,2));this._controlPoint=$v(p,y,g,t.sourcePos,t.targetPos,this.curviness,this.curviness,E,this.proximityLimit)}else this._controlPoint=this.geometry.controlPoints[0];var b,x,S,C;b=this._controlPoint.x,x=this._controlPoint.x,S=this._controlPoint.y,C=this._controlPoint.y,this.geometry={controlPoints:[this._controlPoint,this._controlPoint],source:t.sourcePos,target:t.targetPos},this._addSegment(Na,{x1:h,y1:v,x2:c,y2:f,cp1x:b,cp1y:S,cp2x:x,cp2y:C})}}]),n}(hu);d(Jo,"type","StateMachine");Qr.register(Zo.type,Zo);Qr.register(Jo.type,Jo);function Ks(a){return a<0?-1:a===0?0:1}function zs(a){return[Ks(a[2]-a[0]),Ks(a[3]-a[1])]}function Zs(a){return Math.sqrt(Math.pow(a[0]-a[2],2)+Math.pow(a[1]-a[3],2))}function Js(a){var o=[];return o.push.apply(o,a),o}var Qo=function(a){be(n,a);var o=xe(n);function n(i,e){var t;return X(this,n),t=o.call(this,i,e),t.connection=i,d(m(t),"type",n.type),d(m(t),"internalSegments",[]),d(m(t),"midpoint",void 0),d(m(t),"alwaysRespectStubs",void 0),d(m(t),"cornerRadius",void 0),d(m(t),"lastx",void 0),d(m(t),"lasty",void 0),d(m(t),"lastOrientation",void 0),d(m(t),"loopbackRadius",void 0),d(m(t),"isLoopbackCurrently",void 0),t.midpoint=e.midpoint==null||isNaN(e.midpoint)?.5:e.midpoint,t.cornerRadius=e.cornerRadius!=null?e.cornerRadius:0,t.alwaysRespectStubs=e.alwaysRespectStubs===!0,t.lastx=null,t.lasty=null,t.lastOrientation=null,t.loopbackRadius=e.loopbackRadius||25,t.isLoopbackCurrently=!1,t}return J(n,[{key:"getDefaultStubs",value:function(){return[30,30]}},{key:"addASegment",value:function(e,t,r){if(!(this.lastx===e&&this.lasty===t)){var s=this.lastx==null?r.sx:this.lastx,l=this.lasty==null?r.sy:this.lasty,u=s===e?"v":"h";this.lastx=e,this.lasty=t,this.internalSegments.push([s,l,e,t,u])}}},{key:"writeSegments",value:function(e){for(var t=null,r,s,l,u=0;u<this.internalSegments.length-1;u++){if(t=t||Js(this.internalSegments[u]),r=Js(this.internalSegments[u+1]),s=zs(t),l=zs(r),this.cornerRadius>0&&t[4]!==r[4]){var c=Math.min(Zs(t),Zs(r)),f=Math.min(this.cornerRadius,c/2);t[2]-=s[0]*f,t[3]-=s[1]*f,r[0]+=l[0]*f,r[1]+=l[1]*f;var h=s[1]===l[0]&&l[0]===1||s[1]===l[0]&&l[0]===0&&s[0]!==l[1]||s[1]===l[0]&&l[0]===-1,v=r[1]>t[3]?1:-1,p=r[0]>t[2]?1:-1,y=v===p,g=y&&h||!y&&!h?r[0]:t[2],E=y&&h||!y&&!h?t[3]:r[1];this._addSegment(xn,{x1:t[0],y1:t[1],x2:t[2],y2:t[3]}),this._addSegment(ka,{r:f,x1:t[2],y1:t[3],x2:r[0],y2:r[1],cx:g,cy:E,ac:h})}else this._addSegment(xn,{x1:t[0],y1:t[1],x2:t[2],y2:t[3]});t=r}r!=null&&this._addSegment(xn,{x1:r[0],y1:r[1],x2:r[2],y2:r[3]})}},{key:"_compute",value:function(e,t){var r=this;this.internalSegments.length=0,this.lastx=null,this.lasty=null,this.lastOrientation=null;var s=function(O){return[e.startStubX,e.startStubY,e.endStubX,e.endStubY]},l={perpendicular:s,orthogonal:s,opposite:function(O){var P=e,D=O==="x"?0:1,I={x:function(){return P.so[D]===1&&(P.startStubX>P.endStubX&&P.tx>P.startStubX||P.sx>P.endStubX&&P.tx>P.sx)||P.so[D]===-1&&(P.startStubX<P.endStubX&&P.tx<P.startStubX||P.sx<P.endStubX&&P.tx<P.sx)},y:function(){return P.so[D]===1&&(P.startStubY>P.endStubY&&P.ty>P.startStubY||P.sy>P.endStubY&&P.ty>P.sy)||P.so[D]===-1&&(P.startStubY<P.endStubY&&P.ty<P.startStubY||P.sy<P.endStubY&&P.ty<P.sy)}};return!r.alwaysRespectStubs&&I[O]()?{x:[(e.sx+e.tx)/2,e.startStubY,(e.sx+e.tx)/2,e.endStubY],y:[e.startStubX,(e.sy+e.ty)/2,e.endStubX,(e.sy+e.ty)/2]}[O]:[e.startStubX,e.startStubY,e.endStubX,e.endStubY]}},u=l[e.anchorOrientation](e.sourceAxis),c=e.sourceAxis==="x"?0:1,f=e.sourceAxis==="x"?1:0,h=u[c],v=u[f],p=u[c+2],y=u[f+2];this.addASegment(u[0],u[1],e);var g=e.startStubX+(e.endStubX-e.startStubX)*this.midpoint,E=e.startStubY+(e.endStubY-e.startStubY)*this.midpoint,b={x:[0,1],y:[1,0]},x={perpendicular:function(O,P,D,I,G){var w=e,R={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]},L={x:[[w.startStubX,w.endStubX],null,[w.endStubX,w.startStubX]],y:[[w.startStubY,w.endStubY],null,[w.endStubY,w.startStubY]]},k={x:[[g,w.startStubY],[g,w.endStubY]],y:[[w.startStubX,E],[w.endStubX,E]]},N={x:[[w.endStubX,w.startStubY]],y:[[w.startStubX,w.endStubY]]},H={x:[[w.startStubX,w.endStubY],[w.endStubX,w.endStubY]],y:[[w.endStubX,w.startStubY],[w.endStubX,w.endStubY]]},oe={x:[[w.startStubX,E],[w.endStubX,E],[w.endStubX,w.endStubY]],y:[[g,w.startStubY],[g,w.endStubY],[w.endStubX,w.endStubY]]},fe={x:[w.startStubY,w.endStubY],y:[w.startStubX,w.endStubX]},Re=b[O][0],Se=b[O][1],B=w.so[Re]+1,$=w.to[Se]+1,te=w.to[Se]===-1&&fe[O][1]<fe[O][0]||w.to[Se]===1&&fe[O][1]>fe[O][0],he=L[O][B][0],se=L[O][B][1],ne=R[O][B][$];if(w.segment===ne[3]||w.segment===ne[2]&&te)return k[O];if(w.segment===ne[2]&&se<he)return N[O];if(w.segment===ne[2]&&se>=he||w.segment===ne[1]&&!te)return oe[O];if(w.segment===ne[0]||w.segment===ne[1]&&te)return H[O]},orthogonal:function(O,P,D,I,G){var w=e,R={x:w.so[0]===-1?Math.min(P,I):Math.max(P,I),y:w.so[1]===-1?Math.min(P,I):Math.max(P,I)}[O];return{x:[[R,D],[R,G],[I,G]],y:[[D,R],[G,R],[G,I]]}[O]},opposite:function(O,P,D,I,G){var w=e,R={x:"y",y:"x"}[O],L={x:"h",y:"w"}[O],k=w["is"+O.toUpperCase()+"GreaterThanStubTimes2"];if(t.sourceEndpoint.elementId===t.targetEndpoint.elementId){var N=D+(1-t.sourceEndpoint._anchor.computedPosition[R])*t.sourceInfo[L]+r.maxStub;return{x:[[P,N],[I,N]],y:[[N,P],[N,I]]}[O]}else{if(!k||w.so[c]===1&&P>I||w.so[c]===-1&&P<I)return{x:[[P,E],[I,E]],y:[[g,P],[g,I]]}[O];if(w.so[c]===1&&P<I||w.so[c]===-1&&P>I)return{x:[[g,w.sy],[g,w.ty]],y:[[w.sx,E],[w.tx,E]]}[O]}}},S=x[e.anchorOrientation](e.sourceAxis,h,v,p,y);if(S)for(var C=0;C<S.length;C++)this.addASegment(S[C][0],S[C][1],e);this.addASegment(u[2],u[3],e),this.addASegment(e.tx,e.ty,e),this.writeSegments(e)}},{key:"transformGeometry",value:function(e,t,r){return e}}]),n}(oo);d(Qo,"type","Flowchart");Qr.register(Qo.type,Qo);nn.registerHandler(ev);nn.registerHandler(bv);nn.registerHandler(Cv);Qr.register(Zi.type,Zi);function Wv(){var a=Math.floor(Math.random()*2e3),o=Math.floor(Math.random()*2e3);return{clientX:a,clientY:o,screenX:a,screenY:o,pageX:a,pageY:o}}var Vn={clientX:5e4,clientY:5e4,screenX:5e4,screenY:5e4,pageX:5e4,pageY:5e4};for(var mi=0;mi<256;mi++)(mi<16?"0":"")+mi.toString(16);var Kv=1e-11;(function(){function a(o,n,i){X(this,a),this._jsPlumb=o,this.ok=n,this.equal=i,d(this,"_divs",[]),d(this,"mottle",void 0),this.mottle=new xa}return J(a,[{key:"_t",value:function(n,i,e,t){this.mottle.trigger(n,i,{pageX:e,pageY:t,screenX:e,screenY:t,clientX:e,clientY:t})}},{key:"addDiv",value:function(n,i,e,t,r,s,l){var u=document.createElement("div");return u.style.position="absolute",u.innerHTML=n,i?i.appendChild(u):this._jsPlumb.getContainer().appendChild(u),u.setAttribute("id",n),u.style.left=(t??Math.floor(Math.random()*1e3))+"px",u.style.top=(r??Math.floor(Math.random()*1e3))+"px",e&&(u.className=e),s&&(u.style.width=s+"px"),l&&(u.style.height=l+"px"),this._divs.push(n),u}},{key:"addDivs",value:function(n,i){for(var e=0;e<n.length;e++)this.addDiv(n[e],i)}},{key:"assertEndpointCount",value:function(n,i){var e=this._jsPlumb.getEndpoints(n),t=e?e.length:0;this.equal(t,i,n.getAttribute("data-jtk-managed")+" has "+i+(i>1||i==0?" endpoints":" endpoint"))}},{key:"_assertManagedEndpointCount",value:function(n,i){var e=this._jsPlumb.getId(n),t=this._jsPlumb._managedElements[e];this.equal(t.endpoints.length,i,e+" has "+i+" endpoints in managed record")}},{key:"_assertManagedConnectionCount",value:function(n,i){var e=this._jsPlumb.getId(n),t=this._jsPlumb._managedElements[e];this.equal(t.connections.length,i,e+" has "+i+" connections in managed record")}},{key:"_registerDiv",value:function(n){this._divs.push(n)}},{key:"makeDragStartEvt",value:function(n){var i=this.makeEvent(n),e=this._jsPlumb.getContainer();return i.clientX+=e.offsetLeft,i.screenX+=e.offsetLeft,i.pageX+=e.offsetLeft,i.clientY+=e.offsetTop,i.screenY+=e.offsetTop,i.pageY+=e.offsetTop,i}},{key:"getAttribute",value:function(n,i){return n.getAttribute(i)}},{key:"dragNodeBy",value:function(n,i,e,t){t=t||{},t.before&&t.before();var r=this.makeEvent(n);this._jsPlumb.trigger(n,ue,r),t.beforeMouseMove&&t.beforeMouseMove(),this._t(document,Ve,r.pageX+i,r.pageY+e),t.beforeMouseUp&&t.beforeMouseUp(),this.mottle.trigger(document,ce,null),t.after&&t.after()}},{key:"dragNodeTo",value:function(n,i,e,t){t=t||{};var r=this._jsPlumb.viewport.getPosition(this._jsPlumb.getId(n));t.before&&t.before();var s=this.makeEvent(n);this._jsPlumb.trigger(n,ue,s);var l=this._jsPlumb.getContainer().getBoundingClientRect();t.beforeMouseMove&&t.beforeMouseMove(),this._t(document,Ve,l.x+i+r.w/2,l.y+e+r.h/2),t.beforeMouseUp&&t.beforeMouseUp(),this.mottle.trigger(document,ce,null),t.after&&t.after()}},{key:"dragToGroup",value:function(n,i,e){var t=this._jsPlumb.getGroup(i),r=this._jsPlumb.viewport.getPosition(t.elId),s=r.x+r.w/2,l=r.y+r.h/2;this.dragNodeTo(n,s,l,e)}},{key:"aSyncDragNodeBy",value:function(n,i,e,t){var r=this;t=t||{},t.before&&t.before();var s=this.makeEvent(n);this._jsPlumb.trigger(n,ue,s),t.beforeMouseMove&&t.beforeMouseMove(),setTimeout(function(){r._t(document,Ve,s.pageX+i,s.pageY+e),t.beforeMouseUp&&t.beforeMouseUp(),setTimeout(function(){r.mottle.trigger(document,ce,null),t.after&&t.after()},45)},45)}},{key:"dragANodeAround",value:function(n,i,e){this._jsPlumb.trigger(n,ue,this.makeEvent(n));for(var t=Math.random()*50,r=0;r<t;r++){var s=Wv();n.style.left=s.screenX+"px",n.style.top=s.screenY+"px",this._jsPlumb.trigger(document,Ve,s)}i&&this.ok(i(),e||"while dragging assert"),this._jsPlumb.trigger(document,ce,Vn)}},{key:"dragConnection",value:function(n,i,e,t){var r=this.getCanvas(n),s=this.getCanvas(i),l=this.makeEvent(r),u=this.makeEvent(s);t=t||{};var c=this._jsPlumb.select().length;return this._jsPlumb.trigger(r,ue,l),t.beforeMouseMove&&t.beforeMouseMove(),this._jsPlumb.trigger(e?s:document,Ve,u),t.beforeMouseUp&&t.beforeMouseUp(),this._jsPlumb.trigger(e?s:document,ce,u),this._jsPlumb.select().get(c)}},{key:"aSyncDragConnection",value:function(n,i,e){var t=this;e=e||{};var r=this.getCanvas(n),s=this.getCanvas(i),l=this.makeEvent(r),u=this.makeEvent(s),c=this._jsPlumb.select().length;this._jsPlumb.trigger(r,ue,l),setTimeout(function(){e.beforeMouseMove&&e.beforeMouseMove(),t._jsPlumb.trigger(document,Ve,u),setTimeout(function(){e.beforeMouseUp&&e.beforeMouseUp(),t._jsPlumb.trigger(s,ce,u),e.after&&e.after(t._jsPlumb.select().get(c))},5)},5)}},{key:"dragAndAbortConnection",value:function(n){var i=this.getCanvas(n),e=this.makeEvent(i);this._jsPlumb.trigger(i,ue,e),this._jsPlumb.trigger(document,Ve,Vn),this._jsPlumb.trigger(document,ce,Vn)}},{key:"detachConnection",value:function(n,i){i=i||{};var e=this.getEndpointCanvas(n),t=this.makeEvent(e);i.before&&i.before(),this._jsPlumb.trigger(e,ue,t),i.beforeMouseMove&&i.beforeMouseMove(),this._jsPlumb.trigger(document,Ve,Vn),i.beforeMouseUp&&i.beforeMouseUp(),this._jsPlumb.trigger(document,ce,Vn),i.after&&i.after()}},{key:"detachAndReattachConnection",value:function(n,i){i=i||{};var e=this.getEndpointCanvas(n),t=this.makeEvent(e);i.before&&i.before(),this._jsPlumb.trigger(e,ue,t),i.beforeMouseMove&&i.beforeMouseMove(),this._jsPlumb.trigger(document,Ve,Vn),this._jsPlumb.trigger(document,Ve,t),i.beforeMouseUp&&i.beforeMouseUp(),this._jsPlumb.trigger(document,ce,t),i.after&&i.after()}},{key:"detachConnectionByTarget",value:function(n,i){this.detachConnection(n.endpoints[1],i)}},{key:"relocateTarget",value:function(n,i,e){this.relocate(n,1,i,e)}},{key:"relocate",value:function(n,i,e,t){t=t||{},e=this.getCanvas(e);var r=this.getEndpointCanvas(n.endpoints[i]),s=this.makeEvent(r),l=this.makeEvent(e);t.before&&t.before(),this._jsPlumb.trigger(r,ue,s),t.beforeMouseMove&&t.beforeMouseMove(),this._jsPlumb.trigger(document,Ve,l),t.beforeMouseUp&&t.beforeMouseUp(),this._jsPlumb.trigger(e,ce,l),t.after&&t.after()}},{key:"relocateSource",value:function(n,i,e){this.relocate(n,0,i,e)}},{key:"makeEvent",value:function(n){var i=n.getBoundingClientRect(),e=i.x+i.width/2,t=i.y+i.height/2;return{clientX:e,clientY:t,screenX:e,screenY:t,pageX:e,pageY:t}}},{key:"getCanvas",value:function(n){return n.endpoint?this.getEndpointCanvas(n):n}},{key:"getEndpointCanvas",value:function(n){return n.endpoint.canvas}},{key:"getConnectionCanvas",value:function(n){return n.connector.canvas}},{key:"getEndpointCanvasPosition",value:function(n){var i=this.getEndpointCanvas(n);return{x:parseInt(i.style.left,10),y:parseInt(i.style.top,10),w:i.getAttribute("width"),h:i.getAttribute("height")}}},{key:"within",value:function(n,i,e){this.ok(Math.abs(n-i)<Kv,e+"[expected: "+i+" got "+n+"] [diff:"+Math.abs(n-i)+"]")}},{key:"assertManagedEndpointCount",value:function(n,i){var e=this._jsPlumb.getId(n),t=this._jsPlumb._managedElements[e];this.equal(t.endpoints.length,i,e+" has "+i+" endpoints in managed record")}},{key:"assertManagedConnectionCount",value:function(n,i){var e=this._jsPlumb.getId(n),t=this._jsPlumb._managedElements[e];this.equal(t.connections.length,i,e+" has "+i+" connections in managed record")}},{key:"fireEventOnEndpoint",value:function(n){for(var i=this.getEndpointCanvas(n),e=0;e<(arguments.length<=1?0:arguments.length-1);e++)this._jsPlumb.trigger(i,e+1<1||arguments.length<=e+1?void 0:arguments[e+1])}},{key:"fireEventOnElement",value:function(n){for(var i=0;i<(arguments.length<=1?0:arguments.length-1);i++)this._jsPlumb.trigger(n,i+1<1||arguments.length<=i+1?void 0:arguments[i+1])}},{key:"fireEventOnConnection",value:function(n){for(var i=this.getConnectionCanvas(n),e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];this.fireEventOnElement.apply(this,[i].concat(t))}},{key:"clickOnConnection",value:function(n){this.fireEventOnConnection(n,et)}},{key:"dblClickOnConnection",value:function(n){this.fireEventOnConnection(n,lt)}},{key:"tapOnConnection",value:function(n){this.fireEventOnConnection(n,ue),this.fireEventOnConnection(n,ce)}},{key:"dblTapOnConnection",value:function(n){this.fireEventOnConnection(n,ue),this.fireEventOnConnection(n,ce),this.fireEventOnConnection(n,ue),this.fireEventOnConnection(n,ce)}},{key:"clickOnElement",value:function(n,i){this._jsPlumb.trigger(n,et,null,null,i??1)}},{key:"dblClickOnElement",value:function(n){this._jsPlumb.trigger(n,lt)}},{key:"tapOnElement",value:function(n){this._jsPlumb.trigger(n,ue),this._jsPlumb.trigger(n,ce)}},{key:"dblTapOnElement",value:function(n){this._jsPlumb.trigger(n,ue),this._jsPlumb.trigger(n,ce),this._jsPlumb.trigger(n,ue),this._jsPlumb.trigger(n,ce)}},{key:"getOverlayCanvas",value:function(n){return n.canvas||n.path}},{key:"fireEventOnOverlay",value:function(n,i,e){var t=n.getOverlay(i),r=this.getOverlayCanvas(t);this._jsPlumb.trigger(r,e)}},{key:"clickOnOverlay",value:function(n,i){this.fireEventOnOverlay(n,i,et)}},{key:"dblClickOnOverlay",value:function(n,i){this.fireEventOnOverlay(n,i,lt)}},{key:"tapOnOverlay",value:function(n,i){this.fireEventOnOverlay(n,i,ue),this.fireEventOnOverlay(n,i,ce)}},{key:"dblTapOnOverlay",value:function(n,i){this.fireEventOnOverlay(n,i,ue),this.fireEventOnOverlay(n,i,ce),this.fireEventOnOverlay(n,i,ue),this.fireEventOnOverlay(n,i,ce)}},{key:"cleanup",value:function(){var n=this._jsPlumb.getContainer();this._jsPlumb.destroy();for(var i in this._divs){var e=document.getElementById(this._divs[i]);e&&e.parentNode.removeChild(e)}this._divs.length=0;var t=this._jsPlumb.select().length,r=this._jsPlumb.selectEndpoints().length,s=n.querySelectorAll(".jtk-endpoint").length,l=n.querySelectorAll(".jtk-connector").length;for(var u in n.__ta)for(var c in n.__ta[u])throw"Container event bindings not empty for key "+u;if(t>0)throw"there are connections in the data model!";if(r>0)throw"there are endpoints in the data model!";if(s>0)throw"there are "+s+" endpoints left in the dom!";if(l>0)throw"there are "+l+" connections left in the dom!"}},{key:"makeContent",value:function(n){var i=document.createElement("div");return i.innerHTML=n,i.firstChild}},{key:"length",value:function(n){var i=0;for(var e in n)n.hasOwnProperty(e)&&i++;return i}},{key:"head",value:function(n){for(var i in n)return n[i]}},{key:"uuid",value:function(){return He()}}]),a})();var Qs=0;function zv(){var a=Qs+1;return Qs++,a}function Zv(a){return new yv(zv(),a)}const Jv={key:1,class:"flex flex-col h-full w-full relative"},Qv={class:"flex-grow px-4 py-2"},qv={class:"text-md"},ep={class:"text-sm text-gray-500"},tp={class:"absolute top-1 right-2 text-sm text-gray-500"},np={class:"flex justify-end absolute bottom-0 right-0"},rp=qi({__name:"LessonCard",props:{lesson:{},loading:{type:Boolean}},emits:["edit","delete"],setup(a,{emit:o}){const n=a,i=o,e=el();return(t,r)=>{const s=tl,l=eo;return ut(),Ct("div",{class:"cursor-pointer w-40 h-24 bg-gray-50 rounded-lg border border-gray-200",onClick:r[2]||(r[2]=u=>ye(e).push({name:"lesson-edit",params:{id:t.lesson.id}}))},[n.loading?(ut(),qs(s,{key:0,class:"flex justify-center items-center w-10 h-full"})):(ut(),Ct("div",Jv,[Fe("div",Qv,[Fe("div",qv,En(n.lesson.name),1),Fe("div",ep,En(`${n.lesson.stage}`),1)]),Fe("div",tp,En(n.lesson.id),1),Fe("div",np,[ve(l,{icon:"pi pi-pencil",size:"small",severity:"info",variant:"text",onClick:r[0]||(r[0]=Ra(u=>i("edit",n.lesson),["stop"]))}),ve(l,{icon:"pi pi-trash",size:"small",severity:"danger",variant:"text",onClick:r[1]||(r[1]=Ra(u=>i("delete",n.lesson),["stop"]))})])]))])}}}),ip=["id"],op={class:"flex justify-end gap-2"},ap=qi({__name:"LessonsView",props:{level:{},dependenciesMode:{type:Boolean}},setup(a){const o=a,n=ea(),i=qo(),e=ia(),{isLessonCreating:t,isLessonUpdating:r,isLessonDeleting:s,isOrderUpdating:l,groupedLessons:u,groupedDependencies:c}=Br(e),{createLesson:f,updateLessonById:h,deleteLessonById:v,loadRouteById:p,updateRouteLessonsOrderById:y,createLessonDependency:g,deleteLessonDependency:E,deleteAllLessonDependencies:b}=e,x=Ee(!1),S=Ee(!1),C=Ee(null),T=Ee(""),O=Ee(""),P=Ee("freemium"),D=Ee("learn");let I;const G=Ee();nl(async()=>{await Pu(),I=Zv({container:G.value,paintStyle:{strokeWidth:1.5,stroke:"#456"},maxConnections:-1,connector:"Bezier",connectionOverlays:[{type:"Arrow",options:{location:1}}]}),o.dependenciesMode?(w(),L()):R(),I.bind(pa,async B=>{if(B.originalSourceID.includes("jsplumb"))return;const $=B.originalSourceId.split("-")[1],te=B.originalTargetId.split("-")[1];await E({depend_on_id:Number($),lesson_id:Number(te),route_id:Number(n.params.id)})}),I.bind(va,async B=>{if(B.sourceId.includes("jsplumb"))return;const $=B.sourceId.split("-")[1],te=B.targetId.split("-")[1];await g({depend_on_id:Number($),lesson_id:Number(te),route_id:Number(n.params.id)})}),I.bind(kl,async B=>{if(B.sourceId.includes("jsplumb"))return;const $=B.sourceId.split("-")[1],te=B.targetId.split("-")[1];await E({depend_on_id:Number($),lesson_id:Number(te),route_id:Number(n.params.id)})})});async function w(){for(const B of Object.values(u.value[o.level.id]))for(const $ of B){const te=document.getElementById(`lesson-${$.id}`);I.addEndpoint(te,{source:!0,anchor:"Top",endpoint:{type:Dn.type}}),I.addEndpoint(te,{target:!0,anchor:"Left",endpoint:{type:Wr.type}})}}async function R(){for(const B of Object.values(u.value[o.level.id]))for(const $ of B){const te=I.getEndpoints(document.getElementById(`lesson-${$.id}`));for(const he of te)I.deleteEndpoint(he)}}function L(){const B=c.value[o.level.id];for(const $ of B)I.connect({source:document.getElementById(`lesson-${$.depend_on_id}`),target:document.getElementById(`lesson-${$.lesson_id}`),anchors:["Top","Left"]})}function k(B){T.value="",O.value="",P.value="freemium",S.value=!0,x.value=!0,D.value=B}function N(B){C.value=B,T.value=B.name,O.value=B.description,P.value=B.accessType,S.value=!1,x.value=!0}async function H(){S.value?await f({name:T.value,description:O.value,access_type:P.value,lesson_type:D.value,level_id:o.level.id,route_id:Number(n.params.id)}):C.value&&await h(C.value.id,{name:T.value,description:O.value,access_type:P.value}),await p(Number(n.params.id)),x.value=!1}function oe(B){C.value=B,i.require({...ra,message:"Are you sure you want to delete this lesson?",accept:async()=>{await v(B.id),await p(Number(n.params.id))}})}async function fe(B){if(!l.value){if(B.added){const $=B.added.element.id,te=Re($);if(te){const{levelId:se,lessonType:ne}=te;if(se!=B.added.element.levelId&&await b({lesson_id:Number($),route_id:Number(n.params.id)}),ne!=B.added.element.lessonType){await h($,{lesson_type:ne});const pe=u.value[o.level.id][ne].find(Ce=>Ce.id===$);pe&&(pe.lessonType=ne)}}const he=Se();await y(Number(n.params.id),he)}else if(B.moved){const $=Se();await y(Number(n.params.id),$)}}}function Re(B){var $;for(const[te,he]of Object.entries(u.value))for(const se of Ga)if(($=he[se])!=null&&$.some(ne=>ne.id===B))return{levelId:Number(te),lessonType:se};return null}function Se(){const B=[];for(const $ in u.value){const te=Number($),he=u.value[te],se=Object.values(he).flat();B.push({level_id:te,lesson_ids:se.map(ne=>ne.id)})}return{orders:B}}return(B,$)=>{const te=Ou,he=eo,se=ta,ne=na;return ut(),Ct(Ei,null,[Fe("div",{ref_key:"lessonsWrapperRef",ref:G,class:"relative flex flex-col gap-4"},[(ut(!0),Ct(Ei,null,rl(ye(Ga),pe=>(ut(),Ct(Ei,{key:pe},[ve(te,{severity:pe==="learn"?"success":pe==="practice"?"info":"warn",class:"min-w-fit pr-4",size:"small"},{default:Qt(()=>[Tu(En(pe.charAt(0).toUpperCase()+pe.slice(1)),1)]),_:2},1032,["severity"]),ve(ye(Tc),{modelValue:ye(u)[B.level.id][pe],"onUpdate:modelValue":Ce=>ye(u)[B.level.id][pe]=Ce,group:"lessons","item-key":"id","data-key":`${o.level.id}-${pe}`,class:"flex flex-wrap gap-4 min-h-[5rem]",onChange:fe,disabled:ye(l)||B.dependenciesMode},{item:Qt(({element:Ce})=>{var vt;return[Fe("div",{id:`lesson-${Ce.id}`},[ve(rp,{lesson:Ce,loading:((vt=C.value)==null?void 0:vt.id)===Ce.id&&(ye(r)||ye(s)),onEdit:Lt=>N(Ce),onDelete:Lt=>oe(Ce)},null,8,["lesson","loading","onEdit","onDelete"])],8,ip)]}),footer:Qt(()=>[ve(he,{icon:"pi pi-plus",label:"Add",variant:"outlined",class:"w-40 h-24",onClick:Ce=>k(pe)},null,8,["onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","data-key","disabled"])],64))),128))],512),ve(ne,{visible:x.value,"onUpdate:visible":$[3]||($[3]=pe=>x.value=pe),modal:"",header:S.value?"Create Lesson":"Update Lesson",style:{width:"25rem"}},{default:Qt(()=>[ve(se,{modelValue:T.value,"onUpdate:modelValue":$[0]||($[0]=pe=>T.value=pe),class:"w-full mb-4",placeholder:"Name"},null,8,["modelValue"]),ve(se,{modelValue:O.value,"onUpdate:modelValue":$[1]||($[1]=pe=>O.value=pe),class:"w-full mb-4",placeholder:"Description"},null,8,["modelValue"]),Fe("div",op,[ve(he,{label:"Cancel",severity:"secondary",onClick:$[2]||($[2]=pe=>x.value=!1)}),ve(he,{label:S.value?"Create":"Update",loading:ye(t)||ye(r),disabled:ye(t)||ye(r),onClick:H},null,8,["label","loading","disabled"])])]),_:1},8,["visible","header"])],64)}}}),sp=Au(ap,[["__scopeId","data-v-e357f08b"]]),lp={class:"flex flex-col gap-4"},up={class:"flex items-center gap-2"},cp={class:"flex items-center gap-2"},fp={class:"text-xl"},hp={class:"flex gap-2 mb-4"},dp={class:"flex justify-end gap-2"},vp=qi({__name:"LevelsView",props:{levels:{}},setup(a){const o=a,n=ea(),i=qo(),e=ia(),{isLevelCreating:t,isLevelUpdating:r,mode:s}=Br(e),{loadRouteById:l,createLevel:u,updateLevelById:c,deleteLevelById:f}=e,h=Ee(["Order mode","Dependency mode"]),v=Ee(!1),p=Ee(!1),y=Ee(null),g=Ee(""),E=Ee(0),b=Ee(0);function x(){g.value="",p.value=!0,v.value=!0}function S(O){y.value=O,g.value=O.name,E.value=O.learnCount,b.value=O.practiceCount,p.value=!1,v.value=!0}async function C(){p.value?await u({name:g.value}):y.value&&await c(y.value.id,{name:g.value,learn_count:E.value,practice_count:b.value}),await l(Number(n.params.id)),v.value=!1}function T(O){i.require({...ra,message:"Are you sure you want delete?",accept:async()=>{await f(O),await l(Number(n.params.id))}})}return il(s,()=>l(Number(n.params.id))),(O,P)=>{const D=_u,I=eo,G=Iu,w=ta,R=Mu,L=na;return ut(),Ct("div",lp,[ve(D,{modelValue:ye(s),"onUpdate:modelValue":P[0]||(P[0]=k=>Du(s)?s.value=k:null),options:h.value,size:"small",class:"self-end",allowEmpty:!1},null,8,["modelValue","options"]),(ut(!0),Ct(Ei,null,rl(o.levels,k=>(ut(),Ct("div",{key:k.id,class:"flex flex-col gap-4"},[Fe("div",up,[ve(G,{align:"center",type:"dotted",class:"m-0"},{default:Qt(()=>[Fe("div",cp,[ve(I,{icon:"pi pi-pencil",size:"small",severity:"info",variant:"outlined",onClick:N=>S(k)},null,8,["onClick"]),Fe("div",fp,En(k.name),1)])]),_:2},1024),ve(I,{icon:"pi pi-trash",size:"small",severity:"danger",variant:"outlined",onClick:N=>T(k.id)},null,8,["onClick"])]),ve(sp,{level:k,dependenciesMode:ye(s)=="Dependency mode"},null,8,["level","dependenciesMode"])]))),128)),ve(G,{align:"center",type:"dotted"},{default:Qt(()=>[ve(I,{icon:"pi pi-plus",label:"Add level",variant:"outlined",onClick:x})]),_:1}),ve(L,{visible:v.value,"onUpdate:visible":P[5]||(P[5]=k=>v.value=k),modal:"",header:p.value?"Create new level":"Update level",style:{width:"25rem"}},{default:Qt(()=>[ve(w,{modelValue:g.value,"onUpdate:modelValue":P[1]||(P[1]=k=>g.value=k),id:"name",class:"w-full mb-4",autocomplete:"off",placeholder:"Name"},null,8,["modelValue"]),Fe("div",hp,[ve(R,{modelValue:E.value,"onUpdate:modelValue":P[2]||(P[2]=k=>E.value=k),placeholder:"Min Learn lessons",inputId:"minmax",min:0,max:100,fluid:""},null,8,["modelValue"]),ve(R,{modelValue:b.value,"onUpdate:modelValue":P[3]||(P[3]=k=>b.value=k),placeholder:"Min Practice lessons",inputId:"minmax",min:0,max:100,fluid:""},null,8,["modelValue"])]),Fe("div",dp,[ve(I,{type:"button",label:"Cancel",severity:"secondary",onClick:P[4]||(P[4]=k=>v.value=!1)}),ve(I,{type:"button",label:p.value?"Create":"Update",loading:ye(t)||ye(r),disabled:ye(t)||ye(r),onClick:C},null,8,["label","loading","disabled"])])]),_:1},8,["visible","header"])])}}}),pp={class:"flex flex-col items-center h-screen relative"},gp={class:"w-full h-full max-w-screen-xl px-4 md:px-28 py-8"},yp={key:1,class:"flex justify-center"},mp={key:2},Ep={class:"flex items-center justify-between mb-2"},bp={class:"flex flex-col"},xp={class:"text-2xl"},Sp={class:"text-lg text-gray-500"},Cp={class:"flex gap-2"},Pp={class:"flex justify-end gap-2"},Tp={class:"fixed top-32 right-0 pl-2 pr-4 py-2 bg-white rounded-tl-lg rounded-bl-lg shadow-md z-50 border border-gray-200 flex flex-col items-center gap-4"},kp=qi({__name:"RouteEditPage",setup(a){const o=ea(),n=el(),i=qo(),e=ol(),{lang:t}=Br(e),r=ia(),{isRouteLoading:s,isRouteUpdating:l,isRouteDeleting:u,selectedRoute:c}=Br(r),{loadRouteById:f,updateRouteById:h,deleteRouteById:v}=r;function p(){i.require({...ra,message:"Are you sure you want delete?",accept:async()=>{await v(Number(o.params.id)),n.go(-1)}})}const y=Ee(!1);async function g(){var E,b;await h(Number(o.params.id),{name:(E=c.value)==null?void 0:E.name,description:(b=c.value)==null?void 0:b.description}),y.value=!1}return nl(()=>f(Number(o.params.id))),il(t,async(E,b)=>{E!==b&&c.value&&await f(c.value.id)}),(E,b)=>{const x=tl,S=eo,C=ta,T=na;return ut(),Ct("div",pp,[ve(ye(wu)),Fe("div",gp,[ye(s)?(ut(),qs(x,{key:0,class:"flex justify-center"})):ye(c)?(ut(),Ct("div",mp,[Fe("div",Ep,[Fe("div",bp,[Fe("div",xp,En(ye(c).name),1),Fe("div",Sp,En(ye(c).description),1)]),Fe("div",Cp,[ve(S,{label:"Edit",severity:"info",variant:"outlined",class:"w-fit",onClick:b[0]||(b[0]=O=>y.value=!0)}),ve(S,{label:"Delete",severity:"danger",variant:"outlined",class:"w-fit",loading:ye(u),disabled:ye(u),onClick:p},null,8,["loading","disabled"]),ve(T,{visible:y.value,"onUpdate:visible":b[4]||(b[4]=O=>y.value=O),modal:"",header:"Update route",style:{width:"25rem"}},{default:Qt(()=>[ve(C,{modelValue:ye(c).name,"onUpdate:modelValue":b[1]||(b[1]=O=>ye(c).name=O),id:"name",class:"w-full mb-4",autocomplete:"off",placeholder:"Name"},null,8,["modelValue"]),ve(C,{modelValue:ye(c).description,"onUpdate:modelValue":b[2]||(b[2]=O=>ye(c).description=O),id:"description",class:"w-full mb-4",autocomplete:"off",placeholder:"Description"},null,8,["modelValue"]),Fe("div",Pp,[ve(S,{type:"button",label:"Cancel",severity:"secondary",onClick:b[3]||(b[3]=O=>y.value=!1)}),ve(S,{type:"button",label:"Update",loading:ye(l),disabled:ye(l),onClick:g},null,8,["loading","disabled"])])]),_:1},8,["visible"])])]),ve(vp,{levels:ye(c).levels},null,8,["levels"])])):(ut(),Ct("div",yp,"No route found"))]),Fe("div",Tp,[ve(ye(ku))])])}}});export{kp as default};
