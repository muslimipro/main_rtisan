import{d as U,_ as j,a as q,b as F,c as W,s as O}from"./VideoViewer.vue_vue_type_script_setup_true_lang-BXGlEfD8.js";import{s as R}from"./index-BWs-M9Gu.js";import{s as K}from"./index-BzdoYQjx.js";import{e as k,o as t,c as a,j as o,h as p,b as T,F as V,l as P,p as i,w as $,k as M,t as I,d as Y,u as G,r as f,i as r,q as L,f as H,g as J,D as Q,E as X,G as Z,K as ee,A as te,v as se,x as oe}from"./index-BYxlyoh-.js";import{u as ne,a as le}from"./CodeEditorView.vue_vue_type_script_setup_true_lang-C_HPaqu4.js";import{S as re}from"./SimulationView-Ba_UIdiX.js";import{_ as ie}from"./CodeViewer.vue_vue_type_script_setup_true_lang-weLAncPl.js";import{L as ae}from"./lessonApi-DAcD5V07.js";import{m as ue}from"./mapLessonFromDto-DxMZVnwf.js";import{m as de}from"./mapUnitFromDto-BRBO9875.js";import{U as ce}from"./unitApi-CQ_H-QR8.js";import{s as pe}from"./index-VM38Z9SM.js";import"./index-a94r-NqF.js";import"./index-BCHC1xLR.js";import"./index-Zas_bQ1O.js";import"./index-DMeE97oj.js";import"./index-DfGsetke.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-0upRcmMT.js";import"./index-rJ23prLF.js";import"./transformUnitDtosToPages-CGD_PO48.js";const fe={class:"rounded-2xl p-6 max-w-2xl mx-auto border border-slate-100 gap-2 flex flex-col"},me={class:"rounded-xl overflow-clip"},ve=k({__name:"CodeReviseViewer",props:{state:{}},setup(m){const e=m;return(u,n)=>(t(),a("div",fe,[n[0]||(n[0]=o("div",{class:"text-overline-small text-neutral600"},"Your answer",-1)),o("div",me,[p(U,{text:` \`\`\`python
${e.state.answer.code}
\`\`\` `},null,8,["text"])])]))}}),_e={class:"rounded-2xl p-6 max-w-2xl mx-auto border border-slate-100 gap-2 flex flex-col"},ye={class:"space-y-1"},xe={class:"flex flex-wrap items-center gap-2 text-slate-800 bg-slate-50 rounded-xl px-3 py-2"},we={class:"text-slate-800"},he={class:"rounded-xl overflow-clip"},ge=k({__name:"PibodyReviseViewer",props:{state:{}},setup(m){const e=m,u=["A","B","C","D","E","F","8","9"],n=T(()=>e.state.answer.slots.map((d,v)=>({slot:d,index:v})).filter(d=>d.slot!==""));return(d,v)=>{const w=pe;return t(),a("div",_e,[v[0]||(v[0]=o("div",{class:"text-overline-small text-neutral600"},"Your answer",-1)),o("div",ye,[o("div",xe,[(t(!0),a(V,null,P(n.value,c=>(t(),i(w,{key:c.index,class:"font-medium text-slate-500"},{default:$(()=>[M(" Slot "+I(u[c.index])+": ",1),o("span",we,I(c.slot),1)]),_:2},1024))),128))])]),o("div",he,[p(U,{text:` \`\`\`python
${e.state.answer.code}
\`\`\` `},null,8,["text"])])])}}}),be=Y("lesson-revise-store",()=>{const m=G(),e=f(null),u=f(!1),n=f([]),d=f(null),v=f(null),w=f(!1),c=f(!1);async function S(y,x){try{u.value=!0;const{data:l}=await ae.getLessonById(y,x);e.value=ue(l),await C()}catch(l){m.add({severity:"error",summary:l.response.data.error,life:2e3})}finally{u.value=!1}}async function C(){if(e.value)try{n.value=[];const y=[];e.value.pages.forEach(l=>{l.groups.forEach(h=>{h.units.forEach(g=>{y.push(g.id)})})});const{data:x}=await ce.getUnitsByIdsandLessonId(y,e.value.id);for(const l of x)n.value.push(de(l)),(l.unit_type=="code"||l.unit_type=="pibody")&&(w.value=!0,v.value=ne("emulatorID"),v.value.setCode("")),l.unit_type=="pibody"&&(c.value=!0,d.value=le("emulatorID"),d.value.addNeededModules([]))}catch(y){console.error("Error loading units:",y)}finally{}}return{selectedLesson:e,isLessonLoading:u,units:n,showPibody:c,showCode:w,loadLessonById:S}}),$e={key:1,class:"flex-grow px-4 py-2"},ke=k({__name:"UnitCard",props:{unit:{},loading:{type:Boolean}},setup(m){const e=m;return(u,n)=>{const d=R;return t(),a("div",null,[u.loading?(t(),i(d,{key:0,class:"flex justify-center items-center w-10 h-full"})):(t(),a("div",$e,[e.unit.unitType=="article"?(t(),i(r(j),{key:0,article:e.unit.content},null,8,["article"])):e.unit.unitType=="options"?(t(),i(r(q),{key:1,"options-data":e.unit.content,state:e.unit.studentState},null,8,["options-data","state"])):e.unit.unitType=="open"?(t(),i(r(F),{key:2,state:e.unit.studentState},null,8,["state"])):e.unit.unitType=="video"?(t(),i(r(W),{key:3,video:e.unit.content},null,8,["video"])):e.unit.unitType=="code"?(t(),i(r(ve),{key:4,state:e.unit.studentState},null,8,["state"])):e.unit.unitType=="pibody"?(t(),i(r(ge),{key:5,state:e.unit.studentState},null,8,["state"])):L("",!0)]))])}}}),Le={ref:"rootEl",class:"flex flex-col gap-8"},Se=k({__name:"UnitsView",props:{units:{}},setup(m){return(e,u)=>(t(),a("div",Le,[(t(!0),a(V,null,P(e.units,n=>(t(),i(ke,{key:n.id,unit:n},null,8,["unit"]))),128))],512))}}),Ce={class:"h-screen flex flex-col items-center overflow-hidden relative bg-white"},De={class:"fixed top-0 left-0 right-0 z-50 bg-white border-b border-gray-200 max-w-[1920px] mx-auto"},Ee={class:"flex justify-between items-center w-full min-h-16 px-8 gap-8"},Be={class:"flex items-center gap-4"},Ie={key:0,class:"flex flex-grow max-w-screen-lg items-center gap-4"},Ue={class:"flex-1 overflow-y-auto mt-16 mb-0 w-full"},Re={key:1,class:"flex justify-center"},Te={key:2},Ve={key:0,class:"absolute left-0 top-1/2 -translate-y-1/2"},Pe={class:"relative h-full"},ze={class:"absolute -right-0 top-1/2 -translate-y-1/2 w-5 h-10 z-10"},Ne={key:1,class:"absolute right-0 top-1/2 -translate-y-1/2"},Ae={class:"relative h-full"},je={class:"absolute -left-0 top-1/2 -translate-y-1/2 w-5 h-10 z-10"},at=k({__name:"LessonRevisePage",setup(m){const e=te(),u=se(),n=be(),{units:d,isLessonLoading:v,selectedLesson:w,showPibody:c,showCode:S}=H(n),{loadLessonById:C}=n;function y(){e.query.route_id&&e.query.route_id!=""?u.push("/v2/route/"+e.query.route_id):u.push("/v2/home")}const x=f(window.innerWidth),l=f(16),h=f(!0),g=f(!0);function D(){if(x.value=window.innerWidth,x.value<=1300){l.value=16;return}const s=452-(x.value-1024)/2;l.value=s>16?s:16}J(()=>{D(),C(Number(e.params.id),(e.query.route_id??"").toString()),window.addEventListener("resize",D)}),Q(()=>{window.removeEventListener("resize",D)});const E=T(()=>x.value<=1920?{}:"calc((-100vw + 1920px) / 2)");return(z,s)=>{const b=oe,N=K,A=R,B=O;return t(),a("div",Ce,[o("div",De,[o("div",Ee,[o("div",Be,[p(b,{icon:"pi pi-times",variant:"text",severity:"contrast",onClick:y})]),r(w)?(t(),a("div",Ie,[p(N,{value:100,"show-value":!1,class:"w-full rounded-full h-3"})])):L("",!0),s[7]||(s[7]=o("div",{class:"w-10"},null,-1))])]),o("div",Ue,[o("div",{class:"w-full h-full max-w-screen-lg mx-auto py-8",style:X({paddingLeft:l.value+"px",paddingRight:l.value+"px"})},[r(v)?(t(),i(A,{key:0,class:"flex justify-center"})):r(w)?(t(),a("div",Te,[p(Se,{units:r(d)},null,8,["units"])])):(t(),a("div",Re,"No lesson found"))],4)]),r(c)?(t(),a("div",Ve,[p(b,{icon:"pi pi-microchip",severity:"secondary",onClick:s[0]||(s[0]=_=>h.value=!0),class:"w-8 rounded-tl-none rounded-bl-none rounded-tr-lg rounded-br-lg mt-16"}),p(B,{visible:h.value,"onUpdate:visible":s[2]||(s[2]=_=>h.value=_),modal:!1,dismissable:!1,closeOnEscape:!1,class:"h-[calc(100vh-64px)] w-fit mt-16",pt:{root:{style:`right: ${E.value}`}}},{header:$(()=>s[8]||(s[8]=[o("div",null,null,-1)])),container:$(()=>[o("div",Pe,[o("div",ze,[p(b,{icon:"pi pi-chevron-left",severity:"secondary",onClick:s[1]||(s[1]=_=>h.value=!1),class:"w-5 rounded-tl-lg rounded-bl-lg rounded-tr-none rounded-br-none"})]),(t(),i(r(re),{id:"emulatorID",key:"emulatorID",class:"w-full",horizontal:!1,autoPut:!0}))])]),_:1},8,["visible","pt"])])):L("",!0),r(S)?(t(),a("div",Ne,[p(b,{icon:"pi pi-code",severity:"secondary",onClick:s[3]||(s[3]=_=>g.value=!0),class:"w-8 rounded-tl-lg rounded-bl-lg rounded-tr-none rounded-br-none mt-16"}),p(B,{visible:g.value,"onUpdate:visible":s[6]||(s[6]=_=>g.value=_),header:"Drawer",modal:!1,dismissable:!1,closeOnEscape:!1,position:"right",class:"h-[calc(100vh-64px)] w-[452px] mt-16",pt:{root:{style:`left: ${E.value}`}}},{header:$(()=>s[9]||(s[9]=[o("div",null,null,-1)])),container:$(()=>[o("div",Ae,[o("div",je,[p(b,{icon:"pi pi-chevron-right",severity:"secondary",onClick:s[4]||(s[4]=_=>g.value=!1),class:"w-5 rounded-tl-none rounded-bl-none rounded-tr-lg rounded-br-lg"})]),(t(),i(ee,null,[(t(),i(r(ie),{id:"emulatorID",key:"emulatorID",connectbuttons:r(c),"onUpdate:connectbuttons":s[5]||(s[5]=_=>Z(c)?c.value=_:null)},null,8,["connectbuttons"]))],1024))])]),_:1},8,["visible","pt"])])):L("",!0)])}}});export{at as default};
