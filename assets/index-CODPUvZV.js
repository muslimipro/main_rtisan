import{B as ge,o as d,c as h,Q as ve,m as J,s as xe,j as x,y as N,e as I,a2 as we,a3 as me,r as _,b as le,g as H,C as P,h as u,w as z,t as Q,n as pe,x as A,p as S,l as K,F as O,a4 as he,i as k,A as q,d as Ae,u as Fe,f as M,a5 as Pe,M as Ee,q as T,Y as fe,v as ke,Z as Me,_ as Ne,a0 as ae,k as ie,z as je,H as Ge}from"./index-BYxlyoh-.js";import{d as Oe,_ as He}from"./defaultConfirmDeleteOptions-CvL9Wsl7.js";import{u as $e}from"./useLocaleStore-DBhSjf8Z.js";import{L as ye}from"./lessonApi-DAcD5V07.js";import{m as qe}from"./mapLessonFromDto-DxMZVnwf.js";import{U as oe}from"./unitApi-CQ_H-QR8.js";import{s as Je,a as We,b as Ye,c as Ke}from"./index-CKj-6APB.js";import{s as Qe}from"./index-BWs-M9Gu.js";import{_ as se,d as Se,b as Ze,T as Xe}from"./CodeEditorView.vue_vue_type_script_setup_true_lang-C_HPaqu4.js";import{s as Ce,a as Le}from"./index-DV2mNonz.js";import{s as et}from"./index-4subRcqJ.js";import{s as Ue}from"./index-CVQoD3G2.js";import{s as Be}from"./index-Zas_bQ1O.js";import{C as tt}from"./cloudStorageApi-CzSzKaX0.js";import{_ as nt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{s as ot}from"./index-DfGsetke.js";import{s as st}from"./index-BCHC1xLR.js";import{s as Ie}from"./index-a94r-NqF.js";import{s as lt}from"./index-lxjBgPUf.js";import{s as at}from"./index-CrAn5iaP.js";import{s as it}from"./index-VM38Z9SM.js";import{A as rt}from"./language-DYQF8nnT.js";import"./mapUnitFromDto-BRBO9875.js";import"./transformUnitDtosToPages-CGD_PO48.js";import"./index-DJ7TB_SY.js";import"./index-Dwh0iY3O.js";import"./index-drSrk63I.js";import"./index-0upRcmMT.js";import"./index-DMeE97oj.js";import"./index-DKDYcZwi.js";import"./index-DeaV-vWY.js";var dt=function(s){var e=s.dt;return`
.p-inputgroup,
.p-inputgroup .p-iconfield,
.p-inputgroup .p-floatlabel,
.p-inputgroup .p-iftalabel {
    display: flex;
    align-items: stretch;
    width: 100%;
}

.p-inputgroup .p-inputtext,
.p-inputgroup .p-inputwrapper {
    flex: 1 1 auto;
    width: 1%;
}

.p-inputgroupaddon {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: `.concat(e("inputgroup.addon.padding"),`;
    background: `).concat(e("inputgroup.addon.background"),`;
    color: `).concat(e("inputgroup.addon.color"),`;
    border-block-start: 1px solid `).concat(e("inputgroup.addon.border.color"),`;
    border-block-end: 1px solid `).concat(e("inputgroup.addon.border.color"),`;
    min-width: `).concat(e("inputgroup.addon.min.width"),`;
}

.p-inputgroupaddon:first-child,
.p-inputgroupaddon + .p-inputgroupaddon {
    border-inline-start: 1px solid `).concat(e("inputgroup.addon.border.color"),`;
}

.p-inputgroupaddon:last-child {
    border-inline-end: 1px solid `).concat(e("inputgroup.addon.border.color"),`;
}

.p-inputgroupaddon:has(.p-button) {
    padding: 0;
    overflow: hidden;
}

.p-inputgroupaddon .p-button {
    border-radius: 0;
}

.p-inputgroup > .p-component,
.p-inputgroup > .p-inputwrapper > .p-component,
.p-inputgroup > .p-iconfield > .p-component,
.p-inputgroup > .p-floatlabel > .p-component,
.p-inputgroup > .p-floatlabel > .p-inputwrapper > .p-component,
.p-inputgroup > .p-iftalabel > .p-component,
.p-inputgroup > .p-iftalabel > .p-inputwrapper > .p-component {
    border-radius: 0;
    margin: 0;
}

.p-inputgroupaddon:first-child,
.p-inputgroup > .p-component:first-child,
.p-inputgroup > .p-inputwrapper:first-child > .p-component,
.p-inputgroup > .p-iconfield:first-child > .p-component,
.p-inputgroup > .p-floatlabel:first-child > .p-component,
.p-inputgroup > .p-floatlabel:first-child > .p-inputwrapper > .p-component,
.p-inputgroup > .p-iftalabel:first-child > .p-component,
.p-inputgroup > .p-iftalabel:first-child > .p-inputwrapper > .p-component {
    border-start-start-radius: `).concat(e("inputgroup.addon.border.radius"),`;
    border-end-start-radius: `).concat(e("inputgroup.addon.border.radius"),`;
}

.p-inputgroupaddon:last-child,
.p-inputgroup > .p-component:last-child,
.p-inputgroup > .p-inputwrapper:last-child > .p-component,
.p-inputgroup > .p-iconfield:last-child > .p-component,
.p-inputgroup > .p-floatlabel:last-child > .p-component,
.p-inputgroup > .p-floatlabel:last-child > .p-inputwrapper > .p-component,
.p-inputgroup > .p-iftalabel:last-child > .p-component,
.p-inputgroup > .p-iftalabel:last-child > .p-inputwrapper > .p-component {
    border-start-end-radius: `).concat(e("inputgroup.addon.border.radius"),`;
    border-end-end-radius: `).concat(e("inputgroup.addon.border.radius"),`;
}

.p-inputgroup .p-component:focus,
.p-inputgroup .p-component.p-focus,
.p-inputgroup .p-inputwrapper-focus,
.p-inputgroup .p-component:focus ~ label,
.p-inputgroup .p-component.p-focus ~ label,
.p-inputgroup .p-inputwrapper-focus ~ label {
    z-index: 1;
}

.p-inputgroup > .p-button:not(.p-button-icon-only) {
    width: auto;
}

.p-inputgroup .p-iconfield + .p-iconfield .p-inputtext {
    border-inline-start: 0;
}
`)},ct={root:"p-inputgroup"},ut=ge.extend({name:"inputgroup",theme:dt,classes:ct}),pt={name:"BaseInputGroup",extends:xe,style:ut,provide:function(){return{$pcInputGroup:this,$parentInstance:this}}},Ve={name:"InputGroup",extends:pt,inheritAttrs:!1};function gt(o,s,e,i,a,n){return d(),h("div",J({class:o.cx("root")},o.ptmi("root")),[ve(o.$slots,"default")],16)}Ve.render=gt;var vt={root:"p-inputgroupaddon"},mt=ge.extend({name:"inputgroupaddon",classes:vt}),ht={name:"BaseInputGroupAddon",extends:xe,style:mt,provide:function(){return{$pcInputGroupAddon:this,$parentInstance:this}}},Te={name:"InputGroupAddon",extends:ht,inheritAttrs:!1};function ft(o,s,e,i,a,n){return d(),h("div",J({class:o.cx("root")},o.ptmi("root")),[ve(o.$slots,"default")],16)}Te.render=ft;var bt=function(s){var e=s.dt;return`
.p-toggleswitch {
    display: inline-block;
    width: `.concat(e("toggleswitch.width"),`;
    height: `).concat(e("toggleswitch.height"),`;
}

.p-toggleswitch-input {
    cursor: pointer;
    appearance: none;
    position: absolute;
    top: 0;
    inset-inline-start: 0;
    width: 100%;
    height: 100%;
    padding: 0;
    margin: 0;
    opacity: 0;
    z-index: 1;
    outline: 0 none;
    border-radius: `).concat(e("toggleswitch.border.radius"),`;
}

.p-toggleswitch-slider {
    display: inline-block;
    cursor: pointer;
    width: 100%;
    height: 100%;
    border-width: `).concat(e("toggleswitch.border.width"),`;
    border-style: solid;
    border-color: `).concat(e("toggleswitch.border.color"),`;
    background: `).concat(e("toggleswitch.background"),`;
    transition: background `).concat(e("toggleswitch.transition.duration"),", color ").concat(e("toggleswitch.transition.duration"),", border-color ").concat(e("toggleswitch.transition.duration"),", outline-color ").concat(e("toggleswitch.transition.duration"),", box-shadow ").concat(e("toggleswitch.transition.duration"),`;
    border-radius: `).concat(e("toggleswitch.border.radius"),`;
    outline-color: transparent;
    box-shadow: `).concat(e("toggleswitch.shadow"),`;
}

.p-toggleswitch-handle {
    position: absolute;
    top: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    background: `).concat(e("toggleswitch.handle.background"),`;
    color: `).concat(e("toggleswitch.handle.color"),`;
    width: `).concat(e("toggleswitch.handle.size"),`;
    height: `).concat(e("toggleswitch.handle.size"),`;
    inset-inline-start: `).concat(e("toggleswitch.gap"),`;
    margin-block-start: calc(-1 * calc(`).concat(e("toggleswitch.handle.size"),` / 2));
    border-radius: `).concat(e("toggleswitch.handle.border.radius"),`;
    transition: background `).concat(e("toggleswitch.transition.duration"),", color ").concat(e("toggleswitch.transition.duration"),", inset-inline-start ").concat(e("toggleswitch.slide.duration"),", box-shadow ").concat(e("toggleswitch.slide.duration"),`;
}

.p-toggleswitch.p-toggleswitch-checked .p-toggleswitch-slider {
    background: `).concat(e("toggleswitch.checked.background"),`;
    border-color: `).concat(e("toggleswitch.checked.border.color"),`;
}

.p-toggleswitch.p-toggleswitch-checked .p-toggleswitch-handle {
    background: `).concat(e("toggleswitch.handle.checked.background"),`;
    color: `).concat(e("toggleswitch.handle.checked.color"),`;
    inset-inline-start: calc(`).concat(e("toggleswitch.width")," - calc(").concat(e("toggleswitch.handle.size")," + ").concat(e("toggleswitch.gap"),`));
}

.p-toggleswitch:not(.p-disabled):has(.p-toggleswitch-input:hover) .p-toggleswitch-slider {
    background: `).concat(e("toggleswitch.hover.background"),`;
    border-color: `).concat(e("toggleswitch.hover.border.color"),`;
}

.p-toggleswitch:not(.p-disabled):has(.p-toggleswitch-input:hover) .p-toggleswitch-handle {
    background: `).concat(e("toggleswitch.handle.hover.background"),`;
    color: `).concat(e("toggleswitch.handle.hover.color"),`;
}

.p-toggleswitch:not(.p-disabled):has(.p-toggleswitch-input:hover).p-toggleswitch-checked .p-toggleswitch-slider {
    background: `).concat(e("toggleswitch.checked.hover.background"),`;
    border-color: `).concat(e("toggleswitch.checked.hover.border.color"),`;
}

.p-toggleswitch:not(.p-disabled):has(.p-toggleswitch-input:hover).p-toggleswitch-checked .p-toggleswitch-handle {
    background: `).concat(e("toggleswitch.handle.checked.hover.background"),`;
    color: `).concat(e("toggleswitch.handle.checked.hover.color"),`;
}

.p-toggleswitch:not(.p-disabled):has(.p-toggleswitch-input:focus-visible) .p-toggleswitch-slider {
    box-shadow: `).concat(e("toggleswitch.focus.ring.shadow"),`;
    outline: `).concat(e("toggleswitch.focus.ring.width")," ").concat(e("toggleswitch.focus.ring.style")," ").concat(e("toggleswitch.focus.ring.color"),`;
    outline-offset: `).concat(e("toggleswitch.focus.ring.offset"),`;
}

.p-toggleswitch.p-invalid > .p-toggleswitch-slider {
    border-color: `).concat(e("toggleswitch.invalid.border.color"),`;
}

.p-toggleswitch.p-disabled {
    opacity: 1;
}

.p-toggleswitch.p-disabled .p-toggleswitch-slider {
    background: `).concat(e("toggleswitch.disabled.background"),`;
}

.p-toggleswitch.p-disabled .p-toggleswitch-handle {
    background: `).concat(e("toggleswitch.handle.disabled.background"),`;
}
`)},wt={root:{position:"relative"}},yt={root:function(s){var e=s.instance,i=s.props;return["p-toggleswitch p-component",{"p-toggleswitch-checked":e.checked,"p-disabled":i.disabled,"p-invalid":e.$invalid}]},input:"p-toggleswitch-input",slider:"p-toggleswitch-slider",handle:"p-toggleswitch-handle"},_t=ge.extend({name:"toggleswitch",theme:bt,classes:yt,inlineStyles:wt}),xt={name:"BaseToggleSwitch",extends:st,props:{trueValue:{type:null,default:!0},falseValue:{type:null,default:!1},readonly:{type:Boolean,default:!1},tabindex:{type:Number,default:null},inputId:{type:String,default:null},inputClass:{type:[String,Object],default:null},inputStyle:{type:Object,default:null},ariaLabelledby:{type:String,default:null},ariaLabel:{type:String,default:null}},style:_t,provide:function(){return{$pcToggleSwitch:this,$parentInstance:this}}},ze={name:"ToggleSwitch",extends:xt,inheritAttrs:!1,emits:["change","focus","blur"],methods:{getPTOptions:function(s){var e=s==="root"?this.ptmi:this.ptm;return e(s,{context:{checked:this.checked,disabled:this.disabled}})},onChange:function(s){if(!this.disabled&&!this.readonly){var e=this.checked?this.falseValue:this.trueValue;this.writeValue(e,s),this.$emit("change",s)}},onFocus:function(s){this.$emit("focus",s)},onBlur:function(s){var e,i;this.$emit("blur",s),(e=(i=this.formField).onBlur)===null||e===void 0||e.call(i,s)}},computed:{checked:function(){return this.d_value===this.trueValue}}},kt=["data-p-checked","data-p-disabled"],$t=["id","checked","tabindex","disabled","readonly","aria-checked","aria-labelledby","aria-label","aria-invalid"];function St(o,s,e,i,a,n){return d(),h("div",J({class:o.cx("root"),style:o.sx("root")},n.getPTOptions("root"),{"data-p-checked":n.checked,"data-p-disabled":o.disabled}),[x("input",J({id:o.inputId,type:"checkbox",role:"switch",class:[o.cx("input"),o.inputClass],style:o.inputStyle,checked:n.checked,tabindex:o.tabindex,disabled:o.disabled,readonly:o.readonly,"aria-checked":n.checked,"aria-labelledby":o.ariaLabelledby,"aria-label":o.ariaLabel,"aria-invalid":o.invalid||void 0,onFocus:s[0]||(s[0]=function(){return n.onFocus&&n.onFocus.apply(n,arguments)}),onBlur:s[1]||(s[1]=function(){return n.onBlur&&n.onBlur.apply(n,arguments)}),onChange:s[2]||(s[2]=function(){return n.onChange&&n.onChange.apply(n,arguments)})},n.getPTOptions("input")),null,16,$t),x("div",J({class:o.cx("slider")},n.getPTOptions("slider")),[x("div",J({class:o.cx("handle")},n.getPTOptions("handle")),[ve(o.$slots,"handle",{checked:n.checked})],16)],16)],16,kt)}ze.render=St;const E={hideLesson:Ct,modifyLesson:Lt,publishLesson:Ut,sendLessonForReview:Bt,cancelLessonReview:It,startLessonReview:Vt,acceptLesson:Tt,rejectLesson:zt,editLesson:Rt};async function Ct(o){return await N.patch(`v2/lesson/${o}/hide`)}async function Lt(o){return await N.patch(`v2/lesson/${o}/modify`)}async function Ut(o){return await N.patch(`v2/lesson/${o}/publish`)}async function Bt(o){return await N.patch(`v2/lesson/${o}/review/send`)}async function It(o){return await N.patch(`v2/lesson/${o}/review/cancel`)}async function Vt(o){return await N.patch(`v2/lesson/${o}/review/start`)}async function Tt(o){return await N.patch(`v2/lesson/${o}/review/accept`)}async function zt(o){return await N.patch(`v2/lesson/${o}/review/reject`)}async function Rt(o){return await N.patch(`v2/lesson/${o}/review/edit`)}const V=[];for(let o=0;o<256;++o)V.push((o+256).toString(16).slice(1));function Dt(o,s=0){return(V[o[s+0]]+V[o[s+1]]+V[o[s+2]]+V[o[s+3]]+"-"+V[o[s+4]]+V[o[s+5]]+"-"+V[o[s+6]]+V[o[s+7]]+"-"+V[o[s+8]]+V[o[s+9]]+"-"+V[o[s+10]]+V[o[s+11]]+V[o[s+12]]+V[o[s+13]]+V[o[s+14]]+V[o[s+15]]).toLowerCase()}let re;const At=new Uint8Array(16);function Ft(){if(!re){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");re=crypto.getRandomValues.bind(crypto)}return re(At)}const Pt=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),_e={randomUUID:Pt};function Re(o,s,e){var a;if(_e.randomUUID&&!s&&!o)return _e.randomUUID();o=o||{};const i=o.random??((a=o.rng)==null?void 0:a.call(o))??Ft();if(i.length<16)throw new Error("Random bytes length must be >= 16");return i[6]=i[6]&15|64,i[8]=i[8]&63|128,Dt(i)}const Et={class:"flex items-center"},Mt={class:"flex items-center mr-2"},Nt=I({__name:"HighlightEditor",props:we({index:{},usedSlots:{}},{highlight:{},highlightModifiers:{}}),emits:we(["remove","save"],["update:highlight"]),setup(o,{emit:s}){const e=o,i=me(o,"highlight"),a=_(""),n=_(null),t=_(null),l=_(!1),p=le(()=>n.value!=null&&t.value!=null),c=s,w=()=>{c("remove",e.index)};H(()=>{i.value&&(a.value=i.value.id,n.value=i.value.module,t.value=i.value.slot,l.value=i.value.autoPut)}),P([n,t,l],()=>{n.value!=null&&c("save",e.index,a.value,n.value,t.value,l.value)}),P(p,L=>{L||(l.value=!1)});const v=_(["A","B","C","D","E","F"]),$=_(["8","9"]),f=_(["LED","switch","push-button","light-sensor","touch-sensor","potentiometer","encoder","motion-detector","microphone","climate-sensor","gyro-accel","buzzer","color-sensor","joystick","distance-sensor","servo","led-tower"]),m=le(()=>{if(n.value){if(n.value==="servo"||n.value==="led-tower"){const U=$.value.filter(D=>!(e.usedSlots??[]).includes(D));return t.value&&!U.includes(t.value)&&U.unshift(t.value),[null,...U]}const g=v.value.filter(b=>!(e.usedSlots??[]).includes(b));return t.value&&!g.includes(t.value)&&g.unshift(t.value),[null,...g]}const r=[...v.value,...$.value].filter(y=>!(e.usedSlots??[]).includes(y));return t.value&&!r.includes(t.value)&&r.unshift(t.value),[null,...r]}),C=le(()=>t.value?t.value==="8"||t.value==="9"?["servo","led-tower"]:f.value.filter(L=>L!=="servo"&&L!=="led-tower"):f.value);return(L,r)=>{const y=Be,g=Ue,b=Te,U=Ve,D=A;return d(),h("div",Et,[x("div",Mt,[u(y,{modelValue:l.value,"onUpdate:modelValue":r[0]||(r[0]=B=>l.value=B),binary:"","input-id":"autoput",disabled:!p.value},null,8,["modelValue","disabled"]),r[3]||(r[3]=x("label",{for:"autoput",class:"ml-1 text-sm"},"auto",-1))]),u(U,null,{default:z(()=>[u(g,{modelValue:n.value,"onUpdate:modelValue":r[1]||(r[1]=B=>n.value=B),options:C.value,placeholder:"Select module",class:"place-content-center",size:"small"},null,8,["modelValue","options"]),u(b,{class:"h-[35px]"},{default:z(()=>r[4]||(r[4]=[x("div",null,"=>",-1)])),_:1}),u(g,{modelValue:t.value,"onUpdate:modelValue":r[2]||(r[2]=B=>t.value=B),options:m.value,placeholder:"Select slot",size:"small"},{option:z(({option:B})=>[x("span",{class:pe(B===null?"text-gray-400":"")},Q(B===null?"[null]":B),3)]),value:z(({value:B})=>[x("span",{class:pe(B===null?"text-gray-400":"")},Q(B===null?"[null]":B),3)]),_:1},8,["modelValue","options"])]),_:1}),u(D,{icon:"pi pi-trash",variant:"text",severity:"danger","aria-label":"Remove",onClick:w,class:"ml-2"})])}}}),jt={class:"flex flex-col gap-2"},Gt=I({__name:"HighlightPanel",props:{neededModules:{default:[]},neededModulesModifiers:{}},emits:["update:neededModules"],setup(o){const s=me(o,"neededModules");function e(){s.value=[...s.value,{autoPut:!1,module:null,slot:null,id:Re()}]}function i(n){s.value.splice(n,1)}function a(n,t,l,p,c){s.value[n].id=t,s.value[n].module=l,s.value[n].slot=p,s.value[n].autoPut=c}return(n,t)=>{const l=A,p=et;return d(),S(p,{header:"Highlight slots & modules"},{default:z(()=>[x("div",jt,[(d(!0),h(O,null,K(s.value,(c,w)=>(d(),h("div",{key:c.id},[u(Nt,{highlight:s.value[w],"onUpdate:highlight":v=>s.value[w]=v,index:w,usedSlots:s.value.filter((v,$)=>{var f;return $!==w&&((f=s.value[$])==null?void 0:f.slot)!=null}).map(v=>v.slot),onRemove:i,onSave:a},null,8,["highlight","onUpdate:highlight","index","usedSlots"])]))),128))]),u(l,{icon:"pi pi-plus",variant:"text","aria-label":"Add",class:"self-center mt-2",onClick:e})]),_:1})}}}),Ot={class:"flex"},Ht={class:"h-[500px] flex flex-col w-full relative"},qt={class:"absolute right-2 bottom-2"},de=!1,Jt=I({__name:"PibodyEditor",props:{id:{},content:{},data:{}},emits:["save-content","show-tester"],setup(o,{emit:s}){const e=q(),i=o,a=s,n=_(""),t=_(""),l=_([]);let p=!0;he(()=>{n.value=i.content.starting,t.value=i.content.answer,l.value=i.data.neededModules??[]}),P([n,t,l],()=>{if(p){p=!1;return}a("save-content",{starting:n.value,answer:t.value,hashed_answer:""},{neededModules:l.value.filter(w=>w.module!=null),tests:i.data.tests,includedCommandsForTests:i.data.includedCommandsForTests})},{deep:!0});function c(){a("show-tester",{lesson_id:e.params.id,unit_id:i.id.split("-")[1]})}return(w,v)=>{const $=Ce,f=Le,m=A;return d(),h(O,null,[x("div",Ot,[x("div",Ht,[u(f,{style:{height:"100%",border:"0.1px solid #808080",borderTopLeftRadius:"12px",borderTopRightRadius:"12px",borderBottomLeftRadius:"0px",borderBottomRightRadius:"0px",overflow:"hidden"}},{default:z(()=>[u($,{size:50,minSize:20},{default:z(()=>[u(se,{code:n.value,"onUpdate:code":v[0]||(v[0]=C=>n.value=C),runbuttons:!1,connectbuttons:de,id:i.id+"_",class:"h-full"},null,8,["code","id"])]),_:1}),u($,{size:50,minSize:20},{default:z(()=>[u(se,{code:t.value,"onUpdate:code":v[1]||(v[1]=C=>t.value=C),connectbuttons:de,"onUpdate:connectbuttons":v[2]||(v[2]=C=>de=C),id:i.id,class:"h-full"},null,8,["code","id"])]),_:1})]),_:1}),x("div",qt,[u(m,{label:"Tests",icon:"pi pi-pen-to-square",class:"w-fit",severity:"info",onClick:c})]),u(k(Se),{id:i.id,class:"flex-grow max-h-40"},null,8,["id"])])]),u(Gt,{neededModules:l.value,"onUpdate:neededModules":v[3]||(v[3]=C=>l.value=C),class:"mb-2",style:{borderTopLeftRadius:"0px",borderTopRightRadius:"0px"}},null,8,["neededModules"])],64)}}}),Wt={class:"flex"},Yt={class:"h-[500px] flex flex-col w-full relative"},Kt={class:"absolute right-2 bottom-2"},ce=!1,Qt=I({__name:"CodeEditor",props:{id:{},code:{}},emits:["save-content","show-tester"],setup(o,{emit:s}){const e=q(),i=o,a=s,n=_(""),t=_("");let l=!0;he(()=>{n.value=i.code.starting,t.value=i.code.answer}),P([n,t],()=>{if(l){l=!1;return}a("save-content",{starting:n.value,answer:t.value,hashed_answer:""})});function p(){a("show-tester",{lesson_id:e.params.id,unit_id:i.id.split("-")[1]})}return(c,w)=>{const v=Ce,$=Le,f=A;return d(),h("div",Wt,[x("div",Yt,[u($,{style:{height:"100%",border:"0.1px solid #808080",borderTopLeftRadius:"12px",borderTopRightRadius:"12px",borderBottomLeftRadius:"0px",borderBottomRightRadius:"0px",overflow:"hidden"}},{default:z(()=>[u(v,{size:50,minSize:20},{default:z(()=>[u(se,{code:n.value,"onUpdate:code":w[0]||(w[0]=m=>n.value=m),runbuttons:!1,connectbuttons:ce,id:i.id+"_",class:"h-full"},null,8,["code","id"])]),_:1}),u(v,{size:50,minSize:20},{default:z(()=>[u(se,{code:t.value,"onUpdate:code":w[1]||(w[1]=m=>t.value=m),connectbuttons:ce,"onUpdate:connectbuttons":w[2]||(w[2]=m=>ce=m),id:i.id,class:"h-full"},null,8,["code","id"])]),_:1})]),_:1}),x("div",Kt,[u(f,{label:"Tests",icon:"pi pi-pen-to-square",class:"w-fit",severity:"info",onClick:p})]),u(k(Se),{id:i.id,class:"flex-grow max-h-40"},null,8,["id"])])])}}}),Zt=["article","options","open","video","code","pibody"],G=Ae("lesson-edit-store",()=>{const o=Fe(),s=$e(),{lang:e}=M(s),i=_(null),a=_(!1),n=_(!1),t=_(!1),l=_(!1),p=_(!1),c=_(!1);function w(r){t.value=r}async function v(r){try{a.value=!0;const{data:y}=await ye.getLessonById(r,void 0,e.value);i.value=qe(y)}catch(y){o.add({severity:"error",summary:y.response.data.error,life:2e3})}finally{a.value=!1}}async function $(r,y){try{n.value=!0;const{data:g}=await oe.getUnitByIdandLessonId(r,y,e.value);return g}catch(g){o.add({severity:"error",summary:g.response.data.error,life:2e3})}finally{n.value=!1}}async function f(r){try{l.value=!0;const{data:y}=await oe.createUnitByLessonId(i.value.id,r);o.add({severity:"success",summary:y.message,life:2e3})}catch(y){o.add({severity:"error",summary:y.response.data.error,life:2e3})}finally{l.value=!1}}async function m(r,y,g){try{p.value=!0;const{data:b}=await oe.updateUnitByIdandLessonId(r,y,g,e.value);return b.unit_id}catch(b){o.add({severity:"error",summary:b.response.data.error,life:2e3})}finally{p.value=!1}}async function C(r,y){try{c.value=!0;const{data:g}=await oe.deleteUnitByIdandLessonId(r,y);o.add({severity:"success",summary:g.message,life:2e3})}catch(g){o.add({severity:"error",summary:g.response.data.error,life:2e3})}finally{c.value=!1}}async function L(r,y){try{c.value=!0;const{data:g}=await ye.translateLesson(r,e.value,y,"chatgpt");o.add({severity:"success",summary:g.message,life:2e3})}catch(g){o.add({severity:"error",summary:g.response.data.error,life:2e3})}finally{c.value=!1}}return{selectedLesson:i,isLessonLoading:a,isLessonSaving:t,isUnitLoading:n,isUnitCreating:l,isUnitUpdating:p,isUnitDeleting:c,setLessonSaving:w,loadLessonById:v,loadUnitByIdandLessonId:$,createUnit:f,updateUnitByIdandLessonId:m,deleteUnitByIdandLessonId:C,translateLessonToLang:L}}),Xt={class:"flex items-start"},en=I({__name:"MdEditor",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(o){const s=me(o,"modelValue"),e=Pe({title:{title:"Title",icon:"v-md-icon-tip",action(a){a.insert(n=>{const t="# <center>",l="</center>",c=n||"Title";return{text:`${t}${c}${l}`,selected:c}})}},icons:{title:"icons",icon:"v-md-icon-tip",menus:[{name:"Attention",text:"Attention",action(a){a.insert(()=>{const n='<span style="font-size: 20px">',t="</span>",l="⚠️";return{text:`${n}${l}${t}`,selected:l}})}},{name:"PiBody",text:"PiBody",action(a){a.insert(()=>{const n="<b>",t="</b>",l='<span style="color: #FF3F85"> Pi</span>Body';return{text:`${n}${l}${t}`,selected:l}})}},{name:"Run",text:"Run",action(a){a.insert(()=>({text:'<img src="https://static.artisan.education/lessons/image__c9041f3cc90b4dc188f9c2277f57f5a0..png" alt="Run" style="height: 1em;vertical-align: -0.2em;display:inline;">'}))}}]},style:{title:"Style",icon:"v-md-icon-tip",action(a){a.insert(n=>{const t='<span style="">',l="</span>",c=n||"placeholder";return{text:`${t}${c}${l}`,selected:c}})}},underline:{title:"Underline",icon:"v-md-icon-under-line",action(a){a.insert(n=>{const t='<span style="text-decoration: underline">',l="</span>",c=n||"placeholder";return{text:`${t}${c}${l}`,selected:c}})}},tip:{title:"Tip",icon:"v-md-icon-tip",action(a){a.insert(n=>{const t='<div style="background-color:#F3F5F7; padding: 20px; border-left: solid 8px #42B983">',l="</div>",c=n||"placeholder";return{text:`${t}${c}${l}`,selected:c}})}},note:{title:"Note",icon:"v-md-icon-tip",action(a){a.insert(n=>{const t='<div style="background-color:#F3F5F7; padding: 15px; border-left: solid 8px #FFCD6B; margin-bottom: 15px">',l="</div>",c=n||"placeholder";return{text:`${t}${c}${l}`,selected:c}})}}});async function i(a,n,t){const l=t[0],p=new FormData;p.append("file",l);try{const{data:c}=await tt.uploadFile(p,"image_"),w=c.source_url;n({url:w,desc:"desc",width:"auto",height:"auto"})}catch(c){console.log(c)}}return(a,n)=>{const t=Ee("v-md-editor");return d(),h("div",Xt,[u(t,{modelValue:s.value,"onUpdate:modelValue":n[0]||(n[0]=l=>s.value=l),mode:"edit",onChange:n[1]||(n[1]=l=>s.value=l),"left-toolbar":"undo redo clear | tip emoji todo-list | h bold italic strikethrough quote ul ol table hr link code image | title icons style underline tip note","right-toolbar":"",toolbar:e,"disabled-menus":[],onUploadImage:i},null,8,["modelValue","toolbar"])])}}}),De=nt(en,[["__scopeId","data-v-a01c761e"]]),tn=I({__name:"ArticleEditor",props:{article:{}},emits:["save-content"],setup(o,{emit:s}){const e=o,i=s,a=_("");let n=!0;return H(()=>{var t;a.value=((t=e.article)==null?void 0:t.text)??""}),P(a,()=>{if(n){n=!1;return}i("save-content",{text:a.value})},{flush:"post"}),(t,l)=>(d(),S(De,{modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=p=>a.value=p)},null,8,["modelValue"]))}}),nn={class:"flex flex-col gap-2"},on={class:"flex gap-1 text-gray-500"},sn={class:"flex flex-col gap-1"},ln=I({__name:"OptionsEditor",props:{optionsData:{}},emits:["save-content"],setup(o,{emit:s}){const e=o,i=s,a=_(!1),n=_(!1),t=_(!1),l=_([]),p=_([]),c=_();let w=!0;H(()=>{var f,m,C,L,r,y;a.value=((f=e.optionsData)==null?void 0:f.shuffle)??!1,n.value=((m=e.optionsData)==null?void 0:m.feedback)??!1,t.value=((C=e.optionsData)==null?void 0:C.single)??!1,l.value=((L=e.optionsData)==null?void 0:L.options)??[],p.value=((r=e.optionsData)==null?void 0:r.answer)??[],c.value=e.optionsData&&e.optionsData.answer&&e.optionsData.answer.length>0?(y=e.optionsData)==null?void 0:y.answer[0]:void 0}),P([a,n,t,l,p,c],()=>{if(w){w=!1;return}i("save-content",{shuffle:a.value,feedback:n.value,single:t.value,options:l.value,answer:t.value?c.value?[c.value]:[]:p.value,hashed_answer:[]})},{deep:!0});function v(){l.value.push({id:Re(),text:""})}function $(f){l.value=l.value.filter(m=>m.id!==f),p.value=p.value.filter(m=>m!==f),c.value==f&&(c.value=void 0)}return(f,m)=>{const C=ze,L=ot,r=Be,y=A;return d(),h("div",nn,[x("div",on,[m[5]||(m[5]=x("div",null,"shuffle:",-1)),u(C,{modelValue:a.value,"onUpdate:modelValue":m[0]||(m[0]=g=>a.value=g),class:"mr-2"},null,8,["modelValue"]),m[6]||(m[6]=x("div",null,"feedback:",-1)),u(C,{modelValue:n.value,"onUpdate:modelValue":m[1]||(m[1]=g=>n.value=g),class:"mr-2"},null,8,["modelValue"]),m[7]||(m[7]=x("div",null,"single:",-1)),u(C,{modelValue:t.value,"onUpdate:modelValue":m[2]||(m[2]=g=>t.value=g)},null,8,["modelValue"])]),x("div",sn,[(d(!0),h(O,null,K(l.value,g=>(d(),h("div",{key:g.id,class:"flex gap-2 items-center"},[t.value?(d(),S(L,{key:0,modelValue:c.value,"onUpdate:modelValue":m[3]||(m[3]=b=>c.value=b),value:g.id},null,8,["modelValue","value"])):(d(),S(r,{key:1,modelValue:p.value,"onUpdate:modelValue":m[4]||(m[4]=b=>p.value=b),value:g.id},null,8,["modelValue","value"])),u(De,{modelValue:g.text,"onUpdate:modelValue":b=>g.text=b,class:"w-full"},null,8,["modelValue","onUpdate:modelValue"]),u(y,{icon:"pi pi-trash",variant:"text",severity:"danger",size:"small",onClick:b=>$(g.id)},null,8,["onClick"])]))),128))]),u(y,{icon:"pi pi-plus",label:"Add option",variant:"text",size:"small",onClick:v,class:"self-center"})])}}}),an=I({__name:"OpenEditor",props:{open:{}},emits:["save-content"],setup(o,{emit:s}){const e=o,i=s,a=_("");let n=!0;return H(()=>{var t;a.value=((t=e.open)==null?void 0:t.answer)??""}),P(a,()=>{if(n){n=!1;return}i("save-content",{answer:a.value,hashed_answer:""})}),(t,l)=>{const p=Ie;return d(),S(p,{type:"text",modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=c=>a.value=c??""),class:"w-full",size:"small"},null,8,["modelValue"])}}}),rn=I({__name:"VideoEditor",props:{video:{}},emits:["save-content"],setup(o,{emit:s}){const e=o,i=s,a=_("");let n=!0;return H(()=>{var t;a.value=((t=e.video)==null?void 0:t.url)??""}),P(a,()=>{if(n){n=!1;return}i("save-content",{url:a.value})}),(t,l)=>{const p=Ie;return d(),S(p,{type:"text",modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=c=>a.value=c??""),class:"w-full",size:"small"},null,8,["modelValue"])}}}),dn={class:"bg-white rounded-lg border border-gray-200"},cn={key:1,class:"flex flex-col h-full w-full"},un={class:"flex items-center gap-2 px-4 pt-2"},pn={class:"text-sm"},gn={class:"text-sm text-gray-500"},vn={key:1,class:"flex-grow px-4 py-2"},mn={class:"flex justify-end"},hn=I({__name:"UnitCard",props:{unit:{},loading:{type:Boolean}},emits:["delete","update"],setup(o,{emit:s}){const e=o,i=s,a=q(),n=ke(),t=G(),{updateUnitByIdandLessonId:l,setLessonSaving:p,loadUnitByIdandLessonId:c}=t,w=_(!1),v=_(null),$=_(null);he(async()=>{w.value=!0;const r=await c(e.unit.id,Number(a.params.id));r&&(v.value=r.content,$.value=r.data),w.value=!1});function f(r,y){p(!0),C(r,y)}function m(r){n.push({name:"tester2",params:{lesson_id:r.lesson_id,unit_id:r.unit_id}})}const C=Ze((r,y)=>{L(r,y)},1e3,{maxWait:5e3});async function L(r,y){const g=await l(e.unit.id,Number(a.params.id),{content:r,data:y});g&&i("update",e.unit,g),p(!1)}return(r,y)=>{const g=Qe,b=A;return d(),h("div",dn,[r.loading?(d(),S(g,{key:0,class:"flex justify-center items-center w-10 h-full"})):(d(),h("div",cn,[x("div",un,[x("div",pn,Q(r.unit.id),1),x("div",gn,Q(`${r.unit.unitType}`),1)]),w.value?(d(),S(g,{key:0,class:"flex justify-center items-center w-10 h-full"})):(d(),h("div",vn,[r.unit.unitType=="article"?(d(),S(tn,{key:0,article:v.value,onSaveContent:f},null,8,["article"])):r.unit.unitType=="options"?(d(),S(ln,{key:1,"options-data":v.value,onSaveContent:f},null,8,["options-data"])):r.unit.unitType=="open"?(d(),S(an,{key:2,open:v.value,onSaveContent:f},null,8,["open"])):r.unit.unitType=="video"?(d(),S(rn,{key:3,video:v.value,onSaveContent:f},null,8,["video"])):e.unit.unitType=="code"?(d(),S(k(Qt),{key:4,id:`code-${e.unit.id}`,code:v.value,onSaveContent:f,onShowTester:m},null,8,["id","code"])):e.unit.unitType=="pibody"?(d(),S(k(Jt),{key:5,id:`code-${e.unit.id}`,content:v.value,data:$.value,onSaveContent:f,onShowTester:m},null,8,["id","content","data"])):T("",!0)])),x("div",mn,[u(b,{icon:"pi pi-trash",size:"small",severity:"danger",variant:"text",onClick:y[0]||(y[0]=fe(U=>i("delete",e.unit),["stop"]))})])]))])}}}),fn={class:"group w-full relative"},bn={class:"flex"},ue=I({__name:"AddUnitButton",props:{unitId:{},showAddGroup:{type:Boolean},hided:{type:Boolean}},emits:["add-group-divider"],setup(o,{emit:s}){const e=o,i=s,a=q(),n=G(),{loadLessonById:t,createUnit:l}=n,p=_(),c=_(Zt.map(v=>({label:v,command:async()=>{await l({unit_type:v,prev_unit_id:e.unitId??void 0}),await t(Number(a.params.id))}}))),w=v=>{p.value.toggle(v)};return(v,$)=>{const f=at,m=A,C=lt;return d(),h(O,null,[x("div",fn,[$[1]||($[1]=x("div",{class:"h-3"},null,-1)),x("div",{class:pe(["absolute left-1/2 -translate-x-1/2 -top-5 group-hover:block mt-[9px] w-full",v.hided?"hidden":""])},[x("div",bn,[u(f,{class:"w-7",type:"dashed"}),u(f,{class:"flex-grow",type:"dashed"}),u(m,{icon:"pi pi-plus",class:"flex self-end shadow-xl h-7",size:"small",onClick:w}),u(f,{class:"flex-grow",type:"dashed"}),v.showAddGroup?(d(),S(m,{key:0,icon:"pi pi-arrow-up-right-and-arrow-down-left-from-center",class:"flex self-end h-7",size:"small",variant:"text",onClick:$[0]||($[0]=L=>i("add-group-divider"))})):(d(),S(f,{key:1,class:"w-7",type:"dashed"}))])],2)]),u(C,{ref_key:"menu",ref:p,model:c.value,popup:!0},null,8,["model"])],64)}}}),wn=I({__name:"RemoveGroupButton",emits:["remove-group-divider"],setup(o,{emit:s}){const e=s;return(i,a)=>{const n=A;return d(),S(n,{icon:"pi pi-arrow-down-left-and-arrow-up-right-to-center",severity:"danger",class:"flex self-end h-7 w-7",size:"small",variant:"text",onClick:a[0]||(a[0]=fe(t=>e("remove-group-divider"),["stop"]))})}}}),yn={class:"flex flex-col gap-2"},_n={class:"w-full flex justify-between gap-2 mr-4"},xn={class:"flex flex-row"},kn={class:"flex flex-col p-2 rounded-lg bg-slate-50"},$n=I({__name:"UnitsView",props:{pages:{}},setup(o){const s=o,e=q(),i=Me(),a=G(),{isUnitDeleting:n}=M(a),{loadLessonById:t,createUnit:l,deleteUnitByIdandLessonId:p}=a,c=_(null);async function w(b){await l({unit_type:"group-divider",prev_unit_id:b.id}),await t(Number(e.params.id))}async function v(){await l({unit_type:"page-divider"}),await t(Number(e.params.id))}async function $(b){await l({unit_type:"page-divider",prev_unit_id:b}),await p(b,Number(e.params.id)),await t(Number(e.params.id))}async function f(b){await p(b,Number(e.params.id)),await t(Number(e.params.id))}function m(b){c.value=b,i.require({...Oe,message:"Are you sure you want to delete this lesson?",accept:async()=>{await p(b.id,Number(e.params.id)),await t(Number(e.params.id))}})}function C(b,U){U>b.id&&(b.id=U)}const L=Number(e.params.id),r=`openedPanels-${L}`,y=_({});H(async()=>{const b=localStorage.getItem(r);b&&(y.value=JSON.parse(b)),await Ne(),setTimeout(()=>{const U=localStorage.getItem(`lastOpenedGroup-${L}`);if(U){const D=document.getElementById(`group-${U}`);if(D){D.scrollIntoView({behavior:"smooth"});return}}},1e3)}),P(y,b=>{localStorage.setItem(r,JSON.stringify(b))},{deep:!0});function g(b,U){y.value[U]=b,y.value[U].length>0&&localStorage.setItem(`lastOpenedGroup-${L}`,b[b.length-1])}return(b,U)=>{const D=A,B=Je,Z=We,X=Ye,ee=Ke;return d(),h("div",yn,[(d(!0),h(O,null,K(s.pages,j=>(d(),S(ee,{value:y.value[j.id]||[],"onUpdate:value":R=>g(R,j.id),multiple:"",key:j.id,class:"flex flex-col gap-2 bg-white p-4 rounded-lg shadow-lg"},{default:z(()=>[(d(!0),h(O,null,K(j.groups,(R,W)=>(d(),S(X,{key:R.id,value:R.id,id:`group-${R.id}`},{default:z(()=>[u(B,null,{default:z(()=>[x("div",_n,[x("div",null,"Step: "+Q(W),1),x("div",xn,[W!=0?(d(),S(D,{key:0,icon:"pi pi-file-plus",class:"flex self-end h-7 w-7",size:"small",variant:"text",onClick:fe(F=>$(R.id),["stop"])},null,8,["onClick"])):T("",!0),R.id!=-1?(d(),S(wn,{key:1,onRemoveGroupDivider:F=>f(R.id)},null,8,["onRemoveGroupDivider"])):T("",!0)])])]),_:2},1024),u(Z,{class:"flex flex-col"},{default:z(()=>[x("div",kn,[(d(!0),h(O,null,K(R.units,(F,te)=>{var Y;return d(),h("div",{key:F.id},[te==0?(d(),S(ue,{key:0,hided:!0,"unit-id":R.id,"show-add-group":!1},null,8,["unit-id"])):T("",!0),u(hn,{unit:F,loading:((Y=c.value)==null?void 0:Y.id)===F.id&&k(n),onDelete:ne=>m(F),onUpdate:C},null,8,["unit","loading","onDelete"]),u(ue,{hided:!0,"unit-id":F.id,"show-add-group":!0,onAddGroupDivider:ne=>w(F)},null,8,["unit-id","onAddGroupDivider"])])}),128)),R.units.length==0?(d(),S(ue,{key:0,hided:!1,"unit-id":R.id,"show-add-group":!1},null,8,["unit-id"])):T("",!0)])]),_:2},1024)]),_:2},1032,["value","id"]))),128))]),_:2},1032,["value","onUpdate:value"]))),128)),u(D,{id:"newpage",icon:"pi pi-plus",label:"New page",variant:"text",size:"small",class:"flex self-center",onClick:U[0]||(U[0]=j=>v())})])}}}),Sn={class:"w-[24px] h-[24px]"},Cn={key:0,class:"flex items-center"},Ln={key:0,class:"material-icons text-gray-500"},Un={key:1,class:"material-icons text-gray-500"},Bn={key:1},In={class:"material-icons text-gray-500"},Vn=I({__name:"AutoSaveCloud",setup(o){const s=G(),{selectedLesson:e,isLessonSaving:i}=M(s);return(a,n)=>{var l;const t=Xe;return d(),h("div",Sn,[(l=k(e))!=null&&l.editable?(d(),h("div",Cn,[k(i)?ae((d(),h("span",Un,n[1]||(n[1]=[ie("cloud_sync")]))),[[t,"Saving...",void 0,{bottom:!0}]]):ae((d(),h("span",Ln,n[0]||(n[0]=[ie("cloud_done")]))),[[t,"Saved",void 0,{bottom:!0}]])])):(d(),h("div",Bn,[ae((d(),h("span",In,n[2]||(n[2]=[ie("cloud_off")]))),[[t,"Save not allowed",void 0,{bottom:!0}]])]))])}}}),Tn={key:0},zn={key:0},Rn={key:1},Dn={key:0},An={key:1},Fn={key:2},Pn={key:0,class:"flex gap-1"},En={key:3},Mn={key:0},Nn={key:4},jn={key:0,class:"flex gap-1"},Gn={key:5},On={key:0,class:"flex gap-1"},Hn={key:6},qn={key:0,class:"flex gap-1"},Jn=I({__name:"StageButtons",setup(o){const s=q(),e=je(),{user:i}=M(e),a=G(),{selectedLesson:n}=M(a),t=_(!1),l=_(!1);async function p(){t.value=!0;try{await E.sendLessonForReview(s.params.id.toString()),window.location.reload()}catch(r){console.log(r)}finally{t.value=!1}}async function c(){t.value=!0;try{await E.cancelLessonReview(s.params.id.toString()),window.location.reload()}catch(r){console.log(r)}finally{t.value=!1}}async function w(){t.value=!0;try{await E.startLessonReview(s.params.id.toString()),window.location.reload()}catch(r){console.log(r)}finally{t.value=!1}}async function v(){t.value=!0;try{await E.acceptLesson(s.params.id.toString()),window.location.reload()}catch(r){console.log(r)}finally{t.value=!1}}async function $(){l.value=!0;try{await E.rejectLesson(s.params.id.toString()),window.location.reload()}catch(r){console.log(r)}finally{l.value=!1}}async function f(){t.value=!0;try{await E.editLesson(s.params.id.toString()),window.location.reload()}catch(r){console.log(r)}finally{t.value=!1}}async function m(){t.value=!0;try{await E.publishLesson(s.params.id.toString()),window.location.reload()}catch(r){console.log(r)}finally{t.value=!1}}async function C(){l.value=!0;try{await E.hideLesson(s.params.id.toString()),window.location.reload()}catch(r){console.log(r)}finally{l.value=!1}}async function L(){t.value=!0;try{await E.modifyLesson(s.params.id.toString()),window.location.reload()}catch(r){console.log(r)}finally{t.value=!1}}return(r,y)=>{var b,U,D,B,Z,X,ee,j,R,W,F,te,Y,ne,be;const g=A;return((b=k(n))==null?void 0:b.stage)=="prepare_for_submission"?(d(),h("div",Tn,[((U=k(i))==null?void 0:U.user_type)=="contributor"?(d(),h("div",zn,[u(g,{label:"Send for review",severity:"info",size:"small",onClick:p,disabled:t.value,loading:t.value},null,8,["disabled","loading"])])):T("",!0)])):((D=k(n))==null?void 0:D.stage)=="waiting_for_review"?(d(),h("div",Rn,[((B=k(i))==null?void 0:B.user_type)=="contributor"?(d(),h("div",Dn,[u(g,{label:"Cancel submission",severity:"danger",size:"small",onClick:c,disabled:t.value,loading:t.value},null,8,["disabled","loading"])])):((Z=k(i))==null?void 0:Z.user_type)=="editor"?(d(),h("div",An,[u(g,{label:"Start review",severity:"info",size:"small",onClick:w,disabled:t.value,loading:t.value},null,8,["disabled","loading"])])):T("",!0)])):((X=k(n))==null?void 0:X.stage)=="in_review"?(d(),h("div",Fn,[((ee=k(i))==null?void 0:ee.user_type)=="editor"?(d(),h("div",Pn,[u(g,{label:"Reject",severity:"danger",size:"small",onClick:$,disabled:t.value||l.value,loading:l.value},null,8,["disabled","loading"]),u(g,{label:"Accept",size:"small",onClick:v,disabled:t.value||l.value,loading:t.value},null,8,["disabled","loading"])])):T("",!0)])):((j=k(n))==null?void 0:j.stage)=="rejected"?(d(),h("div",En,[((R=k(i))==null?void 0:R.user_type)=="contributor"?(d(),h("div",Mn,[u(g,{label:"Edit submission",severity:"info",size:"small",onClick:f,disabled:t.value,loading:t.value},null,8,["disabled","loading"])])):T("",!0)])):((W=k(n))==null?void 0:W.stage)=="ready_for_publish"?(d(),h("div",Nn,[((F=k(i))==null?void 0:F.user_type)=="editor"?(d(),h("div",jn,[k(n).createdBy!=Number(k(i).user_id)?(d(),S(g,{key:0,label:"Reject",severity:"danger",size:"small",onClick:$,disabled:t.value||l.value,loading:l.value},null,8,["disabled","loading"])):T("",!0),u(g,{label:"Publish",size:"small",onClick:m,disabled:t.value||l.value,loading:t.value},null,8,["disabled","loading"])])):T("",!0)])):((te=k(n))==null?void 0:te.stage)=="published"?(d(),h("div",Gn,[((Y=k(i))==null?void 0:Y.user_type)=="editor"?(d(),h("div",On,[u(g,{label:"Hide",severity:"danger",size:"small",onClick:C,disabled:t.value||l.value,loading:l.value},null,8,["disabled","loading"]),u(g,{label:"Modify",size:"small",onClick:L,disabled:t.value||l.value,loading:t.value},null,8,["disabled","loading"])])):T("",!0)])):((ne=k(n))==null?void 0:ne.stage)=="in_modify"?(d(),h("div",Hn,[((be=k(i))==null?void 0:be.user_type)=="editor"?(d(),h("div",qn,[u(g,{label:"Hide",severity:"danger",size:"small",onClick:C,disabled:t.value||l.value,loading:l.value},null,8,["disabled","loading"]),u(g,{label:"Publish",size:"small",onClick:m,disabled:t.value||l.value,loading:t.value},null,8,["disabled","loading"])])):T("",!0)])):T("",!0)}}}),Wn={key:0},Yn=I({__name:"StageStatus",setup(o){const s=G(),{selectedLesson:e}=M(s);return(i,a)=>{const n=it;return k(e)?(d(),h("div",Wn,[["prepare_for_submission","waiting_for_review","in_review","in_modify"].includes(k(e).stage)?(d(),S(n,{key:0,label:k(e).stage.replace(/_/g," ").replace(/^./,t=>t.toUpperCase()),icon:"pi pi-clock",pt:{icon:{class:"text-yellow-500"}},class:"h-8 bg-yellow-50 w-fit"},null,8,["label"])):["ready_for_publish","published"].includes(k(e).stage)?(d(),S(n,{key:1,label:k(e).stage.replace(/_/g," ").replace(/^./,t=>t.toUpperCase()),icon:"pi pi-check-circle",pt:{icon:{class:"text-green-500"}},class:"h-8 bg-green-50 w-fit"},null,8,["label"])):["rejected"].includes(k(e).stage)?(d(),S(n,{key:2,label:k(e).stage.replace(/_/g," ").replace(/^./,t=>t.toUpperCase()),icon:"pi pi-times-circle",pt:{icon:{class:"text-red-500"}},class:"h-8 bg-red-50 w-fit"},null,8,["label"])):T("",!0)])):T("",!0)}}}),Kn={class:"flex flex-col gap-4"},Qn={class:"flex justify-end gap-2 mt-4"},Zn=I({__name:"TranslateSelector",setup(o){const s=G(),{translateLessonToLang:e}=s,{selectedLesson:i}=M(s),a=_(!1),n=_(null),t=_(!1);async function l(){var p;if(!(!n.value||!((p=i.value)!=null&&p.id))){t.value=!0;try{console.log("▶️ Translating lesson",i.value.id,"→",n.value),await e(i.value.id,n.value),console.log("✅ Translation complete")}catch(c){console.error("❌ Translation error:",c)}finally{t.value=!1,a.value=!1}}}return(p,c)=>{const w=A,v=Ue,$=Ge;return d(),h("div",null,[u(w,{icon:"pi pi-language",variant:"text",severity:"contrast",onClick:c[0]||(c[0]=f=>a.value=!0)}),u($,{visible:a.value,"onUpdate:visible":c[3]||(c[3]=f=>a.value=f),modal:"",header:"Translate lesson",style:{width:"400px"}},{default:z(()=>[x("div",Kn,[c[4]||(c[4]=x("label",{for:"targetLang",class:"font-semibold"}," Choose language to translate to: ",-1)),u(v,{id:"targetLang",modelValue:n.value,"onUpdate:modelValue":c[1]||(c[1]=f=>n.value=f),options:k(rt),optionLabel:"label",optionValue:"locale",placeholder:"Choose",class:"w-full"},null,8,["modelValue","options"]),x("div",Qn,[u(w,{label:"Cancel",text:"",onClick:c[2]||(c[2]=f=>a.value=!1)}),u(w,{label:"Translate",disabled:!n.value,loading:t.value,onClick:l},null,8,["disabled","loading"])])])]),_:1},8,["visible"])])}}}),Xn={class:"flex flex-col items-center"},eo={class:"flex justify-between items-center w-full min-h-16 border-b border-gray-200 px-8 shadow-md gap-8"},to={class:"flex items-center gap-4"},no={class:"flex items-center gap-4"},oo={class:"w-full h-full max-w-screen-lg px-4 md:px-28 py-8"},so={class:"fixed top-32 right-0 pl-2 pr-4 py-2 bg-white rounded-tl-lg rounded-bl-lg shadow-md z-50 border border-gray-200 flex flex-col items-center gap-4"},Fo=I({__name:"LessonEditPage",setup(o){const s=q(),e=ke(),i=$e(),{lang:a}=M(i),n=G(),{selectedLesson:t}=M(n),{loadLessonById:l}=n;H(()=>l(Number(s.params.id))),P(a,async(w,v)=>{w!==v&&t.value&&await l(t.value.id)});const p=()=>{const w=s.path.endsWith("/edit")?s.path.replace(/\/edit$/,""):"#";window.open(w,"_blank")};function c(){window.history.length>2?e.go(-1):e.push("/v2/routes")}return(w,v)=>{var f;const $=A;return d(),h("div",Xn,[x("div",eo,[x("div",to,[u($,{icon:"pi pi-times",variant:"text",severity:"contrast",onClick:c}),u(Yn)]),x("div",no,[u(Jn)])]),x("div",oo,[(d(),S($n,{key:k(a),pages:(f=k(t))==null?void 0:f.pages},null,8,["pages"]))]),x("div",so,[u(Vn),u(k(He)),u($,{icon:"pi pi-eye",variant:"text",severity:"contrast",onClick:p}),u(Zn)])])}}});export{Fo as default};
