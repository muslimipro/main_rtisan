import{s as E,a as j}from"./index-D5kG6F_z.js";import{b as q,a as A}from"./index-yvA8FfnO.js";import{s as I}from"./index-BJfLtNZ1.js";import{b as D,a3 as K,a4 as O,u as P,r as v,K as R,o as y,p as V,y as o,j as n,t as u,g as l,x as M,z,e as L,c as x,i as h,q as G,k as B,w as H,b3 as J}from"./index-ZdE7U8ry.js";import{u as N}from"./useTeacherStore-B4zGRQzz.js";import{s as Q}from"./index-C6IkD9s3.js";import{T as F}from"./teacherApi-ChljfHMW.js";import"./index-BXerg610.js";import"./index-B57BgiIA.js";import"./index-BYWYeXWg.js";import"./index-C2eTZOWJ.js";import"./index-DPuc4aiI.js";import"./index-BBecsrrk.js";import"./index-Ds_KT1e9.js";import"./index-Heetihh1.js";import"./index-DfgxoLUr.js";import"./index-8t2txb0B.js";const W={class:"flex flex-col gap-1"},X={class:"flex flex-col"},Y={class:"font-bold text-sm mb-1"},Z={class:"flex gap-2 justify-end"},ee=D({__name:"EditClassDialog",props:K({selectedClass:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(w){const c=O(w,"modelValue"),m=w,r=P(),T=N(),{loadClasses:_}=T,i=v(""),d=v(!1);R(()=>m.selectedClass,e=>{i.value="",e&&(i.value=e.name)},{immediate:!0});async function f(){d.value=!0;try{const{data:e}=await F.createClass(i.value);await _(),r.add({severity:"success",summary:e.message,life:2e3}),c.value=!1}catch(e){r.add({severity:"error",summary:e.response.data.error,detail:e,life:2e3})}finally{d.value=!1}}async function $(){if(m.selectedClass){d.value=!0;try{const{data:e}=await F.updateClassById(m.selectedClass.id,i.value);await _(),r.add({severity:"success",summary:e.message,life:2e3}),c.value=!1}catch(e){r.add({severity:"error",summary:e.response.data.error,detail:e,life:2e3})}finally{d.value=!1}}}return(e,a)=>{const t=I,g=Q,b=M,k=z;return y(),V(k,{visible:c.value,"onUpdate:visible":a[2]||(a[2]=p=>c.value=p),modal:"",draggable:!1,class:"m-4 max-w-md",header:m.selectedClass?e.$t("pages.teacher.editClass"):e.$t("pages.teacher.addClass")},{default:o(()=>[n("div",W,[n("div",X,[n("div",Y,u(e.$t("pages.teacher.name")),1),l(t,{type:"text",modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=p=>i.value=p)},null,8,["modelValue"])]),l(g),n("div",Z,[l(b,{label:e.$t("pages.teacher.cancel"),severity:"secondary",onClick:a[1]||(a[1]=p=>c.value=!1)},null,8,["label"]),m.selectedClass==null?(y(),V(b,{key:0,label:e.$t("pages.teacher.create"),onClick:f,loading:d.value,disabled:d.value},null,8,["label","loading","disabled"])):(y(),V(b,{key:1,label:e.$t("pages.teacher.save"),onClick:$,loading:d.value,disabled:d.value},null,8,["label","loading","disabled"]))])])]),_:1},8,["visible","header"])}}}),ae={class:"flex-grow min-w-0 pb-4 mb-4 bg-white rounded-md border"},se={class:"flex items-center"},le={class:"flex-grow flex gap-2 items-center"},te={key:0,class:"text-2xl"},oe={class:"flex gap-2"},we=D({__name:"ClassesView",setup(w){const c=H(),m=v(),r=v();(()=>{r.value={global:{value:null,matchMode:J.CONTAINS}}})();const _=N(),{classes:i,isLoading:d}=L(_),f=v(!1),$=v(null);function e(a){f.value=!0,$.value=a}return(a,t)=>{const g=M,b=q,k=I,p=A,C=E,S=j;return y(),x("div",ae,[l(S,{ref_key:"dt",ref:m,filters:r.value,"onUpdate:filters":t[2]||(t[2]=s=>r.value=s),value:h(i),dataKey:"id",loading:h(d),scrollable:"",globalFilterFields:["name","email"],class:"rounded-md overflow-hidden w-full",paginator:"",rows:10,rowsPerPageOptions:[5,10,25]},{header:o(()=>[n("div",se,[n("div",le,[h(i)?(y(),x("div",te,u(a.$t("pages.teacher.classes"))+" - "+u(h(i).length),1)):G("",!0)]),l(g,{label:a.$t("pages.teacher.addClass"),icon:"pi pi-plus",variant:"outlined",class:"mr-2",onClick:t[0]||(t[0]=s=>e(null))},null,8,["label"]),l(p,null,{default:o(()=>[l(b,null,{default:o(()=>t[4]||(t[4]=[n("i",{class:"pi pi-search"},null,-1)])),_:1}),l(k,{modelValue:r.value.global.value,"onUpdate:modelValue":t[1]||(t[1]=s=>r.value.global.value=s),placeholder:a.$t("pages.teacher.search")},null,8,["modelValue","placeholder"])]),_:1})])]),empty:o(()=>[B(u(a.$t("pages.teacher.noClassesFound")),1)]),loading:o(()=>[B(u(a.$t("pages.teacher.loadingClasses")),1)]),default:o(()=>[l(C,{field:"name",header:a.$t("pages.teacher.name"),sortable:""},{body:o(({data:s})=>[n("div",null,u(`${s.name}`),1)]),_:1},8,["header"]),l(C,{field:"creator_name",header:a.$t("pages.teacher.classTeacher"),sortable:""},{body:o(({data:s})=>[n("div",null,u(`${s.creator_name??s.creator_email}`),1)]),_:1},8,["header"]),l(C,{field:"student_count",header:a.$t("pages.teacher.students"),sortable:""},{body:o(({data:s})=>[n("div",null,u(`${s.student_count}`),1)]),_:1},8,["header"]),l(C,{exportable:!1},{body:o(({data:s})=>[n("div",oe,[l(g,{icon:"pi pi-pencil",outlined:"",rounded:"",severity:"warn",onClick:U=>e(s)},null,8,["onClick"]),l(g,{icon:"pi pi-angle-right",outlined:"",rounded:"",severity:"info",onClick:U=>h(c).push({name:"teacher-class",params:{id:s.id}})},null,8,["onClick"])])]),_:1})]),_:1},8,["filters","value","loading"]),l(ee,{"model-value":f.value,"onUpdate:modelValue":t[3]||(t[3]=s=>f.value=s),"selected-class":$.value},null,8,["model-value","selected-class"])])}}});export{we as default};
