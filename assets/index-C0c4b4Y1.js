import{B as Z,s as ee,o as t,c as o,m as te,h as J,d as se,u as ne,r as y,a as D,b as ae,e as oe,f as re,g as v,i as e,_ as le,j as n,t as h,k as ie,F as z,l as M,n as Y,p as g,q as ce,v as de,w as ue,x as fe,y as me}from"./index-CG54iUaD.js";import{R as pe,m as he}from"./mapRouteFromDto-0k7GSF4e.js";import{g as ge,f as q}from"./groupRoutesByType-B8LQ_TR7.js";import"./mapLessonFromDto-BxEkOMg4.js";import"./mapUnitFromDto-BXFFFlEW.js";var xe=function(r){var c=r.dt;return`
.p-skeleton {
    overflow: hidden;
    background: `.concat(c("skeleton.background"),`;
    border-radius: `).concat(c("skeleton.border.radius"),`;
}

.p-skeleton::after {
    content: "";
    animation: p-skeleton-animation 1.2s infinite;
    height: 100%;
    left: 0;
    position: absolute;
    right: 0;
    top: 0;
    transform: translateX(-100%);
    z-index: 1;
    background: linear-gradient(90deg, rgba(255, 255, 255, 0), `).concat(c("skeleton.animation.background"),`, rgba(255, 255, 255, 0));
}

[dir='rtl'] .p-skeleton::after {
    animation-name: p-skeleton-animation-rtl;
}

.p-skeleton-circle {
    border-radius: 50%;
}

.p-skeleton-animation-none::after {
    animation: none;
}

@keyframes p-skeleton-animation {
    from {
        transform: translateX(-100%);
    }
    to {
        transform: translateX(100%);
    }
}

@keyframes p-skeleton-animation-rtl {
    from {
        transform: translateX(100%);
    }
    to {
        transform: translateX(-100%);
    }
}
`)},ye={root:{position:"relative"}},ve={root:function(r){var c=r.props;return["p-skeleton p-component",{"p-skeleton-circle":c.shape==="circle","p-skeleton-animation-none":c.animation==="none"}]}},_e=Z.extend({name:"skeleton",theme:xe,classes:ve,inlineStyles:ye}),be={name:"BaseSkeleton",extends:ee,props:{shape:{type:String,default:"rectangle"},size:{type:String,default:null},width:{type:String,default:"100%"},height:{type:String,default:"1rem"},borderRadius:{type:String,default:null},animation:{type:String,default:"wave"}},style:_e,provide:function(){return{$pcSkeleton:this,$parentInstance:this}}},i={name:"Skeleton",extends:be,inheritAttrs:!1,computed:{containerStyle:function(){return this.size?{width:this.size,height:this.size,borderRadius:this.borderRadius}:{width:this.width,height:this.height,borderRadius:this.borderRadius}}}};function ke(u,r,c,P,T,$){return t(),o("div",te({class:u.cx("root"),style:[u.sx("root"),$.containerStyle],"aria-hidden":"true"},u.ptmi("root")),null,16)}i.render=ke;const G={getUserProgress:we,getUserInfo:Le,getUserLastLesson:Se};async function we(){return await J.get("user/progress")}async function Le(){return await J.get("user/info")}async function Se(){return await J.get("v2/lesson/last")}const Re=se("home-store",()=>{const u=ne(),r=y([]),c=y(!1);async function P(){try{c.value=!0;const{data:s}=await pe.getRoutes();r.value=(s==null?void 0:s.map(he))??[]}catch(s){u.add({severity:"error",summary:s,life:2e3})}finally{c.value=!1}}const T=D(()=>ge(r.value)),$=D(()=>q(r.value,"main")),E=D(()=>q(r.value,"side")),H=D(()=>q(r.value,"one_kit")),_=D(()=>q(r.value,"hackathon"));let U={};const b=y(0),x=y(!1);async function B(){try{x.value=!0;const{data:s}=await G.getUserProgress();b.value=s.xp,U=s.attempts.reduce((d,a)=>(d[a.date]={date:a.date,count:a.count,success:a.success},d),{})}catch(s){u.add({severity:"error",summary:s,life:2e3})}finally{x.value=!1}}const L=new Date,j=L.toISOString().slice(0,10),O=(L.getDay()+6)%7,A=new Date(L);A.setDate(L.getDate()-O-14);const N=A;function V(s,d){const a=(s-1)*7+(d-1),l=new Date(N);return l.setDate(N.getDate()+a),l.toISOString().slice(0,10)}function W(s,d){const a=V(s,d);if(a>j)return"bg-white";const l=U[a];return l?l.success?"bg-green-400":"bg-green-100":"bg-gray-200"}function K(s,d){const a=V(s,d);if(a>j)return"";const l=U[a];return l?`${a}
attempts: ${l.count}
success: ${l.success}`:`${a}: no attempts`}const k=y(),f=y(!1);async function C(){try{f.value=!0;const{data:s}=await G.getUserInfo();k.value=s}catch(s){u.add({severity:"error",summary:s,life:2e3})}finally{f.value=!1}}const X=D(()=>{var a,l;let s="",d="";return(a=k.value)!=null&&a.name&&(s=k.value.name.charAt(0).toUpperCase()),(l=k.value)!=null&&l.surname&&(d=k.value.surname.charAt(0).toUpperCase()),s+d}),m=y(),S=y(""),I=y(""),R=y(!1);async function F(){try{R.value=!0;const{data:s}=await G.getUserLastLesson();m.value=s,S.value="Continue"}catch(s){m.value.lesson_name="Default lesson",m.value.lesson_level_name="Default level",m.value.route_name="Default route",m.value.lesson_id=1,m.value.route_id=1,S.value="Start",u.add({severity:"error",summary:s,life:2e3})}finally{R.value=!1,I.value="/v2/lesson/"+m.value.lesson_id+"?route_id="+m.value.route_id}}return{routes:r,isRoutesLoading:c,loadRoutes:P,groupedRoutes:T,mainRoutes:$,sideRoutes:E,oneKitRoutes:H,hackathonRoutes:_,isProgressLoading:x,loadProgress:B,getDayClass:W,getDayTooltip:K,xp:b,isUserInfoLoading:f,userInfo:k,loadUserInfo:C,userLabel:X,isLastLessonLoading:R,lastLesson:m,lastButtonLabel:S,lastButtonURL:I,loadLastLesson:F}}),De={class:"flex flex-col items-center h-screen"},$e={class:"w-full h-full max-w-screen-xl px-4 md:px-28 py-8"},Ue={class:"flex flex-col gap-8 py-8"},Be={class:"flex gap-8"},Ce={class:"flex flex-col gap-8"},Ie={class:"flex flex-col w-[400px] h-[286px] bg-white border border-gray-100 rounded-3xl p-8"},ze={key:0,class:"text-4xl font-sans font-light text-gray-500 mb-4"},Pe={key:1,class:"text-4xl font-sans font-light text-gray-500 mb-4"},Te={class:"font-normal text-5xl text-black"},je={class:"flex"},Ae={class:"flex-grow flex gap-2 justify-between items-end text-gray-500"},Ne={class:"grid grid-rows-6 grid-cols-7 gap-0.5 w-full h-full"},Ve=["title"],Xe={class:"w-[400px] h-[180px] bg-purple-50 border border-gray-100 rounded-3xl p-8"},Fe={key:0},Me={key:1,class:"flex flex-col justify-between gap-5"},qe={class:"flex flex-col gap-8 w-full"},Ee={class:"relative flex-grow flex items-center bg-slate-50 border border-gray-100 rounded-3xl p-5"},He={class:"flex flex-col"},Oe={key:1,class:"text-2xl"},We={class:"flex flex-col absolute right-5 top-3 items-end"},Ke={key:1,class:"text-gray-400"},Ge={key:3,class:"text-gray-500"},Je={class:"flex-grow flex flex-col justify-between items-center bg-white border border-gray-100 rounded-3xl px-8 pb-4 pt-10"},Qe={class:"flex flex-col items-center"},Ye={key:1,class:"text-2xl font-semibold mb-2"},Ze={key:3,class:"text-blue-400 font-sans"},et={key:1,class:"text-[100px]"},tt={class:"flex flex-col items-center w-full min-w-full"},st={key:1,class:"text-gray-500 font-sans mb-4"},nt={class:"flex gap-4 bg-gray-50 rounded-3xl p-8 overflow-x-scroll"},at={key:0,class:"flex flex-row gap-4"},ot={class:"flex flex-col items-center"},rt={class:"text-lg font-semibold"},lt={class:"text-sm text-gray-500 text-center"},pt=ae({__name:"HomePage",setup(u){const r=ue(),c=Re(),{isRoutesLoading:P,mainRoutes:T,sideRoutes:$,isProgressLoading:E,xp:H,userInfo:_,userLabel:U,isUserInfoLoading:b,isLastLessonLoading:x,lastLesson:B,lastButtonLabel:L,lastButtonURL:j}=oe(c),{loadRoutes:Q,loadProgress:O,getDayClass:A,getDayTooltip:N,loadUserInfo:V,loadLastLesson:W}=c,K=["pi pi-microchip","pi pi-arrow-up-right","pi pi-code","pi pi-box"];return re(()=>{V(),O(),W(),Q()}),(k,f)=>{var m,S,I,R,F,s,d,a,l;const C=fe,X=me;return t(),o("div",De,[v(e(le)),n("div",$e,[n("div",Ue,[n("div",Be,[n("div",Ce,[n("div",Ie,[e(E)?(t(),o("div",ze,[v(e(i),{width:"11rem",height:"49px"})])):(t(),o("div",Pe,[n("span",Te,h(e(H)),1),f[1]||(f[1]=ie(" xp "))])),n("div",je,[(t(),o(z,null,M(["Mo","Tu","We","Th","Fr","Sa","Su"],(p,w)=>n("div",{key:`day-${w}`,class:"w-full h-full flex items-center justify-center rounded text-xs text-gray-500 font-medium"},h(p),1)),64))]),n("div",Ae,[n("div",Ne,[(t(),o(z,null,M(3,p=>(t(),o(z,null,[(t(),o(z,null,M(7,w=>n("div",{key:`cell-${p}-${w}`,class:Y(["aspect-square flex items-center justify-center rounded m-1",e(A)(p,w)]),title:e(N)(p,w)},null,10,Ve)),64))],64))),64))])])]),n("div",Xe,[e(b)?(t(),o("div",Fe,[e(x)?(t(),g(e(i),{key:0,height:"115px",class:"w-full mb-2"})):ce("",!0)])):(t(),o("div",Me,[f[2]||(f[2]=de('<div class="flex items-center justify-center gap-4"><i class="pi pi-crown text-orange-300" style="font-size:28px;"></i><div class="flex flex-col"><div class="text-lg">Unlock all learning with Premium</div><div class="text-gray-500">to get more ...</div></div></div>',1)),v(C,{label:"Explore Premium",severity:"help",class:"rounded-full"})]))])]),n("div",qe,[n("div",Ee,[e(b)?(t(),g(e(i),{key:0,class:"mr-6",shape:"circle",size:"4rem"})):(m=e(_))!=null&&m.small_avatar_url?(t(),g(X,{key:1,class:"mr-6",size:"xlarge",shape:"circle",image:(S=e(_))==null?void 0:S.small_avatar_url},null,8,["image"])):(t(),g(X,{key:2,label:e(U),class:"mr-6",size:"xlarge",shape:"circle"},null,8,["label"])),n("div",He,[f[3]||(f[3]=n("span",{class:"italic text-gray-500"},"Welcome back,",-1)),e(b)?(t(),g(e(i),{key:0,width:"15rem",height:"33px"})):(t(),o("div",Oe,h((I=e(_))==null?void 0:I.surname)+" "+h((R=e(_))==null?void 0:R.name),1))]),n("div",We,[e(b)?(t(),g(e(i),{key:0,width:"12rem",height:"25px",class:"mb-1"})):(t(),o("div",Ke,h((F=e(_))==null?void 0:F.school_name),1)),e(b)?(t(),g(e(i),{key:2,width:"3rem",height:"25px"})):(t(),o("div",Ge,h((s=e(_))==null?void 0:s.class_name),1))])]),n("div",Je,[n("div",Qe,[e(x)?(t(),g(e(i),{key:0,width:"15rem",height:"30px",class:"mb-2"})):(t(),o("div",Ye,h((d=e(B))==null?void 0:d.lesson_name),1)),e(x)?(t(),g(e(i),{key:2,width:"10rem",height:"20px",class:"mb-2"})):(t(),o("div",Ze,h((a=e(B))==null?void 0:a.lesson_level_name),1))]),e(x)?(t(),g(e(i),{key:0,width:"10rem",height:"9rem",class:"mb-2"})):(t(),o("div",et,"ðŸš€")),n("div",tt,[e(x)?(t(),g(e(i),{key:0,width:"10rem",height:"20px",class:"mb-4"})):(t(),o("div",st,h((l=e(B))==null?void 0:l.route_name),1)),v(C,{label:e(L),class:"rounded-full h-12 min-w-full",disabled:e(x),onClick:f[0]||(f[0]=p=>e(r).push(e(j)))},null,8,["label","disabled"])])])])]),n("div",nt,[e(P)?(t(),o("div",at,[v(e(i),{height:"16rem",width:"18rem"}),v(e(i),{height:"16rem",width:"18rem"}),v(e(i),{height:"16rem",width:"18rem"}),v(e(i),{height:"16rem",width:"18rem"})])):(t(!0),o(z,{key:1},M([...e(T),...e($)],(p,w)=>(t(),o("div",{key:p.id,class:"flex-shrink-0 flex flex-col items-center justify-between h-64 w-72 bg-white rounded-xl p-4"},[n("div",ot,[n("div",rt,h(p.name),1),n("div",lt,h(p.description),1)]),n("div",{class:Y(["text-[64px] text-gray-500",K[w]])},null,2),v(C,{label:"Start",class:"rounded-full w-full",severity:"info",variant:"outlined",onClick:it=>e(r).push({name:"route",params:{id:p.id}})},null,8,["onClick"])]))),128))])])])])}}});export{pt as default};
